nohup: ignoring input
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:24<01:38, 24.67s/it]denoise batch:  40%|████      | 2/5 [00:49<01:13, 24.59s/it]denoise batch:  60%|██████    | 3/5 [01:13<00:49, 24.63s/it]denoise batch:  80%|████████  | 4/5 [01:38<00:24, 24.69s/it]denoise batch: 100%|██████████| 5/5 [01:47<00:00, 18.98s/it]denoise batch: 100%|██████████| 5/5 [01:47<00:00, 21.50s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.57it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.77it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.32it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.99it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 221.16s
using minigpt4 for generation
Loading MiniGPT-4 models...You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:15<00:15, 15.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00,  9.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00, 10.38s/it]
Loading Q-Former
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [01:03<3:48:40, 63.23s/it]generating response:   1%|          | 2/218 [02:03<3:41:16, 61.47s/it]generating response:   1%|▏         | 3/218 [03:04<3:39:45, 61.33s/it]generating response:   2%|▏         | 4/218 [04:06<3:39:03, 61.42s/it]generating response:   2%|▏         | 5/218 [05:09<3:40:43, 62.18s/it]generating response:   3%|▎         | 6/218 [06:13<3:41:23, 62.66s/it]generating response:   3%|▎         | 7/218 [07:15<3:39:41, 62.47s/it]generating response:   4%|▎         | 8/218 [08:19<3:40:26, 62.98s/it]generating response:   4%|▍         | 9/218 [09:21<3:38:43, 62.79s/it]generating response:   6%|▋         | 14/218 [10:24<1:35:19, 28.04s/it]generating response:   7%|▋         | 15/218 [11:26<1:54:02, 33.71s/it]generating response:   7%|▋         | 16/218 [12:28<2:11:30, 39.06s/it]generating response:   8%|▊         | 17/218 [13:30<2:27:15, 43.96s/it]generating response:   8%|▊         | 18/218 [14:32<2:40:46, 48.23s/it]generating response:   9%|▊         | 19/218 [15:34<2:50:58, 51.55s/it]generating response:   9%|▉         | 20/218 [16:36<2:59:11, 54.30s/it]generating response:  10%|█         | 22/218 [17:40<2:26:29, 44.84s/it]generating response:  11%|█         | 24/218 [18:42<2:07:56, 39.57s/it]generating response:  11%|█▏        | 25/218 [19:46<2:23:50, 44.72s/it]generating response:  13%|█▎        | 28/218 [20:49<1:45:37, 33.35s/it]generating response:  14%|█▍        | 31/218 [21:51<1:27:53, 28.20s/it]generating response:  15%|█▍        | 32/218 [22:55<1:45:29, 34.03s/it]generating response:  15%|█▌        | 33/218 [23:56<2:00:27, 39.07s/it]generating response:  16%|█▌        | 35/218 [24:57<1:50:22, 36.19s/it]generating response:  17%|█▋        | 37/218 [25:59<1:44:01, 34.49s/it]generating response:  18%|█▊        | 39/218 [27:03<1:40:07, 33.56s/it]generating response:  18%|█▊        | 40/218 [28:05<1:55:44, 39.01s/it]generating response:  19%|█▉        | 41/218 [29:09<2:10:20, 44.19s/it]generating response:  19%|█▉        | 42/218 [30:12<2:22:09, 48.47s/it]generating response:  20%|█▉        | 43/218 [31:12<2:30:13, 51.51s/it]generating response:  20%|██        | 44/218 [32:14<2:37:25, 54.29s/it]generating response:  21%|██        | 46/218 [33:16<2:06:55, 44.28s/it]generating response:  22%|██▏       | 47/218 [34:19<2:18:46, 48.69s/it]generating response:  22%|██▏       | 48/218 [35:21<2:27:17, 51.99s/it]generating response:  22%|██▏       | 49/218 [36:24<2:34:28, 54.84s/it]generating response:  23%|██▎       | 50/218 [37:27<2:39:56, 57.12s/it]generating response:  23%|██▎       | 51/218 [38:32<2:45:00, 59.28s/it]generating response:  24%|██▍       | 52/218 [39:35<2:47:08, 60.41s/it]generating response:  24%|██▍       | 53/218 [40:37<2:47:23, 60.87s/it]generating response:  25%|██▍       | 54/218 [41:39<2:47:21, 61.23s/it]generating response:  25%|██▌       | 55/218 [42:44<2:49:20, 62.34s/it]generating response:  26%|██▌       | 56/218 [43:46<2:47:41, 62.11s/it]generating response:  26%|██▌       | 57/218 [44:47<2:45:56, 61.84s/it]generating response:  27%|██▋       | 58/218 [45:50<2:46:12, 62.33s/it]generating response:  27%|██▋       | 59/218 [46:53<2:45:24, 62.42s/it]generating response:  28%|██▊       | 60/218 [47:55<2:44:21, 62.41s/it]generating response:  28%|██▊       | 61/218 [48:58<2:43:26, 62.46s/it]generating response:  28%|██▊       | 62/218 [50:02<2:43:10, 62.76s/it]generating response:  30%|██▉       | 65/218 [51:05<1:40:10, 39.29s/it]generating response:  30%|███       | 66/218 [52:07<1:52:10, 44.28s/it]generating response:  31%|███       | 67/218 [53:10<2:02:20, 48.62s/it]generating response:  31%|███       | 68/218 [54:15<2:11:11, 52.48s/it]generating response:  32%|███▏      | 69/218 [55:17<2:16:53, 55.12s/it]generating response:  32%|███▏      | 70/218 [56:19<2:20:27, 56.94s/it]generating response:  33%|███▎      | 71/218 [57:20<2:22:32, 58.18s/it]generating response:  33%|███▎      | 72/218 [58:20<2:22:54, 58.73s/it]generating response:  34%|███▍      | 74/218 [59:23<1:51:05, 46.29s/it]generating response:  34%|███▍      | 75/218 [1:00:25<1:59:35, 50.18s/it]generating response:  35%|███▍      | 76/218 [1:01:29<2:07:00, 53.67s/it]generating response:  35%|███▌      | 77/218 [1:02:31<2:11:29, 55.95s/it]generating response:  36%|███▌      | 79/218 [1:03:33<1:44:51, 45.27s/it]generating response:  37%|███▋      | 81/218 [1:04:35<1:30:48, 39.77s/it]generating response:  38%|███▊      | 83/218 [1:05:37<1:22:13, 36.54s/it]generating response:  40%|████      | 88/218 [1:06:39<50:07, 23.13s/it]  generating response:  41%|████▏     | 90/218 [1:07:41<53:28, 25.07s/it]generating response:  42%|████▏     | 91/218 [1:08:43<1:04:19, 30.39s/it]generating response:  42%|████▏     | 92/218 [1:09:46<1:15:49, 36.11s/it]generating response:  43%|████▎     | 93/218 [1:10:48<1:25:55, 41.25s/it]generating response:  43%|████▎     | 94/218 [1:11:50<1:34:49, 45.89s/it]generating response:  44%|████▍     | 96/218 [1:12:52<1:21:32, 40.10s/it]generating response:  44%|████▍     | 97/218 [1:13:54<1:30:27, 44.86s/it]generating response:  45%|████▍     | 98/218 [1:14:56<1:37:43, 48.86s/it]generating response:  45%|████▌     | 99/218 [1:15:58<1:43:32, 52.21s/it]generating response:  46%|████▌     | 100/218 [1:17:02<1:48:49, 55.34s/it]generating response:  46%|████▋     | 101/218 [1:18:05<1:51:49, 57.35s/it]generating response:  47%|████▋     | 103/218 [1:19:07<1:27:48, 45.81s/it]generating response:  48%|████▊     | 104/218 [1:20:09<1:34:19, 49.65s/it]generating response:  48%|████▊     | 105/218 [1:21:10<1:39:13, 52.68s/it]generating response:  49%|████▊     | 106/218 [1:22:13<1:43:30, 55.45s/it]generating response:  50%|████▉     | 108/218 [1:23:16<1:22:26, 44.97s/it]generating response:  50%|█████     | 110/218 [1:24:18<1:11:27, 39.70s/it]generating response:  51%|█████     | 111/218 [1:25:20<1:19:22, 44.51s/it]generating response:  53%|█████▎    | 115/218 [1:26:22<48:55, 28.50s/it]  generating response:  55%|█████▍    | 119/218 [1:27:24<37:33, 22.76s/it]generating response:  55%|█████▌    | 120/218 [1:28:27<46:05, 28.22s/it]generating response:  56%|█████▌    | 121/218 [1:29:29<54:36, 33.78s/it]generating response:  56%|█████▌    | 122/218 [1:30:32<1:02:49, 39.27s/it]generating response:  56%|█████▋    | 123/218 [1:31:35<1:10:14, 44.37s/it]generating response:  58%|█████▊    | 127/218 [1:32:40<43:51, 28.92s/it]  generating response:  59%|█████▊    | 128/218 [1:33:41<51:19, 34.22s/it]generating response:  60%|█████▉    | 130/218 [1:34:44<48:51, 33.31s/it]generating response:  60%|██████    | 131/218 [1:35:46<56:04, 38.68s/it]generating response:  61%|██████    | 132/218 [1:36:48<1:02:18, 43.47s/it]generating response:  61%|██████    | 133/218 [1:37:50<1:07:42, 47.79s/it]generating response:  62%|██████▏   | 135/218 [1:38:52<56:59, 41.20s/it]  generating response:  62%|██████▏   | 136/218 [1:39:59<1:03:48, 46.69s/it]generating response:  63%|██████▎   | 137/218 [1:41:01<1:08:06, 50.45s/it]generating response:  64%|██████▍   | 139/218 [1:42:04<56:14, 42.71s/it]  generating response:  68%|██████▊   | 149/218 [1:43:08<18:02, 15.70s/it]generating response:  69%|██████▉   | 150/218 [1:44:12<23:01, 20.32s/it]generating response:  69%|██████▉   | 151/218 [1:45:15<28:28, 25.50s/it]generating response:  70%|██████▉   | 152/218 [1:46:19<34:19, 31.21s/it]generating response:  70%|███████   | 153/218 [1:47:21<39:36, 36.56s/it]generating response:  71%|███████   | 154/218 [1:48:24<44:31, 41.74s/it]generating response:  72%|███████▏  | 156/218 [1:49:28<39:26, 38.17s/it]generating response:  72%|███████▏  | 157/218 [1:50:30<43:52, 43.15s/it]generating response:  73%|███████▎  | 159/218 [1:51:31<37:50, 38.48s/it]generating response:  73%|███████▎  | 160/218 [1:52:34<42:06, 43.56s/it]generating response:  74%|███████▍  | 162/218 [1:53:34<35:57, 38.53s/it]generating response:  76%|███████▌  | 166/218 [1:54:35<23:01, 26.56s/it]generating response:  77%|███████▋  | 167/218 [1:55:36<27:08, 31.93s/it]generating response:  79%|███████▉  | 172/218 [1:56:40<16:43, 21.80s/it]generating response:  80%|████████  | 175/218 [1:57:42<15:22, 21.45s/it]generating response:  83%|████████▎ | 180/218 [1:58:44<11:07, 17.58s/it]generating response:  83%|████████▎ | 182/218 [1:59:46<12:08, 20.25s/it]generating response:  84%|████████▍ | 183/218 [2:00:49<14:52, 25.51s/it]generating response:  86%|████████▌ | 188/218 [2:01:54<09:48, 19.63s/it]generating response:  87%|████████▋ | 189/218 [2:02:56<11:53, 24.62s/it]generating response:  87%|████████▋ | 190/218 [2:04:00<14:08, 30.32s/it]generating response:  88%|████████▊ | 191/218 [2:05:03<16:08, 35.87s/it]generating response:  88%|████████▊ | 192/218 [2:06:06<17:50, 41.17s/it]generating response:  89%|████████▊ | 193/218 [2:07:10<19:12, 46.09s/it]generating response:  89%|████████▉ | 194/218 [2:08:12<19:59, 50.00s/it]generating response:  89%|████████▉ | 195/218 [2:09:14<20:19, 53.03s/it]generating response:  90%|████████▉ | 196/218 [2:10:16<20:18, 55.38s/it]generating response:  90%|█████████ | 197/218 [2:11:19<20:08, 57.53s/it]generating response:  91%|█████████ | 198/218 [2:12:21<19:34, 58.71s/it]generating response:  93%|█████████▎| 202/218 [2:13:23<08:33, 32.11s/it]generating response:  93%|█████████▎| 203/218 [2:14:26<09:24, 37.65s/it]generating response:  95%|█████████▍| 207/218 [2:15:29<04:51, 26.51s/it]generating response:  95%|█████████▌| 208/218 [2:16:32<05:21, 32.16s/it]generating response:  96%|█████████▌| 209/218 [2:17:35<05:39, 37.71s/it]generating response:  96%|█████████▋| 210/218 [2:18:39<05:43, 42.93s/it]generating response:  97%|█████████▋| 211/218 [2:19:41<05:31, 47.32s/it]generating response:  97%|█████████▋| 212/218 [2:20:48<05:12, 52.10s/it]generating response:  98%|█████████▊| 213/218 [2:21:50<04:33, 54.77s/it]generating response:  99%|█████████▊| 215/218 [2:22:55<02:15, 45.18s/it]generating response:  99%|█████████▉| 216/218 [2:23:57<01:38, 49.29s/it]generating response: 100%|█████████▉| 217/218 [2:25:01<00:52, 52.74s/it]generating response: 100%|██████████| 218/218 [2:26:04<00:00, 55.51s/it]generating response: 100%|██████████| 218/218 [2:26:04<00:00, 40.20s/it]
generation part takes 8818.31s
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:25<01:41, 25.39s/it]denoise batch:  40%|████      | 2/5 [00:50<01:15, 25.16s/it]denoise batch:  60%|██████    | 3/5 [01:15<00:50, 25.08s/it]denoise batch:  80%|████████  | 4/5 [01:40<00:25, 25.01s/it]denoise batch: 100%|██████████| 5/5 [01:49<00:00, 19.19s/it]denoise batch: 100%|██████████| 5/5 [01:49<00:00, 21.83s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.36it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  3.49it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.50it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.28it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 9258.92s
using minigpt4 for generation
Loading MiniGPT-4 models...Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.18s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]
Loading Q-Former
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:59<3:35:13, 59.51s/it]generating response:   1%|          | 2/218 [01:59<3:34:53, 59.69s/it]generating response:   1%|▏         | 3/218 [02:58<3:32:22, 59.27s/it]generating response:   2%|▏         | 4/218 [03:57<3:32:05, 59.46s/it]generating response:   2%|▏         | 5/218 [05:00<3:34:34, 60.44s/it]generating response:   3%|▎         | 6/218 [05:59<3:32:03, 60.02s/it]generating response:   3%|▎         | 7/218 [06:58<3:30:30, 59.86s/it]generating response:   4%|▎         | 8/218 [07:58<3:29:46, 59.93s/it]generating response:   4%|▍         | 9/218 [08:59<3:29:32, 60.16s/it]generating response:   6%|▋         | 14/218 [09:59<1:31:30, 26.91s/it]generating response:   7%|▋         | 15/218 [10:59<1:49:38, 32.41s/it]generating response:   7%|▋         | 16/218 [11:59<2:06:43, 37.64s/it]generating response:   8%|▊         | 17/218 [12:59<2:22:16, 42.47s/it]generating response:   8%|▊         | 18/218 [14:00<2:35:38, 46.69s/it]generating response:   9%|▊         | 19/218 [15:00<2:46:13, 50.12s/it]generating response:   9%|▉         | 20/218 [16:00<2:53:47, 52.66s/it]generating response:  11%|█         | 24/218 [17:01<1:37:25, 30.13s/it]generating response:  11%|█▏        | 25/218 [18:02<1:54:21, 35.55s/it]generating response:  12%|█▏        | 26/218 [19:02<2:09:44, 40.54s/it]generating response:  13%|█▎        | 28/218 [20:03<1:56:41, 36.85s/it]generating response:  14%|█▍        | 31/218 [21:03<1:32:00, 29.52s/it]generating response:  15%|█▍        | 32/218 [22:06<1:49:30, 35.32s/it]generating response:  15%|█▌        | 33/218 [23:06<2:03:46, 40.14s/it]generating response:  16%|█▌        | 35/218 [24:06<1:51:00, 36.40s/it]generating response:  17%|█▋        | 37/218 [25:07<1:44:02, 34.49s/it]generating response:  18%|█▊        | 39/218 [26:08<1:38:45, 33.11s/it]generating response:  18%|█▊        | 40/218 [27:08<1:53:43, 38.34s/it]generating response:  19%|█▉        | 41/218 [28:10<2:07:56, 43.37s/it]generating response:  19%|█▉        | 42/218 [29:13<2:20:36, 47.93s/it]generating response:  20%|█▉        | 43/218 [30:13<2:28:41, 50.98s/it]generating response:  20%|██        | 44/218 [31:13<2:34:34, 53.30s/it]generating response:  22%|██▏       | 47/218 [32:14<1:42:00, 35.79s/it]generating response:  22%|██▏       | 48/218 [33:14<1:55:02, 40.60s/it]generating response:  22%|██▏       | 49/218 [34:14<2:06:40, 44.97s/it]generating response:  23%|██▎       | 50/218 [35:15<2:16:48, 48.86s/it]generating response:  23%|██▎       | 51/218 [36:16<2:24:40, 51.98s/it]generating response:  24%|██▍       | 53/218 [37:17<1:58:00, 42.91s/it]generating response:  25%|██▍       | 54/218 [38:18<2:08:55, 47.17s/it]generating response:  25%|██▌       | 55/218 [39:20<2:18:02, 50.82s/it]generating response:  26%|██▌       | 56/218 [40:20<2:23:44, 53.24s/it]generating response:  26%|██▌       | 57/218 [41:20<2:27:26, 54.95s/it]generating response:  27%|██▋       | 58/218 [42:20<2:30:43, 56.52s/it]generating response:  27%|██▋       | 59/218 [43:22<2:33:28, 57.92s/it]generating response:  28%|██▊       | 60/218 [44:22<2:34:12, 58.56s/it]generating response:  28%|██▊       | 62/218 [45:25<2:00:38, 46.40s/it]generating response:  30%|██▉       | 65/218 [46:26<1:25:24, 33.49s/it]generating response:  30%|███       | 66/218 [47:25<1:37:28, 38.48s/it]generating response:  31%|███       | 67/218 [48:27<1:49:11, 43.39s/it]generating response:  31%|███       | 68/218 [49:27<1:58:29, 47.40s/it]generating response:  32%|███▏      | 70/218 [50:27<1:39:17, 40.25s/it]generating response:  33%|███▎      | 71/218 [51:27<1:49:24, 44.66s/it]generating response:  33%|███▎      | 72/218 [52:25<1:56:52, 48.03s/it]generating response:  34%|███▍      | 74/218 [53:26<1:37:46, 40.74s/it]generating response:  35%|███▍      | 76/218 [54:26<1:27:27, 36.95s/it]generating response:  35%|███▌      | 77/218 [55:27<1:38:20, 41.85s/it]generating response:  36%|███▌      | 78/218 [56:28<1:47:59, 46.28s/it]generating response:  36%|███▌      | 79/218 [57:29<1:55:20, 49.79s/it]generating response:  37%|███▋      | 81/218 [58:30<1:35:43, 41.93s/it]generating response:  38%|███▊      | 83/218 [59:30<1:24:10, 37.41s/it]generating response:  39%|███▊      | 84/218 [1:00:29<1:34:00, 42.09s/it]generating response:  40%|████      | 88/218 [1:01:30<59:16, 27.36s/it]  generating response:  41%|████▏     | 90/218 [1:02:29<59:46, 28.02s/it]generating response:  42%|████▏     | 91/218 [1:03:29<1:10:34, 33.34s/it]generating response:  42%|████▏     | 92/218 [1:04:31<1:21:30, 38.81s/it]generating response:  43%|████▎     | 93/218 [1:05:32<1:30:42, 43.54s/it]generating response:  43%|████▎     | 94/218 [1:06:34<1:38:56, 47.87s/it]generating response:  44%|████▍     | 96/218 [1:07:32<1:22:17, 40.47s/it]generating response:  44%|████▍     | 97/218 [1:08:34<1:31:01, 45.14s/it]generating response:  45%|████▍     | 98/218 [1:09:35<1:38:09, 49.08s/it]generating response:  45%|████▌     | 99/218 [1:10:36<1:43:08, 52.01s/it]generating response:  46%|████▌     | 100/218 [1:11:36<1:46:40, 54.24s/it]generating response:  46%|████▋     | 101/218 [1:12:35<1:48:28, 55.63s/it]generating response:  47%|████▋     | 103/218 [1:13:37<1:25:36, 44.67s/it]generating response:  48%|████▊     | 104/218 [1:14:38<1:32:11, 48.52s/it]generating response:  48%|████▊     | 105/218 [1:15:39<1:37:17, 51.66s/it]generating response:  49%|████▊     | 106/218 [1:16:38<1:40:32, 53.86s/it]generating response:  50%|████▉     | 108/218 [1:17:39<1:19:50, 43.55s/it]generating response:  51%|█████     | 111/218 [1:18:39<57:42, 32.36s/it]  generating response:  53%|█████▎    | 115/218 [1:19:41<41:31, 24.19s/it]generating response:  55%|█████▍    | 119/218 [1:20:41<33:51, 20.52s/it]generating response:  55%|█████▌    | 120/218 [1:21:43<42:10, 25.82s/it]generating response:  56%|█████▌    | 121/218 [1:22:44<50:26, 31.20s/it]generating response:  56%|█████▌    | 122/218 [1:23:46<58:33, 36.60s/it]generating response:  56%|█████▋    | 123/218 [1:24:46<1:05:33, 41.40s/it]generating response:  58%|█████▊    | 127/218 [1:25:48<41:34, 27.42s/it]  generating response:  59%|█████▊    | 128/218 [1:26:46<48:45, 32.50s/it]generating response:  60%|█████▉    | 130/218 [1:27:47<46:42, 31.84s/it]generating response:  60%|██████    | 131/218 [1:28:48<53:47, 37.10s/it]generating response:  61%|██████    | 132/218 [1:29:48<1:00:12, 42.01s/it]generating response:  61%|██████    | 133/218 [1:30:49<1:05:29, 46.23s/it]generating response:  62%|██████▏   | 135/218 [1:31:50<55:15, 39.95s/it]  generating response:  62%|██████▏   | 136/218 [1:32:50<1:00:42, 44.42s/it]generating response:  63%|██████▎   | 137/218 [1:33:51<1:05:19, 48.38s/it]generating response:  63%|██████▎   | 138/218 [1:34:52<1:08:50, 51.63s/it]generating response:  64%|██████▍   | 139/218 [1:35:52<1:11:03, 53.97s/it]generating response:  68%|██████▊   | 149/218 [1:36:52<18:22, 15.98s/it]  generating response:  69%|██████▉   | 150/218 [1:37:55<23:25, 20.67s/it]generating response:  69%|██████▉   | 151/218 [1:38:55<28:45, 25.75s/it]generating response:  70%|██████▉   | 152/218 [1:39:57<34:28, 31.34s/it]generating response:  70%|███████   | 153/218 [1:40:58<39:41, 36.64s/it]generating response:  71%|███████   | 154/218 [1:41:59<44:24, 41.64s/it]generating response:  72%|███████▏  | 156/218 [1:43:00<38:38, 37.40s/it]generating response:  72%|███████▏  | 157/218 [1:44:01<43:06, 42.40s/it]generating response:  73%|███████▎  | 159/218 [1:45:00<36:58, 37.60s/it]generating response:  74%|███████▍  | 162/218 [1:45:59<27:38, 29.62s/it]generating response:  76%|███████▌  | 166/218 [1:46:59<19:51, 22.91s/it]generating response:  77%|███████▋  | 167/218 [1:47:58<23:50, 28.04s/it]generating response:  79%|███████▉  | 172/218 [1:49:00<15:29, 20.20s/it]generating response:  80%|███████▉  | 174/218 [1:50:00<16:24, 22.37s/it]generating response:  80%|████████  | 175/218 [1:51:01<19:50, 27.70s/it]generating response:  83%|████████▎ | 180/218 [1:52:02<12:40, 20.01s/it]generating response:  83%|████████▎ | 182/218 [1:53:03<13:23, 22.33s/it]generating response:  84%|████████▍ | 183/218 [1:54:04<16:05, 27.59s/it]generating response:  86%|████████▌ | 188/218 [1:55:06<10:02, 20.07s/it]generating response:  87%|████████▋ | 189/218 [1:56:07<12:07, 25.10s/it]generating response:  87%|████████▋ | 190/218 [1:57:07<14:10, 30.38s/it]generating response:  88%|████████▊ | 191/218 [1:58:08<16:04, 35.71s/it]generating response:  88%|████████▊ | 192/218 [1:59:08<17:36, 40.62s/it]generating response:  89%|████████▊ | 193/218 [2:00:09<18:47, 45.11s/it]generating response:  89%|████████▉ | 194/218 [2:01:08<19:27, 48.65s/it]generating response:  89%|████████▉ | 195/218 [2:02:08<19:46, 51.57s/it]generating response:  90%|████████▉ | 196/218 [2:03:09<19:45, 53.90s/it]generating response:  90%|█████████ | 197/218 [2:04:10<19:33, 55.86s/it]generating response:  91%|█████████ | 198/218 [2:05:10<19:01, 57.06s/it]generating response:  93%|█████████▎| 202/218 [2:06:10<08:17, 31.10s/it]generating response:  94%|█████████▎| 204/218 [2:07:10<07:10, 30.74s/it]generating response:  95%|█████████▍| 207/218 [2:08:10<04:52, 26.55s/it]generating response:  95%|█████████▌| 208/218 [2:09:11<05:19, 31.94s/it]generating response:  96%|█████████▌| 209/218 [2:10:11<05:34, 37.19s/it]generating response:  96%|█████████▋| 210/218 [2:11:12<05:36, 42.06s/it]generating response:  97%|█████████▋| 211/218 [2:12:13<05:25, 46.49s/it]generating response:  97%|█████████▋| 212/218 [2:13:15<05:01, 50.22s/it]generating response:  98%|█████████▊| 213/218 [2:14:18<04:27, 53.55s/it]generating response:  99%|█████████▊| 215/218 [2:15:19<02:11, 43.73s/it]generating response: 100%|█████████▉| 217/218 [2:16:19<00:38, 38.50s/it]generating response: 100%|██████████| 218/218 [2:17:20<00:00, 43.48s/it]generating response: 100%|██████████| 218/218 [2:17:20<00:00, 37.80s/it]
generation part takes 8270.61s
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:25<01:41, 25.42s/it]denoise batch:  40%|████      | 2/5 [00:50<01:15, 25.20s/it]denoise batch:  60%|██████    | 3/5 [01:15<00:50, 25.10s/it]denoise batch:  80%|████████  | 4/5 [01:40<00:25, 25.03s/it]denoise batch: 100%|██████████| 5/5 [01:49<00:00, 19.20s/it]denoise batch: 100%|██████████| 5/5 [01:49<00:00, 21.85s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.41it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  3.51it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.55it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.31it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 17746.34s
using minigpt4 for generation
Loading MiniGPT-4 models...Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.15s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.48s/it]
Loading Q-Former
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [01:01<3:43:37, 61.83s/it]generating response:   1%|          | 2/218 [02:05<3:46:40, 62.97s/it]generating response:   1%|▏         | 3/218 [03:07<3:43:42, 62.43s/it]generating response:   2%|▏         | 4/218 [04:11<3:44:36, 62.97s/it]generating response:   2%|▏         | 5/218 [05:13<3:42:57, 62.81s/it]generating response:   3%|▎         | 6/218 [06:17<3:43:14, 63.18s/it]generating response:   3%|▎         | 7/218 [07:18<3:39:13, 62.34s/it]generating response:   4%|▎         | 8/218 [08:21<3:39:07, 62.60s/it]generating response:   4%|▍         | 9/218 [09:24<3:38:16, 62.66s/it]generating response:   6%|▋         | 14/218 [10:24<1:34:26, 27.78s/it]generating response:   7%|▋         | 15/218 [11:26<1:52:55, 33.38s/it]generating response:   7%|▋         | 16/218 [12:27<2:10:14, 38.68s/it]generating response:   8%|▊         | 17/218 [13:28<2:25:21, 43.39s/it]generating response:   8%|▊         | 18/218 [14:31<2:39:58, 47.99s/it]generating response:   9%|▊         | 19/218 [15:33<2:50:52, 51.52s/it]generating response:   9%|▉         | 20/218 [16:36<2:59:31, 54.40s/it]generating response:  10%|█         | 22/218 [17:38<2:25:20, 44.49s/it]generating response:  11%|█         | 23/218 [18:41<2:38:27, 48.76s/it]generating response:  11%|█         | 24/218 [19:43<2:48:27, 52.10s/it]generating response:  11%|█▏        | 25/218 [20:46<2:56:34, 54.90s/it]generating response:  13%|█▎        | 28/218 [21:47<1:55:57, 36.62s/it]generating response:  14%|█▍        | 31/218 [22:50<1:32:54, 29.81s/it]generating response:  15%|█▍        | 32/218 [23:52<1:49:24, 35.29s/it]generating response:  15%|█▌        | 33/218 [24:53<2:04:26, 40.36s/it]generating response:  16%|█▌        | 35/218 [25:53<1:51:49, 36.66s/it]generating response:  17%|█▋        | 37/218 [26:55<1:45:00, 34.81s/it]generating response:  18%|█▊        | 39/218 [27:59<1:40:50, 33.80s/it]generating response:  18%|█▊        | 40/218 [29:01<1:55:57, 39.09s/it]generating response:  19%|█▉        | 41/218 [30:04<2:10:41, 44.30s/it]generating response:  19%|█▉        | 42/218 [31:07<2:22:28, 48.57s/it]generating response:  20%|█▉        | 43/218 [32:08<2:30:41, 51.67s/it]generating response:  20%|██        | 44/218 [33:10<2:37:58, 54.47s/it]generating response:  21%|██        | 46/218 [34:11<2:06:42, 44.20s/it]generating response:  22%|██▏       | 47/218 [35:13<2:17:41, 48.31s/it]generating response:  22%|██▏       | 48/218 [36:14<2:25:54, 51.50s/it]generating response:  22%|██▏       | 49/218 [37:16<2:32:45, 54.23s/it]generating response:  23%|██▎       | 50/218 [38:19<2:39:02, 56.80s/it]generating response:  23%|██▎       | 51/218 [39:21<2:42:02, 58.22s/it]generating response:  24%|██▍       | 52/218 [40:22<2:43:23, 59.06s/it]generating response:  24%|██▍       | 53/218 [41:24<2:44:53, 59.96s/it]generating response:  25%|██▍       | 54/218 [42:28<2:46:38, 60.97s/it]generating response:  25%|██▌       | 55/218 [43:30<2:46:09, 61.16s/it]generating response:  26%|██▌       | 56/218 [44:29<2:44:10, 60.80s/it]generating response:  26%|██▌       | 57/218 [45:31<2:43:35, 60.97s/it]generating response:  27%|██▋       | 58/218 [46:33<2:43:29, 61.31s/it]generating response:  27%|██▋       | 59/218 [47:35<2:43:21, 61.65s/it]generating response:  28%|██▊       | 60/218 [48:38<2:43:16, 62.00s/it]generating response:  28%|██▊       | 61/218 [49:40<2:42:16, 62.01s/it]generating response:  28%|██▊       | 62/218 [50:45<2:43:26, 62.86s/it]generating response:  30%|██▉       | 65/218 [51:48<1:40:17, 39.33s/it]generating response:  30%|███       | 66/218 [52:52<1:52:45, 44.51s/it]generating response:  31%|███       | 67/218 [53:54<2:02:17, 48.59s/it]generating response:  31%|███       | 68/218 [54:56<2:09:30, 51.81s/it]generating response:  32%|███▏      | 70/218 [55:56<1:45:50, 42.91s/it]generating response:  33%|███▎      | 71/218 [56:58<1:55:30, 47.14s/it]generating response:  33%|███▎      | 72/218 [57:59<2:03:10, 50.62s/it]generating response:  34%|███▍      | 74/218 [59:02<1:42:20, 42.64s/it]generating response:  34%|███▍      | 75/218 [1:00:04<1:52:22, 47.15s/it]generating response:  35%|███▍      | 76/218 [1:01:08<2:01:15, 51.24s/it]generating response:  35%|███▌      | 77/218 [1:02:10<2:07:08, 54.10s/it]generating response:  36%|███▌      | 79/218 [1:03:12<1:42:13, 44.13s/it]generating response:  37%|███▋      | 81/218 [1:04:17<1:30:51, 39.79s/it]generating response:  38%|███▊      | 83/218 [1:05:19<1:22:42, 36.76s/it]generating response:  39%|███▊      | 84/218 [1:06:20<1:32:54, 41.60s/it]generating response:  39%|███▉      | 86/218 [1:07:22<1:23:02, 37.75s/it]generating response:  40%|████      | 88/218 [1:08:24<1:16:53, 35.49s/it]generating response:  41%|████▏     | 90/218 [1:09:26<1:12:23, 33.93s/it]generating response:  42%|████▏     | 91/218 [1:10:28<1:23:17, 39.35s/it]generating response:  42%|████▏     | 92/218 [1:11:31<1:33:13, 44.39s/it]generating response:  43%|████▎     | 93/218 [1:12:34<1:41:09, 48.56s/it]generating response:  43%|████▎     | 94/218 [1:13:35<1:47:16, 51.91s/it]generating response:  44%|████▍     | 97/218 [1:14:37<1:11:50, 35.63s/it]generating response:  45%|████▍     | 98/218 [1:15:40<1:22:04, 41.04s/it]generating response:  45%|████▌     | 99/218 [1:16:41<1:30:16, 45.52s/it]generating response:  46%|████▌     | 100/218 [1:17:43<1:37:07, 49.39s/it]generating response:  46%|████▋     | 101/218 [1:18:45<1:42:36, 52.62s/it]generating response:  47%|████▋     | 103/218 [1:19:46<1:23:07, 43.37s/it]generating response:  48%|████▊     | 104/218 [1:20:49<1:30:58, 47.88s/it]generating response:  48%|████▊     | 105/218 [1:21:51<1:36:50, 51.42s/it]generating response:  49%|████▊     | 106/218 [1:22:54<1:41:43, 54.50s/it]generating response:  50%|████▉     | 108/218 [1:23:56<1:21:28, 44.44s/it]generating response:  51%|█████     | 111/218 [1:24:58<58:57, 33.06s/it]  generating response:  53%|█████▎    | 115/218 [1:26:01<42:34, 24.80s/it]generating response:  55%|█████▍    | 119/218 [1:27:04<34:47, 21.09s/it]generating response:  55%|█████▌    | 120/218 [1:28:07<43:02, 26.36s/it]generating response:  56%|█████▌    | 121/218 [1:29:10<51:37, 31.94s/it]generating response:  56%|█████▌    | 122/218 [1:30:13<1:00:00, 37.51s/it]generating response:  56%|█████▋    | 123/218 [1:31:16<1:07:41, 42.75s/it]generating response:  58%|█████▊    | 127/218 [1:32:18<42:40, 28.14s/it]  generating response:  59%|█████▊    | 128/218 [1:33:21<50:41, 33.79s/it]generating response:  60%|█████▉    | 130/218 [1:34:24<48:24, 33.01s/it]generating response:  60%|██████    | 131/218 [1:35:26<55:33, 38.32s/it]generating response:  61%|██████    | 132/218 [1:36:28<1:02:07, 43.35s/it]generating response:  61%|██████    | 133/218 [1:37:30<1:07:25, 47.59s/it]generating response:  62%|██████▏   | 135/218 [1:38:34<57:15, 41.39s/it]  generating response:  62%|██████▏   | 136/218 [1:39:37<1:03:12, 46.24s/it]generating response:  63%|██████▎   | 137/218 [1:40:40<1:07:42, 50.16s/it]generating response:  64%|██████▍   | 139/218 [1:41:43<56:05, 42.61s/it]  generating response:  68%|██████▊   | 149/218 [1:42:47<17:59, 15.65s/it]generating response:  69%|██████▉   | 150/218 [1:43:49<22:51, 20.16s/it]generating response:  70%|███████   | 153/218 [1:44:52<22:02, 20.35s/it]generating response:  71%|███████   | 154/218 [1:45:55<27:15, 25.55s/it]generating response:  72%|███████▏  | 156/218 [1:46:58<27:57, 27.06s/it]generating response:  73%|███████▎  | 159/218 [1:48:01<24:28, 24.90s/it]generating response:  73%|███████▎  | 160/218 [1:49:03<29:18, 30.32s/it]generating response:  74%|███████▍  | 162/218 [1:50:03<28:17, 30.31s/it]generating response:  76%|███████▌  | 166/218 [1:51:05<20:24, 23.54s/it]generating response:  77%|███████▋  | 167/218 [1:52:07<24:34, 28.92s/it]generating response:  79%|███████▉  | 172/218 [1:53:10<15:55, 20.78s/it]generating response:  80%|████████  | 175/218 [1:54:13<14:55, 20.82s/it]generating response:  83%|████████▎ | 180/218 [1:55:15<10:58, 17.34s/it]generating response:  83%|████████▎ | 182/218 [1:56:19<12:04, 20.13s/it]generating response:  84%|████████▍ | 183/218 [1:57:22<14:43, 25.25s/it]generating response:  87%|████████▋ | 189/218 [1:58:23<08:31, 17.64s/it]generating response:  87%|████████▋ | 190/218 [1:59:25<10:28, 22.44s/it]generating response:  88%|████████▊ | 191/218 [2:00:28<12:30, 27.81s/it]generating response:  88%|████████▊ | 192/218 [2:01:31<14:28, 33.40s/it]generating response:  89%|████████▊ | 193/218 [2:02:34<16:15, 39.02s/it]generating response:  89%|████████▉ | 194/218 [2:03:36<17:33, 43.88s/it]generating response:  89%|████████▉ | 195/218 [2:04:36<18:14, 47.59s/it]generating response:  90%|████████▉ | 196/218 [2:05:36<18:35, 50.69s/it]generating response:  90%|█████████ | 197/218 [2:06:36<18:33, 53.03s/it]generating response:  91%|█████████ | 198/218 [2:07:37<18:21, 55.05s/it]generating response:  93%|█████████▎| 202/218 [2:08:37<08:12, 30.76s/it]generating response:  93%|█████████▎| 203/218 [2:09:39<09:04, 36.33s/it]generating response:  94%|█████████▎| 204/218 [2:10:40<09:38, 41.34s/it]generating response:  95%|█████████▍| 207/218 [2:11:41<05:47, 31.58s/it]generating response:  95%|█████████▌| 208/218 [2:12:43<06:10, 37.09s/it]generating response:  96%|█████████▌| 209/218 [2:13:44<06:17, 41.97s/it]generating response:  96%|█████████▋| 210/218 [2:14:44<06:09, 46.18s/it]generating response:  97%|█████████▋| 211/218 [2:15:45<05:48, 49.83s/it]generating response:  97%|█████████▋| 212/218 [2:16:46<05:15, 52.66s/it]generating response:  98%|█████████▊| 213/218 [2:17:48<04:35, 55.13s/it]generating response:  99%|█████████▊| 215/218 [2:18:49<02:13, 44.40s/it]generating response:  99%|█████████▉| 216/218 [2:19:50<01:36, 48.21s/it]generating response: 100%|█████████▉| 217/218 [2:20:50<00:51, 51.37s/it]generating response: 100%|██████████| 218/218 [2:21:52<00:00, 54.04s/it]generating response: 100%|██████████| 218/218 [2:21:52<00:00, 39.05s/it]
generation part takes 8541.39s
Full generation completed in 26287.74s
query number: 218
-------minigpt4 with defence generation complete-------
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processed 218 images, 218 texts in 0.07s
using minigpt4 for generation
Loading MiniGPT-4 models...You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.79s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.65s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.82s/it]
Loading Q-Former
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [01:02<3:46:38, 62.67s/it]generating response:   1%|          | 2/218 [02:02<3:39:15, 60.90s/it]generating response:   1%|▏         | 3/218 [03:03<3:38:53, 61.09s/it]generating response:   2%|▏         | 4/218 [04:06<3:40:03, 61.70s/it]generating response:   2%|▏         | 5/218 [05:07<3:39:01, 61.70s/it]generating response:   3%|▎         | 6/218 [06:09<3:37:50, 61.65s/it]generating response:   3%|▎         | 7/218 [07:11<3:36:46, 61.64s/it]generating response:   4%|▎         | 8/218 [08:11<3:33:59, 61.14s/it]generating response:   4%|▍         | 9/218 [09:12<3:32:59, 61.15s/it]generating response:   5%|▍         | 10/218 [10:13<3:31:50, 61.11s/it]generating response:   5%|▌         | 11/218 [11:15<3:31:45, 61.38s/it]generating response:   6%|▌         | 12/218 [12:17<3:31:16, 61.53s/it]generating response:   6%|▌         | 13/218 [13:19<3:30:44, 61.68s/it]generating response:   6%|▋         | 14/218 [14:19<3:28:39, 61.37s/it]generating response:   7%|▋         | 15/218 [15:21<3:27:34, 61.35s/it]generating response:   7%|▋         | 16/218 [16:22<3:26:55, 61.46s/it]generating response:   8%|▊         | 17/218 [17:24<3:25:57, 61.48s/it]generating response:   8%|▊         | 18/218 [18:26<3:25:11, 61.56s/it]generating response:   9%|▊         | 19/218 [19:28<3:25:06, 61.84s/it]generating response:   9%|▉         | 20/218 [20:30<3:24:12, 61.88s/it]generating response:  10%|▉         | 21/218 [21:32<3:23:33, 62.00s/it]generating response:  10%|█         | 22/218 [22:36<3:23:48, 62.39s/it]generating response:  11%|█         | 23/218 [23:39<3:23:48, 62.71s/it]generating response:  11%|█         | 24/218 [24:41<3:22:10, 62.53s/it]generating response:  11%|█▏        | 25/218 [25:43<3:20:11, 62.24s/it]generating response:  12%|█▏        | 26/218 [26:47<3:21:01, 62.82s/it]generating response:  12%|█▏        | 27/218 [27:49<3:18:50, 62.46s/it]generating response:  13%|█▎        | 28/218 [28:51<3:17:58, 62.52s/it]generating response:  13%|█▎        | 29/218 [29:55<3:17:30, 62.70s/it]generating response:  14%|█▍        | 30/218 [30:57<3:16:06, 62.59s/it]generating response:  14%|█▍        | 31/218 [31:59<3:14:37, 62.45s/it]generating response:  15%|█▍        | 32/218 [33:03<3:14:37, 62.78s/it]generating response:  15%|█▌        | 33/218 [34:04<3:12:26, 62.42s/it]generating response:  16%|█▌        | 34/218 [35:04<3:09:16, 61.72s/it]generating response:  16%|█▌        | 35/218 [36:05<3:07:29, 61.47s/it]generating response:  17%|█▋        | 36/218 [37:05<3:05:20, 61.10s/it]generating response:  17%|█▋        | 37/218 [38:07<3:05:15, 61.41s/it]generating response:  17%|█▋        | 38/218 [39:09<3:04:19, 61.44s/it]generating response:  18%|█▊        | 39/218 [40:11<3:03:30, 61.51s/it]generating response:  18%|█▊        | 40/218 [41:12<3:02:42, 61.59s/it]generating response:  19%|█▉        | 41/218 [42:15<3:02:31, 61.88s/it]generating response:  19%|█▉        | 42/218 [43:17<3:01:33, 61.89s/it]generating response:  20%|█▉        | 43/218 [44:18<2:59:57, 61.70s/it]generating response:  20%|██        | 44/218 [45:20<2:58:49, 61.66s/it]generating response:  21%|██        | 45/218 [46:23<2:59:18, 62.19s/it]generating response:  21%|██        | 46/218 [47:24<2:57:21, 61.87s/it]generating response:  22%|██▏       | 47/218 [48:26<2:56:24, 61.89s/it]generating response:  22%|██▏       | 48/218 [49:28<2:55:00, 61.77s/it]generating response:  22%|██▏       | 49/218 [50:30<2:54:07, 61.82s/it]generating response:  23%|██▎       | 50/218 [51:31<2:52:53, 61.75s/it]generating response:  23%|██▎       | 51/218 [52:33<2:51:33, 61.64s/it]generating response:  24%|██▍       | 52/218 [53:34<2:50:29, 61.62s/it]generating response:  24%|██▍       | 53/218 [54:35<2:48:38, 61.32s/it]generating response:  25%|██▍       | 54/218 [55:39<2:50:03, 62.22s/it]generating response:  25%|██▌       | 55/218 [56:41<2:48:53, 62.17s/it]generating response:  26%|██▌       | 56/218 [57:43<2:47:48, 62.15s/it]generating response:  26%|██▌       | 57/218 [58:44<2:45:21, 61.62s/it]generating response:  27%|██▋       | 58/218 [59:46<2:45:11, 61.95s/it]generating response:  27%|██▋       | 59/218 [1:00:49<2:44:59, 62.26s/it]generating response:  28%|██▊       | 60/218 [1:01:51<2:43:31, 62.10s/it]generating response:  28%|██▊       | 61/218 [1:02:52<2:41:55, 61.88s/it]generating response:  28%|██▊       | 62/218 [1:03:55<2:41:45, 62.22s/it]generating response:  29%|██▉       | 63/218 [1:04:59<2:41:24, 62.48s/it]generating response:  29%|██▉       | 64/218 [1:06:03<2:41:33, 62.95s/it]generating response:  30%|██▉       | 65/218 [1:07:05<2:40:02, 62.76s/it]generating response:  30%|███       | 66/218 [1:08:07<2:38:11, 62.45s/it]generating response:  31%|███       | 67/218 [1:09:09<2:37:06, 62.43s/it]generating response:  31%|███       | 68/218 [1:10:11<2:35:59, 62.40s/it]generating response:  32%|███▏      | 69/218 [1:11:14<2:34:50, 62.35s/it]generating response:  32%|███▏      | 70/218 [1:12:15<2:33:07, 62.08s/it]generating response:  33%|███▎      | 71/218 [1:13:17<2:31:50, 61.97s/it]generating response:  33%|███▎      | 72/218 [1:14:18<2:29:59, 61.64s/it]generating response:  33%|███▎      | 73/218 [1:15:19<2:28:52, 61.60s/it]generating response:  34%|███▍      | 74/218 [1:16:21<2:27:53, 61.62s/it]generating response:  34%|███▍      | 75/218 [1:17:23<2:27:33, 61.91s/it]generating response:  35%|███▍      | 76/218 [1:18:25<2:26:27, 61.89s/it]generating response:  35%|███▌      | 77/218 [1:19:28<2:25:46, 62.03s/it]generating response:  36%|███▌      | 78/218 [1:20:30<2:24:44, 62.03s/it]generating response:  36%|███▌      | 79/218 [1:21:30<2:22:36, 61.56s/it]generating response:  37%|███▋      | 80/218 [1:22:34<2:23:03, 62.20s/it]generating response:  37%|███▋      | 81/218 [1:23:36<2:21:45, 62.09s/it]generating response:  38%|███▊      | 82/218 [1:24:37<2:20:24, 61.94s/it]generating response:  38%|███▊      | 83/218 [1:25:39<2:19:18, 61.92s/it]generating response:  39%|███▊      | 84/218 [1:26:40<2:17:49, 61.72s/it]generating response:  39%|███▉      | 85/218 [1:27:41<2:16:16, 61.48s/it]generating response:  39%|███▉      | 86/218 [1:28:44<2:16:15, 61.94s/it]generating response:  40%|███▉      | 87/218 [1:29:46<2:14:53, 61.78s/it]generating response:  40%|████      | 88/218 [1:30:47<2:13:34, 61.65s/it]generating response:  41%|████      | 89/218 [1:31:49<2:12:33, 61.66s/it]generating response:  41%|████▏     | 90/218 [1:32:51<2:11:51, 61.81s/it]generating response:  42%|████▏     | 91/218 [1:33:56<2:13:07, 62.89s/it]generating response:  42%|████▏     | 92/218 [1:34:58<2:11:26, 62.59s/it]generating response:  43%|████▎     | 93/218 [1:35:59<2:09:03, 61.95s/it]generating response:  43%|████▎     | 94/218 [1:37:02<2:09:03, 62.45s/it]generating response:  44%|████▎     | 95/218 [1:38:04<2:07:43, 62.30s/it]generating response:  44%|████▍     | 96/218 [1:39:15<2:11:36, 64.73s/it]generating response:  44%|████▍     | 97/218 [1:40:16<2:08:48, 63.87s/it]generating response:  45%|████▍     | 98/218 [1:41:18<2:06:10, 63.09s/it]generating response:  45%|████▌     | 99/218 [1:42:20<2:04:27, 62.75s/it]generating response:  46%|████▌     | 100/218 [1:43:21<2:02:45, 62.42s/it]generating response:  46%|████▋     | 101/218 [1:44:21<2:00:21, 61.73s/it]generating response:  47%|████▋     | 102/218 [1:45:24<2:00:06, 62.12s/it]generating response:  47%|████▋     | 103/218 [1:46:26<1:58:56, 62.06s/it]generating response:  48%|████▊     | 104/218 [1:47:30<1:58:34, 62.41s/it]generating response:  48%|████▊     | 105/218 [1:48:31<1:57:14, 62.26s/it]generating response:  49%|████▊     | 106/218 [1:49:33<1:55:51, 62.07s/it]generating response:  49%|████▉     | 107/218 [1:50:34<1:54:27, 61.87s/it]generating response:  50%|████▉     | 108/218 [1:51:40<1:55:13, 62.85s/it]generating response:  50%|█████     | 109/218 [1:52:43<1:54:12, 62.86s/it]generating response:  50%|█████     | 110/218 [1:53:45<1:53:03, 62.81s/it]generating response:  51%|█████     | 111/218 [1:54:50<1:52:55, 63.32s/it]generating response:  51%|█████▏    | 112/218 [1:55:53<1:51:54, 63.35s/it]generating response:  52%|█████▏    | 113/218 [1:56:56<1:50:30, 63.14s/it]generating response:  52%|█████▏    | 114/218 [1:57:58<1:48:51, 62.80s/it]generating response:  53%|█████▎    | 115/218 [1:59:01<1:47:48, 62.80s/it]generating response:  53%|█████▎    | 116/218 [2:00:03<1:46:35, 62.70s/it]generating response:  54%|█████▎    | 117/218 [2:01:05<1:45:05, 62.43s/it]generating response:  54%|█████▍    | 118/218 [2:02:07<1:43:57, 62.38s/it]generating response:  55%|█████▍    | 119/218 [2:03:09<1:42:41, 62.24s/it]generating response:  55%|█████▌    | 120/218 [2:04:11<1:41:38, 62.23s/it]generating response:  56%|█████▌    | 121/218 [2:05:14<1:40:39, 62.26s/it]generating response:  56%|█████▌    | 122/218 [2:06:16<1:39:35, 62.25s/it]generating response:  56%|█████▋    | 123/218 [2:07:18<1:38:46, 62.38s/it]generating response:  57%|█████▋    | 124/218 [2:08:21<1:37:39, 62.33s/it]generating response:  57%|█████▋    | 125/218 [2:09:23<1:36:32, 62.28s/it]generating response:  58%|█████▊    | 126/218 [2:10:26<1:35:39, 62.39s/it]generating response:  58%|█████▊    | 127/218 [2:11:28<1:34:32, 62.34s/it]generating response:  59%|█████▊    | 128/218 [2:12:29<1:33:15, 62.17s/it]generating response:  59%|█████▉    | 129/218 [2:13:31<1:32:04, 62.07s/it]generating response:  60%|█████▉    | 130/218 [2:14:34<1:31:25, 62.33s/it]generating response:  60%|██████    | 131/218 [2:15:35<1:29:51, 61.97s/it]generating response:  61%|██████    | 132/218 [2:16:36<1:28:18, 61.61s/it]generating response:  61%|██████    | 133/218 [2:17:38<1:27:33, 61.80s/it]generating response:  61%|██████▏   | 134/218 [2:18:40<1:26:29, 61.78s/it]generating response:  62%|██████▏   | 135/218 [2:19:42<1:25:36, 61.89s/it]generating response:  62%|██████▏   | 136/218 [2:20:46<1:25:23, 62.49s/it]generating response:  63%|██████▎   | 137/218 [2:21:49<1:24:30, 62.60s/it]generating response:  63%|██████▎   | 138/218 [2:22:51<1:23:19, 62.50s/it]generating response:  64%|██████▍   | 139/218 [2:23:55<1:22:38, 62.77s/it]generating response:  64%|██████▍   | 140/218 [2:24:57<1:21:32, 62.72s/it]generating response:  65%|██████▍   | 141/218 [2:26:00<1:20:26, 62.68s/it]generating response:  65%|██████▌   | 142/218 [2:27:03<1:19:23, 62.68s/it]generating response:  66%|██████▌   | 143/218 [2:28:06<1:18:31, 62.82s/it]generating response:  66%|██████▌   | 144/218 [2:29:08<1:17:24, 62.77s/it]generating response:  67%|██████▋   | 145/218 [2:30:12<1:16:33, 62.92s/it]generating response:  67%|██████▋   | 146/218 [2:31:15<1:15:31, 62.94s/it]generating response:  67%|██████▋   | 147/218 [2:32:18<1:14:36, 63.05s/it]generating response:  68%|██████▊   | 148/218 [2:33:21<1:13:26, 62.94s/it]generating response:  68%|██████▊   | 149/218 [2:34:23<1:12:19, 62.88s/it]generating response:  69%|██████▉   | 150/218 [2:35:26<1:11:06, 62.74s/it]generating response:  69%|██████▉   | 151/218 [2:36:28<1:09:52, 62.57s/it]generating response:  70%|██████▉   | 152/218 [2:37:29<1:08:21, 62.14s/it]generating response:  70%|███████   | 153/218 [2:38:31<1:07:23, 62.21s/it]generating response:  71%|███████   | 154/218 [2:39:33<1:06:11, 62.05s/it]generating response:  71%|███████   | 155/218 [2:40:36<1:05:23, 62.28s/it]generating response:  72%|███████▏  | 156/218 [2:41:38<1:04:24, 62.34s/it]generating response:  72%|███████▏  | 157/218 [2:42:41<1:03:23, 62.35s/it]generating response:  72%|███████▏  | 158/218 [2:43:46<1:03:04, 63.08s/it]generating response:  73%|███████▎  | 159/218 [2:44:46<1:01:22, 62.42s/it]generating response:  73%|███████▎  | 160/218 [2:45:47<59:49, 61.90s/it]  generating response:  74%|███████▍  | 161/218 [2:46:49<58:50, 61.95s/it]generating response:  74%|███████▍  | 162/218 [2:47:50<57:27, 61.56s/it]generating response:  75%|███████▍  | 163/218 [2:48:50<55:55, 61.01s/it]generating response:  75%|███████▌  | 164/218 [2:49:50<54:46, 60.86s/it]generating response:  76%|███████▌  | 165/218 [2:50:52<54:03, 61.20s/it]generating response:  76%|███████▌  | 166/218 [2:51:53<53:03, 61.22s/it]generating response:  77%|███████▋  | 167/218 [2:52:54<52:00, 61.18s/it]generating response:  77%|███████▋  | 168/218 [2:53:55<50:51, 61.02s/it]generating response:  78%|███████▊  | 169/218 [2:54:58<50:13, 61.51s/it]generating response:  78%|███████▊  | 170/218 [2:56:00<49:24, 61.77s/it]generating response:  78%|███████▊  | 171/218 [2:57:02<48:26, 61.85s/it]generating response:  79%|███████▉  | 172/218 [2:58:06<47:46, 62.32s/it]generating response:  79%|███████▉  | 173/218 [2:59:09<46:59, 62.66s/it]generating response:  80%|███████▉  | 174/218 [3:00:11<45:45, 62.39s/it]generating response:  80%|████████  | 175/218 [3:01:14<44:59, 62.77s/it]generating response:  81%|████████  | 176/218 [3:02:16<43:46, 62.54s/it]generating response:  81%|████████  | 177/218 [3:03:19<42:45, 62.58s/it]generating response:  82%|████████▏ | 178/218 [3:04:22<41:50, 62.76s/it]generating response:  82%|████████▏ | 179/218 [3:05:25<40:42, 62.63s/it]generating response:  83%|████████▎ | 180/218 [3:06:26<39:23, 62.19s/it]generating response:  83%|████████▎ | 181/218 [3:07:28<38:18, 62.12s/it]generating response:  83%|████████▎ | 182/218 [3:08:30<37:20, 62.23s/it]generating response:  84%|████████▍ | 183/218 [3:09:33<36:20, 62.29s/it]generating response:  84%|████████▍ | 184/218 [3:10:35<35:22, 62.42s/it]generating response:  85%|████████▍ | 185/218 [3:11:39<34:27, 62.65s/it]generating response:  85%|████████▌ | 186/218 [3:12:42<33:28, 62.77s/it]generating response:  86%|████████▌ | 187/218 [3:13:45<32:29, 62.88s/it]generating response:  86%|████████▌ | 188/218 [3:14:48<31:25, 62.83s/it]generating response:  87%|████████▋ | 189/218 [3:15:49<30:08, 62.37s/it]generating response:  87%|████████▋ | 190/218 [3:16:51<29:07, 62.40s/it]generating response:  88%|████████▊ | 191/218 [3:17:54<28:10, 62.62s/it]generating response:  88%|████████▊ | 192/218 [3:18:57<27:05, 62.54s/it]generating response:  89%|████████▊ | 193/218 [3:19:59<26:03, 62.55s/it]generating response:  89%|████████▉ | 194/218 [3:21:01<24:57, 62.41s/it]generating response:  89%|████████▉ | 195/218 [3:22:04<23:57, 62.50s/it]generating response:  90%|████████▉ | 196/218 [3:23:07<22:58, 62.64s/it]generating response:  90%|█████████ | 197/218 [3:24:09<21:50, 62.39s/it]generating response:  91%|█████████ | 198/218 [3:25:11<20:45, 62.27s/it]generating response:  91%|█████████▏| 199/218 [3:26:16<19:57, 63.03s/it]generating response:  92%|█████████▏| 200/218 [3:27:18<18:52, 62.89s/it]generating response:  92%|█████████▏| 201/218 [3:28:21<17:49, 62.89s/it]generating response:  93%|█████████▎| 202/218 [3:29:23<16:42, 62.66s/it]generating response:  93%|█████████▎| 203/218 [3:30:26<15:41, 62.74s/it]generating response:  94%|█████████▎| 204/218 [3:31:29<14:36, 62.63s/it]generating response:  94%|█████████▍| 205/218 [3:32:31<13:33, 62.60s/it]generating response:  94%|█████████▍| 206/218 [3:33:34<12:32, 62.67s/it]generating response:  95%|█████████▍| 207/218 [3:34:37<11:29, 62.67s/it]generating response:  95%|█████████▌| 208/218 [3:35:40<10:27, 62.75s/it]generating response:  96%|█████████▌| 209/218 [3:36:44<09:28, 63.17s/it]generating response:  96%|█████████▋| 210/218 [3:37:47<08:25, 63.18s/it]generating response:  97%|█████████▋| 211/218 [3:38:49<07:20, 62.86s/it]generating response:  97%|█████████▋| 212/218 [3:39:53<06:19, 63.21s/it]generating response:  98%|█████████▊| 213/218 [3:40:56<05:16, 63.23s/it]generating response:  98%|█████████▊| 214/218 [3:42:00<04:13, 63.27s/it]generating response:  99%|█████████▊| 215/218 [3:43:01<03:08, 62.79s/it]generating response:  99%|█████████▉| 216/218 [3:44:03<02:04, 62.46s/it]generating response: 100%|█████████▉| 217/218 [3:45:07<01:02, 62.99s/it]generating response: 100%|██████████| 218/218 [3:46:11<00:00, 63.26s/it]generating response: 100%|██████████| 218/218 [3:46:11<00:00, 62.26s/it]
generation part takes 13604.92s
processed 218 images, 218 texts in 13605.02s
using minigpt4 for generation
Loading MiniGPT-4 models...Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.52s/it]
Loading Q-Former
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [01:03<3:48:13, 63.10s/it]generating response:   1%|          | 2/218 [02:04<3:43:12, 62.00s/it]generating response:   1%|▏         | 3/218 [03:07<3:43:43, 62.43s/it]generating response:   2%|▏         | 4/218 [04:11<3:44:42, 63.00s/it]generating response:   2%|▏         | 5/218 [05:13<3:43:12, 62.88s/it]generating response:   3%|▎         | 6/218 [06:15<3:41:10, 62.60s/it]generating response:   3%|▎         | 7/218 [07:17<3:39:26, 62.40s/it]generating response:   4%|▎         | 8/218 [08:22<3:40:32, 63.01s/it]generating response:   4%|▍         | 9/218 [09:26<3:40:27, 63.29s/it]generating response:   5%|▍         | 10/218 [10:32<3:42:30, 64.19s/it]generating response:   5%|▌         | 11/218 [11:35<3:40:00, 63.77s/it]generating response:   6%|▌         | 12/218 [12:37<3:37:29, 63.35s/it]generating response:   6%|▌         | 13/218 [13:41<3:37:11, 63.57s/it]generating response:   6%|▋         | 14/218 [14:44<3:35:23, 63.35s/it]generating response:   7%|▋         | 15/218 [15:45<3:32:19, 62.76s/it]generating response:   7%|▋         | 16/218 [16:48<3:30:52, 62.64s/it]generating response:   8%|▊         | 17/218 [17:50<3:29:56, 62.67s/it]generating response:   8%|▊         | 18/218 [18:54<3:29:47, 62.94s/it]generating response:   9%|▊         | 19/218 [19:57<3:28:37, 62.90s/it]generating response:   9%|▉         | 20/218 [21:00<3:27:24, 62.85s/it]generating response:  10%|▉         | 21/218 [22:05<3:28:52, 63.62s/it]generating response:  10%|█         | 22/218 [23:08<3:26:54, 63.34s/it]generating response:  11%|█         | 23/218 [24:10<3:25:19, 63.17s/it]generating response:  11%|█         | 24/218 [25:14<3:24:12, 63.16s/it]generating response:  11%|█▏        | 25/218 [26:17<3:23:41, 63.32s/it]generating response:  12%|█▏        | 26/218 [27:21<3:22:44, 63.36s/it]generating response:  12%|█▏        | 27/218 [28:25<3:22:27, 63.60s/it]generating response:  13%|█▎        | 28/218 [29:30<3:22:34, 63.97s/it]generating response:  13%|█▎        | 29/218 [30:33<3:21:03, 63.83s/it]generating response:  14%|█▍        | 30/218 [31:35<3:18:21, 63.30s/it]generating response:  14%|█▍        | 31/218 [32:39<3:17:28, 63.36s/it]generating response:  15%|█▍        | 32/218 [33:46<3:20:29, 64.68s/it]generating response:  15%|█▌        | 33/218 [34:47<3:15:53, 63.53s/it]generating response:  16%|█▌        | 34/218 [35:49<3:12:42, 62.84s/it]generating response:  16%|█▌        | 35/218 [36:50<3:10:34, 62.48s/it]generating response:  17%|█▋        | 36/218 [37:53<3:09:36, 62.51s/it]generating response:  17%|█▋        | 37/218 [38:57<3:10:16, 63.07s/it]generating response:  17%|█▋        | 38/218 [40:00<3:09:11, 63.07s/it]generating response:  18%|█▊        | 39/218 [41:04<3:08:35, 63.21s/it]generating response:  18%|█▊        | 40/218 [42:07<3:07:25, 63.17s/it]generating response:  19%|█▉        | 41/218 [43:11<3:06:52, 63.35s/it]generating response:  19%|█▉        | 42/218 [44:14<3:05:55, 63.38s/it]generating response:  20%|█▉        | 43/218 [45:18<3:05:20, 63.55s/it]generating response:  20%|██        | 44/218 [46:20<3:03:02, 63.12s/it]generating response:  21%|██        | 45/218 [47:24<3:02:27, 63.28s/it]generating response:  21%|██        | 46/218 [48:27<3:01:02, 63.16s/it]generating response:  22%|██▏       | 47/218 [49:30<3:00:07, 63.20s/it]generating response:  22%|██▏       | 48/218 [50:33<2:59:14, 63.26s/it]generating response:  22%|██▏       | 49/218 [51:36<2:57:35, 63.05s/it]generating response:  23%|██▎       | 50/218 [52:39<2:56:13, 62.94s/it]generating response:  23%|██▎       | 51/218 [53:42<2:55:12, 62.95s/it]generating response:  24%|██▍       | 52/218 [54:44<2:53:55, 62.86s/it]generating response:  24%|██▍       | 53/218 [55:48<2:53:22, 63.04s/it]generating response:  25%|██▍       | 54/218 [56:51<2:52:54, 63.26s/it]generating response:  25%|██▌       | 55/218 [57:54<2:51:08, 63.00s/it]generating response:  26%|██▌       | 56/218 [58:56<2:49:04, 62.62s/it]generating response:  26%|██▌       | 57/218 [59:57<2:47:14, 62.33s/it]generating response:  27%|██▋       | 58/218 [1:01:00<2:46:53, 62.59s/it]generating response:  27%|██▋       | 59/218 [1:02:04<2:46:26, 62.81s/it]generating response:  28%|██▊       | 60/218 [1:03:05<2:44:21, 62.42s/it]generating response:  28%|██▊       | 61/218 [1:04:13<2:47:13, 63.91s/it]generating response:  28%|██▊       | 62/218 [1:05:19<2:47:53, 64.57s/it]generating response:  29%|██▉       | 63/218 [1:06:21<2:45:11, 63.94s/it]generating response:  29%|██▉       | 64/218 [1:07:24<2:43:25, 63.67s/it]generating response:  30%|██▉       | 65/218 [1:08:27<2:41:26, 63.31s/it]generating response:  30%|███       | 66/218 [1:09:30<2:40:26, 63.33s/it]generating response:  31%|███       | 67/218 [1:10:33<2:39:23, 63.34s/it]generating response:  31%|███       | 68/218 [1:11:36<2:37:24, 62.96s/it]generating response:  32%|███▏      | 69/218 [1:12:39<2:36:47, 63.14s/it]generating response:  32%|███▏      | 70/218 [1:13:41<2:34:39, 62.70s/it]generating response:  33%|███▎      | 71/218 [1:14:43<2:33:28, 62.64s/it]generating response:  33%|███▎      | 72/218 [1:15:45<2:31:37, 62.31s/it]generating response:  33%|███▎      | 73/218 [1:16:48<2:30:58, 62.47s/it]generating response:  34%|███▍      | 74/218 [1:17:50<2:29:43, 62.38s/it]generating response:  34%|███▍      | 75/218 [1:18:53<2:29:15, 62.63s/it]generating response:  35%|███▍      | 76/218 [1:19:58<2:29:32, 63.19s/it]generating response:  35%|███▌      | 77/218 [1:21:00<2:28:11, 63.06s/it]generating response:  36%|███▌      | 78/218 [1:22:03<2:27:14, 63.10s/it]generating response:  36%|███▌      | 79/218 [1:23:07<2:26:16, 63.14s/it]generating response:  37%|███▋      | 80/218 [1:24:10<2:25:22, 63.20s/it]generating response:  37%|███▋      | 81/218 [1:25:13<2:23:51, 63.01s/it]generating response:  38%|███▊      | 82/218 [1:26:15<2:22:06, 62.70s/it]generating response:  38%|███▊      | 83/218 [1:27:16<2:20:23, 62.39s/it]generating response:  39%|███▊      | 84/218 [1:28:19<2:19:22, 62.41s/it]generating response:  39%|███▉      | 85/218 [1:29:21<2:18:08, 62.32s/it]generating response:  39%|███▉      | 86/218 [1:30:24<2:17:25, 62.47s/it]generating response:  40%|███▉      | 87/218 [1:31:28<2:17:30, 62.98s/it]generating response:  40%|████      | 88/218 [1:32:30<2:15:41, 62.62s/it]generating response:  41%|████      | 89/218 [1:33:33<2:15:05, 62.83s/it]generating response:  41%|████▏     | 90/218 [1:34:36<2:14:12, 62.91s/it]generating response:  42%|████▏     | 91/218 [1:35:38<2:12:48, 62.74s/it]generating response:  42%|████▏     | 92/218 [1:36:41<2:11:36, 62.67s/it]generating response:  43%|████▎     | 93/218 [1:37:44<2:11:08, 62.95s/it]generating response:  43%|████▎     | 94/218 [1:38:49<2:11:16, 63.52s/it]generating response:  44%|████▎     | 95/218 [1:39:52<2:09:49, 63.33s/it]generating response:  44%|████▍     | 96/218 [1:40:55<2:08:11, 63.04s/it]generating response:  44%|████▍     | 97/218 [1:41:59<2:07:44, 63.34s/it]generating response:  45%|████▍     | 98/218 [1:43:00<2:05:45, 62.88s/it]generating response:  45%|████▌     | 99/218 [1:44:04<2:04:53, 62.97s/it]generating response:  46%|████▌     | 100/218 [1:45:08<2:04:43, 63.42s/it]generating response:  46%|████▋     | 101/218 [1:46:11<2:03:22, 63.27s/it]generating response:  47%|████▋     | 102/218 [1:47:13<2:01:29, 62.84s/it]generating response:  47%|████▋     | 103/218 [1:48:17<2:00:54, 63.09s/it]generating response:  48%|████▊     | 104/218 [1:49:19<1:59:44, 63.03s/it]generating response:  48%|████▊     | 105/218 [1:50:23<1:58:51, 63.11s/it]generating response:  49%|████▊     | 106/218 [1:51:25<1:57:21, 62.87s/it]generating response:  49%|████▉     | 107/218 [1:52:27<1:56:03, 62.73s/it]generating response:  50%|████▉     | 108/218 [1:53:30<1:55:03, 62.76s/it]generating response:  50%|█████     | 109/218 [1:54:33<1:54:11, 62.86s/it]generating response:  50%|█████     | 110/218 [1:55:37<1:53:31, 63.07s/it]generating response:  51%|█████     | 111/218 [1:56:40<1:52:44, 63.22s/it]generating response:  51%|█████▏    | 112/218 [1:57:44<1:51:58, 63.38s/it]generating response:  52%|█████▏    | 113/218 [1:58:47<1:50:37, 63.22s/it]generating response:  52%|█████▏    | 114/218 [1:59:49<1:49:01, 62.90s/it]generating response:  53%|█████▎    | 115/218 [2:00:54<1:48:41, 63.32s/it]generating response:  53%|█████▎    | 116/218 [2:01:58<1:48:23, 63.76s/it]generating response:  54%|█████▎    | 117/218 [2:03:01<1:46:58, 63.55s/it]generating response:  54%|█████▍    | 118/218 [2:04:05<1:45:53, 63.53s/it]generating response:  55%|█████▍    | 119/218 [2:05:07<1:44:20, 63.24s/it]generating response:  55%|█████▌    | 120/218 [2:06:11<1:43:22, 63.29s/it]generating response:  56%|█████▌    | 121/218 [2:07:14<1:42:04, 63.14s/it]generating response:  56%|█████▌    | 122/218 [2:08:17<1:41:20, 63.34s/it]generating response:  56%|█████▋    | 123/218 [2:09:21<1:40:35, 63.53s/it]generating response:  57%|█████▋    | 124/218 [2:10:26<1:39:49, 63.72s/it]generating response:  57%|█████▋    | 125/218 [2:11:28<1:38:23, 63.47s/it]generating response:  58%|█████▊    | 126/218 [2:12:31<1:36:42, 63.07s/it]generating response:  58%|█████▊    | 127/218 [2:13:33<1:35:29, 62.97s/it]generating response:  59%|█████▊    | 128/218 [2:14:38<1:35:14, 63.50s/it]generating response:  59%|█████▉    | 129/218 [2:15:41<1:34:06, 63.45s/it]generating response:  60%|█████▉    | 130/218 [2:16:44<1:32:53, 63.33s/it]generating response:  60%|██████    | 131/218 [2:17:48<1:32:04, 63.50s/it]generating response:  61%|██████    | 132/218 [2:18:52<1:31:11, 63.62s/it]generating response:  61%|██████    | 133/218 [2:19:55<1:29:49, 63.41s/it]generating response:  61%|██████▏   | 134/218 [2:20:57<1:28:19, 63.08s/it]generating response:  62%|██████▏   | 135/218 [2:22:03<1:28:22, 63.89s/it]generating response:  62%|██████▏   | 136/218 [2:23:09<1:27:59, 64.38s/it]generating response:  63%|██████▎   | 137/218 [2:24:12<1:26:32, 64.10s/it]generating response:  63%|██████▎   | 138/218 [2:25:15<1:24:49, 63.62s/it]generating response:  64%|██████▍   | 139/218 [2:26:18<1:23:45, 63.61s/it]generating response:  64%|██████▍   | 140/218 [2:27:22<1:22:35, 63.54s/it]generating response:  65%|██████▍   | 141/218 [2:28:24<1:21:15, 63.32s/it]generating response:  65%|██████▌   | 142/218 [2:29:28<1:20:24, 63.49s/it]generating response:  66%|██████▌   | 143/218 [2:30:31<1:19:03, 63.25s/it]generating response:  66%|██████▌   | 144/218 [2:31:35<1:18:11, 63.40s/it]generating response:  67%|██████▋   | 145/218 [2:32:38<1:17:14, 63.49s/it]generating response:  67%|██████▋   | 146/218 [2:33:42<1:16:10, 63.48s/it]generating response:  67%|██████▋   | 147/218 [2:34:46<1:15:09, 63.52s/it]generating response:  68%|██████▊   | 148/218 [2:35:50<1:14:15, 63.66s/it]generating response:  68%|██████▊   | 149/218 [2:36:53<1:13:01, 63.49s/it]generating response:  69%|██████▉   | 150/218 [2:37:57<1:12:17, 63.79s/it]generating response:  69%|██████▉   | 151/218 [2:39:03<1:11:46, 64.27s/it]generating response:  70%|██████▉   | 152/218 [2:40:06<1:10:29, 64.08s/it]generating response:  70%|███████   | 153/218 [2:41:11<1:09:38, 64.29s/it]generating response:  71%|███████   | 154/218 [2:42:16<1:08:41, 64.39s/it]generating response:  71%|███████   | 155/218 [2:43:22<1:08:14, 64.99s/it]generating response:  72%|███████▏  | 156/218 [2:44:27<1:07:19, 65.15s/it]generating response:  72%|███████▏  | 157/218 [2:45:32<1:06:07, 65.04s/it]generating response:  72%|███████▏  | 158/218 [2:46:37<1:05:00, 65.00s/it]generating response:  73%|███████▎  | 159/218 [2:47:41<1:03:25, 64.50s/it]generating response:  73%|███████▎  | 160/218 [2:48:44<1:01:56, 64.08s/it]generating response:  74%|███████▍  | 161/218 [2:49:47<1:00:45, 63.95s/it]generating response:  74%|███████▍  | 162/218 [2:50:50<59:16, 63.52s/it]  generating response:  75%|███████▍  | 163/218 [2:51:54<58:27, 63.77s/it]generating response:  75%|███████▌  | 164/218 [2:52:56<56:52, 63.20s/it]generating response:  76%|███████▌  | 165/218 [2:53:59<55:52, 63.25s/it]generating response:  76%|███████▌  | 166/218 [2:55:03<54:54, 63.36s/it]generating response:  77%|███████▋  | 167/218 [2:56:06<53:49, 63.32s/it]generating response:  77%|███████▋  | 168/218 [2:57:11<53:09, 63.79s/it]generating response:  78%|███████▊  | 169/218 [2:58:15<52:08, 63.85s/it]generating response:  78%|███████▊  | 170/218 [2:59:20<51:22, 64.21s/it]generating response:  78%|███████▊  | 171/218 [3:00:24<50:19, 64.25s/it]generating response:  79%|███████▉  | 172/218 [3:01:29<49:22, 64.40s/it]generating response:  79%|███████▉  | 173/218 [3:02:34<48:17, 64.38s/it]generating response:  80%|███████▉  | 174/218 [3:03:38<47:12, 64.37s/it]generating response:  80%|████████  | 175/218 [3:04:43<46:11, 64.44s/it]generating response:  81%|████████  | 176/218 [3:05:46<44:59, 64.26s/it]generating response:  81%|████████  | 177/218 [3:06:51<44:04, 64.49s/it]generating response:  82%|████████▏ | 178/218 [3:07:56<43:02, 64.57s/it]generating response:  82%|████████▏ | 179/218 [3:09:00<41:50, 64.36s/it]generating response:  83%|████████▎ | 180/218 [3:10:05<40:48, 64.42s/it]generating response:  83%|████████▎ | 181/218 [3:11:10<39:51, 64.64s/it]generating response:  83%|████████▎ | 182/218 [3:12:15<38:54, 64.85s/it]generating response:  84%|████████▍ | 183/218 [3:13:19<37:41, 64.62s/it]generating response:  84%|████████▍ | 184/218 [3:14:23<36:26, 64.30s/it]generating response:  85%|████████▍ | 185/218 [3:15:27<35:23, 64.36s/it]generating response:  85%|████████▌ | 186/218 [3:16:33<34:31, 64.73s/it]generating response:  86%|████████▌ | 187/218 [3:17:37<33:22, 64.60s/it]generating response:  86%|████████▌ | 188/218 [3:18:42<32:21, 64.71s/it]generating response:  87%|████████▋ | 189/218 [3:19:46<31:08, 64.42s/it]generating response:  87%|████████▋ | 190/218 [3:20:50<30:03, 64.43s/it]generating response:  88%|████████▊ | 191/218 [3:21:55<28:59, 64.41s/it]generating response:  88%|████████▊ | 192/218 [3:22:59<27:51, 64.30s/it]generating response:  89%|████████▊ | 193/218 [3:24:04<26:51, 64.47s/it]generating response:  89%|████████▉ | 194/218 [3:25:08<25:45, 64.39s/it]generating response:  89%|████████▉ | 195/218 [3:26:13<24:44, 64.56s/it]generating response:  90%|████████▉ | 196/218 [3:27:17<23:38, 64.48s/it]generating response:  90%|█████████ | 197/218 [3:28:21<22:29, 64.26s/it]generating response:  91%|█████████ | 198/218 [3:29:24<21:17, 63.88s/it]generating response:  91%|█████████▏| 199/218 [3:30:28<20:15, 63.96s/it]generating response:  92%|█████████▏| 200/218 [3:31:34<19:23, 64.66s/it]generating response:  92%|█████████▏| 201/218 [3:32:40<18:24, 65.00s/it]generating response:  93%|█████████▎| 202/218 [3:33:45<17:18, 64.93s/it]generating response:  93%|█████████▎| 203/218 [3:34:50<16:13, 64.89s/it]generating response:  94%|█████████▎| 204/218 [3:35:56<15:17, 65.51s/it]generating response:  94%|█████████▍| 205/218 [3:37:01<14:08, 65.23s/it]generating response:  94%|█████████▍| 206/218 [3:38:07<13:04, 65.40s/it]generating response:  95%|█████████▍| 207/218 [3:39:11<11:54, 64.99s/it]generating response:  95%|█████████▌| 208/218 [3:40:16<10:50, 65.02s/it]generating response:  96%|█████████▌| 209/218 [3:41:21<09:44, 64.91s/it]generating response:  96%|█████████▋| 210/218 [3:42:25<08:36, 64.61s/it]generating response:  97%|█████████▋| 211/218 [3:43:28<07:30, 64.42s/it]generating response:  97%|█████████▋| 212/218 [3:44:34<06:28, 64.80s/it]generating response:  98%|█████████▊| 213/218 [3:45:40<05:24, 64.98s/it]generating response:  98%|█████████▊| 214/218 [3:46:46<04:21, 65.39s/it]generating response:  99%|█████████▊| 215/218 [3:47:51<03:16, 65.39s/it]generating response:  99%|█████████▉| 216/218 [3:48:56<02:10, 65.15s/it]generating response: 100%|█████████▉| 217/218 [3:50:01<01:05, 65.08s/it]generating response: 100%|██████████| 218/218 [3:51:07<00:00, 65.39s/it]generating response: 100%|██████████| 218/218 [3:51:07<00:00, 63.61s/it]
generation part takes 13899.17s
processed 218 images, 218 texts in 27504.38s
using minigpt4 for generation
Loading MiniGPT-4 models...Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:30<00:30, 30.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:32<00:00, 13.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:32<00:00, 16.07s/it]
Loading Q-Former
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [01:02<3:45:59, 62.49s/it]generating response:   1%|          | 2/218 [02:03<3:42:43, 61.87s/it]generating response:   1%|▏         | 3/218 [03:05<3:41:42, 61.87s/it]generating response:   2%|▏         | 4/218 [04:09<3:43:33, 62.68s/it]generating response:   2%|▏         | 5/218 [05:14<3:45:16, 63.46s/it]generating response:   3%|▎         | 6/218 [06:19<3:46:19, 64.06s/it]generating response:   3%|▎         | 7/218 [07:23<3:45:10, 64.03s/it]generating response:   4%|▎         | 8/218 [08:29<3:46:22, 64.68s/it]generating response:   4%|▍         | 9/218 [09:35<3:45:59, 64.88s/it]generating response:   5%|▍         | 10/218 [10:39<3:44:26, 64.74s/it]generating response:   5%|▌         | 11/218 [11:45<3:44:30, 65.07s/it]generating response:   6%|▌         | 12/218 [12:49<3:42:51, 64.91s/it]generating response:   6%|▌         | 13/218 [13:54<3:40:59, 64.68s/it]generating response:   6%|▋         | 14/218 [14:57<3:39:00, 64.42s/it]generating response:   7%|▋         | 15/218 [16:01<3:37:19, 64.24s/it]generating response:   7%|▋         | 16/218 [17:06<3:36:21, 64.27s/it]generating response:   8%|▊         | 17/218 [18:08<3:33:35, 63.76s/it]generating response:   8%|▊         | 18/218 [19:13<3:33:27, 64.04s/it]generating response:   9%|▊         | 19/218 [20:17<3:32:39, 64.12s/it]generating response:   9%|▉         | 20/218 [21:21<3:31:12, 64.00s/it]generating response:  10%|▉         | 21/218 [22:26<3:31:37, 64.46s/it]generating response:  10%|█         | 22/218 [23:31<3:30:49, 64.54s/it]generating response:  11%|█         | 23/218 [24:37<3:31:27, 65.06s/it]generating response:  11%|█         | 24/218 [25:42<3:29:32, 64.81s/it]generating response:  11%|█▏        | 25/218 [26:47<3:28:41, 64.88s/it]generating response:  12%|█▏        | 26/218 [27:52<3:27:57, 64.99s/it]generating response:  12%|█▏        | 27/218 [28:56<3:26:08, 64.76s/it]generating response:  13%|█▎        | 28/218 [30:02<3:26:09, 65.10s/it]generating response:  13%|█▎        | 29/218 [31:06<3:24:06, 64.80s/it]generating response:  14%|█▍        | 30/218 [32:11<3:22:47, 64.72s/it]generating response:  14%|█▍        | 31/218 [33:14<3:20:34, 64.36s/it]generating response:  15%|█▍        | 32/218 [34:21<3:22:06, 65.20s/it]generating response:  15%|█▌        | 33/218 [35:25<3:19:36, 64.74s/it]generating response:  16%|█▌        | 34/218 [36:28<3:17:18, 64.34s/it]generating response:  16%|█▌        | 35/218 [37:32<3:15:21, 64.05s/it]generating response:  17%|█▋        | 36/218 [38:34<3:12:46, 63.55s/it]generating response:  17%|█▋        | 37/218 [39:37<3:11:15, 63.40s/it]generating response:  17%|█▋        | 38/218 [40:42<3:11:49, 63.94s/it]generating response:  18%|█▊        | 39/218 [41:48<3:12:08, 64.40s/it]generating response:  18%|█▊        | 40/218 [42:52<3:11:03, 64.40s/it]generating response:  19%|█▉        | 41/218 [43:58<3:11:11, 64.81s/it]generating response:  19%|█▉        | 42/218 [45:02<3:09:00, 64.43s/it]generating response:  20%|█▉        | 43/218 [46:06<3:07:45, 64.38s/it]generating response:  20%|██        | 44/218 [47:10<3:06:33, 64.33s/it]generating response:  21%|██        | 45/218 [48:15<3:05:46, 64.43s/it]generating response:  21%|██        | 46/218 [49:19<3:04:30, 64.36s/it]generating response:  22%|██▏       | 47/218 [50:24<3:04:19, 64.68s/it]generating response:  22%|██▏       | 48/218 [51:29<3:03:27, 64.75s/it]generating response:  22%|██▏       | 49/218 [52:33<3:01:07, 64.31s/it]generating response:  23%|██▎       | 50/218 [53:37<3:00:34, 64.49s/it]generating response:  23%|██▎       | 51/218 [54:42<2:59:27, 64.47s/it]generating response:  24%|██▍       | 52/218 [55:47<2:58:43, 64.60s/it]generating response:  24%|██▍       | 53/218 [56:52<2:58:12, 64.80s/it]generating response:  25%|██▍       | 54/218 [57:57<2:57:39, 65.00s/it]generating response:  25%|██▌       | 55/218 [59:02<2:56:02, 64.80s/it]generating response:  26%|██▌       | 56/218 [1:00:06<2:54:06, 64.48s/it]generating response:  26%|██▌       | 57/218 [1:01:08<2:51:31, 63.92s/it]generating response:  27%|██▋       | 58/218 [1:02:12<2:50:13, 63.83s/it]generating response:  27%|██▋       | 59/218 [1:03:18<2:50:41, 64.41s/it]generating response:  28%|██▊       | 60/218 [1:04:23<2:50:45, 64.85s/it]generating response:  28%|██▊       | 61/218 [1:05:28<2:49:47, 64.89s/it]generating response:  28%|██▊       | 62/218 [1:06:32<2:47:56, 64.59s/it]generating response:  29%|██▉       | 63/218 [1:07:38<2:47:42, 64.92s/it]generating response:  29%|██▉       | 64/218 [1:08:43<2:46:52, 65.02s/it]generating response:  30%|██▉       | 65/218 [1:09:48<2:45:55, 65.07s/it]generating response:  30%|███       | 66/218 [1:10:54<2:44:57, 65.11s/it]generating response:  31%|███       | 67/218 [1:11:58<2:43:31, 64.98s/it]generating response:  31%|███       | 68/218 [1:13:02<2:41:47, 64.72s/it]generating response:  32%|███▏      | 69/218 [1:14:07<2:40:25, 64.60s/it]generating response:  32%|███▏      | 70/218 [1:15:11<2:38:44, 64.35s/it]generating response:  33%|███▎      | 71/218 [1:16:15<2:38:03, 64.51s/it]generating response:  33%|███▎      | 72/218 [1:17:18<2:35:39, 63.97s/it]generating response:  33%|███▎      | 73/218 [1:18:24<2:35:42, 64.43s/it]generating response:  34%|███▍      | 74/218 [1:19:28<2:34:44, 64.48s/it]generating response:  34%|███▍      | 75/218 [1:20:35<2:35:05, 65.08s/it]generating response:  35%|███▍      | 76/218 [1:21:39<2:33:46, 64.97s/it]generating response:  35%|███▌      | 77/218 [1:22:44<2:32:04, 64.71s/it]generating response:  36%|███▌      | 78/218 [1:23:48<2:30:31, 64.51s/it]generating response:  36%|███▌      | 79/218 [1:24:52<2:29:38, 64.59s/it]generating response:  37%|███▋      | 80/218 [1:25:57<2:28:19, 64.49s/it]generating response:  37%|███▋      | 81/218 [1:27:02<2:27:34, 64.63s/it]generating response:  38%|███▊      | 82/218 [1:28:06<2:26:12, 64.50s/it]generating response:  38%|███▊      | 83/218 [1:29:09<2:23:59, 63.99s/it]generating response:  39%|███▊      | 84/218 [1:30:15<2:24:22, 64.64s/it]generating response:  39%|███▉      | 85/218 [1:31:18<2:22:27, 64.27s/it]generating response:  39%|███▉      | 86/218 [1:32:22<2:21:13, 64.19s/it]generating response:  40%|███▉      | 87/218 [1:33:27<2:20:28, 64.34s/it]generating response:  40%|████      | 88/218 [1:34:32<2:20:07, 64.67s/it]generating response:  41%|████      | 89/218 [1:35:38<2:19:30, 64.89s/it]generating response:  41%|████▏     | 90/218 [1:36:42<2:18:12, 64.78s/it]generating response:  42%|████▏     | 91/218 [1:37:46<2:16:31, 64.50s/it]generating response:  42%|████▏     | 92/218 [1:38:51<2:15:48, 64.67s/it]generating response:  43%|████▎     | 93/218 [1:39:55<2:14:25, 64.53s/it]generating response:  43%|████▎     | 94/218 [1:41:00<2:13:15, 64.48s/it]generating response:  44%|████▎     | 95/218 [1:42:04<2:12:04, 64.43s/it]generating response:  44%|████▍     | 96/218 [1:43:07<2:09:53, 63.88s/it]generating response:  44%|████▍     | 97/218 [1:44:11<2:09:04, 64.01s/it]generating response:  45%|████▍     | 98/218 [1:45:16<2:08:39, 64.33s/it]generating response:  45%|████▌     | 99/218 [1:46:23<2:09:03, 65.07s/it]generating response:  46%|████▌     | 100/218 [1:47:28<2:07:51, 65.01s/it]generating response:  46%|████▋     | 101/218 [1:48:35<2:07:52, 65.57s/it]generating response:  47%|████▋     | 102/218 [1:49:40<2:06:29, 65.42s/it]generating response:  47%|████▋     | 103/218 [1:50:44<2:04:56, 65.19s/it]generating response:  48%|████▊     | 104/218 [1:51:48<2:03:10, 64.83s/it]generating response:  48%|████▊     | 105/218 [1:52:53<2:01:50, 64.69s/it]generating response:  49%|████▊     | 106/218 [1:53:57<2:00:41, 64.66s/it]generating response:  49%|████▉     | 107/218 [1:55:01<1:58:55, 64.28s/it]generating response:  50%|████▉     | 108/218 [1:56:05<1:58:01, 64.38s/it]generating response:  50%|█████     | 109/218 [1:57:10<1:56:57, 64.38s/it]generating response:  50%|█████     | 110/218 [1:58:14<1:55:55, 64.40s/it]generating response:  51%|█████     | 111/218 [1:59:18<1:54:40, 64.30s/it]generating response:  51%|█████▏    | 112/218 [2:00:23<1:53:49, 64.43s/it]generating response:  52%|█████▏    | 113/218 [2:01:28<1:53:16, 64.73s/it]generating response:  52%|█████▏    | 114/218 [2:02:33<1:51:59, 64.61s/it]generating response:  53%|█████▎    | 115/218 [2:03:40<1:52:25, 65.49s/it]generating response:  53%|█████▎    | 116/218 [2:04:45<1:50:57, 65.27s/it]generating response:  54%|█████▎    | 117/218 [2:05:50<1:49:44, 65.19s/it]generating response:  54%|█████▍    | 118/218 [2:06:55<1:48:33, 65.14s/it]generating response:  55%|█████▍    | 119/218 [2:07:59<1:47:08, 64.93s/it]generating response:  55%|█████▌    | 120/218 [2:09:04<1:45:55, 64.85s/it]generating response:  56%|█████▌    | 121/218 [2:10:08<1:44:38, 64.73s/it]generating response:  56%|█████▌    | 122/218 [2:11:13<1:43:27, 64.66s/it]generating response:  56%|█████▋    | 123/218 [2:12:19<1:42:51, 64.97s/it]generating response:  57%|█████▋    | 124/218 [2:13:23<1:41:42, 64.92s/it]generating response:  57%|█████▋    | 125/218 [2:14:28<1:40:22, 64.76s/it]generating response:  58%|█████▊    | 126/218 [2:15:32<1:38:52, 64.49s/it]generating response:  58%|█████▊    | 127/218 [2:16:37<1:37:59, 64.61s/it]generating response:  59%|█████▊    | 128/218 [2:17:41<1:36:41, 64.46s/it]generating response:  59%|█████▉    | 129/218 [2:18:47<1:36:13, 64.87s/it]generating response:  60%|█████▉    | 130/218 [2:19:52<1:35:17, 64.97s/it]generating response:  60%|██████    | 131/218 [2:20:56<1:33:53, 64.76s/it]generating response:  61%|██████    | 132/218 [2:22:00<1:32:31, 64.55s/it]generating response:  61%|██████    | 133/218 [2:23:05<1:31:44, 64.76s/it]generating response:  61%|██████▏   | 134/218 [2:24:08<1:29:49, 64.16s/it]generating response:  62%|██████▏   | 135/218 [2:25:12<1:28:46, 64.18s/it]generating response:  62%|██████▏   | 136/218 [2:26:17<1:27:59, 64.39s/it]generating response:  63%|██████▎   | 137/218 [2:27:22<1:27:03, 64.49s/it]generating response:  63%|██████▎   | 138/218 [2:28:27<1:26:07, 64.59s/it]generating response:  64%|██████▍   | 139/218 [2:29:33<1:25:36, 65.02s/it]generating response:  64%|██████▍   | 140/218 [2:30:38<1:24:40, 65.14s/it]generating response:  65%|██████▍   | 141/218 [2:31:43<1:23:32, 65.09s/it]generating response:  65%|██████▌   | 142/218 [2:32:49<1:22:55, 65.47s/it]generating response:  66%|██████▌   | 143/218 [2:33:54<1:21:27, 65.17s/it]generating response:  66%|██████▌   | 144/218 [2:34:59<1:20:09, 65.00s/it]generating response:  67%|██████▋   | 145/218 [2:36:03<1:19:03, 64.98s/it]generating response:  67%|██████▋   | 146/218 [2:37:08<1:17:58, 64.98s/it]generating response:  67%|██████▋   | 147/218 [2:38:14<1:17:03, 65.12s/it]generating response:  68%|██████▊   | 148/218 [2:39:18<1:15:42, 64.89s/it]generating response:  68%|██████▊   | 149/218 [2:40:22<1:14:20, 64.65s/it]generating response:  69%|██████▉   | 150/218 [2:41:27<1:13:17, 64.67s/it]generating response:  69%|██████▉   | 151/218 [2:42:32<1:12:24, 64.85s/it]generating response:  70%|██████▉   | 152/218 [2:43:37<1:11:25, 64.92s/it]generating response:  70%|███████   | 153/218 [2:44:42<1:10:08, 64.75s/it]generating response:  71%|███████   | 154/218 [2:45:47<1:09:12, 64.88s/it]generating response:  71%|███████   | 155/218 [2:46:53<1:08:28, 65.21s/it]generating response:  72%|███████▏  | 156/218 [2:47:56<1:06:45, 64.60s/it]generating response:  72%|███████▏  | 157/218 [2:49:01<1:05:48, 64.73s/it]generating response:  72%|███████▏  | 158/218 [2:50:06<1:04:52, 64.87s/it]generating response:  73%|███████▎  | 159/218 [2:51:10<1:03:20, 64.42s/it]generating response:  73%|███████▎  | 160/218 [2:52:13<1:01:57, 64.09s/it]generating response:  74%|███████▍  | 161/218 [2:53:17<1:00:43, 63.92s/it]generating response:  74%|███████▍  | 162/218 [2:54:19<59:21, 63.59s/it]  generating response:  75%|███████▍  | 163/218 [2:55:23<58:16, 63.56s/it]generating response:  75%|███████▌  | 164/218 [2:56:26<57:10, 63.54s/it]generating response:  76%|███████▌  | 165/218 [2:57:29<55:56, 63.34s/it]generating response:  76%|███████▌  | 166/218 [2:58:35<55:24, 63.93s/it]generating response:  77%|███████▋  | 167/218 [2:59:38<54:13, 63.80s/it]generating response:  77%|███████▋  | 168/218 [3:00:43<53:22, 64.04s/it]generating response:  78%|███████▊  | 169/218 [3:01:47<52:20, 64.10s/it]generating response:  78%|███████▊  | 170/218 [3:02:52<51:27, 64.33s/it]generating response:  78%|███████▊  | 171/218 [3:03:56<50:15, 64.16s/it]generating response:  79%|███████▉  | 172/218 [3:05:00<49:12, 64.17s/it]generating response:  79%|███████▉  | 173/218 [3:06:06<48:33, 64.74s/it]generating response:  80%|███████▉  | 174/218 [3:07:10<47:25, 64.67s/it]generating response:  80%|████████  | 175/218 [3:08:15<46:26, 64.79s/it]generating response:  81%|████████  | 176/218 [3:09:20<45:24, 64.88s/it]generating response:  81%|████████  | 177/218 [3:10:26<44:26, 65.03s/it]generating response:  82%|████████▏ | 178/218 [3:11:30<43:13, 64.85s/it]generating response:  82%|████████▏ | 179/218 [3:12:35<42:10, 64.88s/it]generating response:  83%|████████▎ | 180/218 [3:13:40<41:09, 64.97s/it]generating response:  83%|████████▎ | 181/218 [3:14:44<39:52, 64.67s/it]generating response:  83%|████████▎ | 182/218 [3:15:49<38:45, 64.59s/it]generating response:  84%|████████▍ | 183/218 [3:16:54<37:42, 64.65s/it]generating response:  84%|████████▍ | 184/218 [3:17:58<36:31, 64.46s/it]generating response:  85%|████████▍ | 185/218 [3:19:02<35:24, 64.38s/it]generating response:  85%|████████▌ | 186/218 [3:20:07<34:25, 64.53s/it]generating response:  86%|████████▌ | 187/218 [3:21:10<33:12, 64.26s/it]generating response:  86%|████████▌ | 188/218 [3:22:16<32:24, 64.83s/it]generating response:  87%|████████▋ | 189/218 [3:23:20<31:13, 64.60s/it]generating response:  87%|████████▋ | 190/218 [3:24:24<30:03, 64.41s/it]generating response:  88%|████████▊ | 191/218 [3:25:29<29:00, 64.46s/it]generating response:  88%|████████▊ | 192/218 [3:26:33<27:49, 64.22s/it]generating response:  89%|████████▊ | 193/218 [3:27:36<26:41, 64.05s/it]generating response:  89%|████████▉ | 194/218 [3:28:41<25:39, 64.15s/it]generating response:  89%|████████▉ | 195/218 [3:29:46<24:40, 64.36s/it]generating response:  90%|████████▉ | 196/218 [3:30:50<23:34, 64.30s/it]generating response:  90%|█████████ | 197/218 [3:31:55<22:33, 64.46s/it]generating response:  91%|█████████ | 198/218 [3:32:59<21:30, 64.53s/it]generating response:  91%|█████████▏| 199/218 [3:34:05<20:32, 64.86s/it]generating response:  92%|█████████▏| 200/218 [3:35:10<19:29, 64.98s/it]generating response:  92%|█████████▏| 201/218 [3:36:15<18:25, 65.06s/it]generating response:  93%|█████████▎| 202/218 [3:37:19<17:16, 64.77s/it]generating response:  93%|█████████▎| 203/218 [3:38:24<16:10, 64.68s/it]generating response:  94%|█████████▎| 204/218 [3:39:29<15:05, 64.68s/it]generating response:  94%|█████████▍| 205/218 [3:40:33<14:00, 64.68s/it]generating response:  94%|█████████▍| 206/218 [3:41:37<12:54, 64.50s/it]generating response:  95%|█████████▍| 207/218 [3:42:42<11:51, 64.67s/it]generating response:  95%|█████████▌| 208/218 [3:43:48<10:50, 65.01s/it]generating response:  96%|█████████▌| 209/218 [3:44:54<09:45, 65.09s/it]generating response:  96%|█████████▋| 210/218 [3:45:58<08:38, 64.84s/it]generating response:  97%|█████████▋| 211/218 [3:47:06<07:40, 65.72s/it]generating response:  97%|█████████▋| 212/218 [3:48:10<06:32, 65.41s/it]generating response:  98%|█████████▊| 213/218 [3:49:14<05:24, 64.95s/it]generating response:  98%|█████████▊| 214/218 [3:50:20<04:20, 65.17s/it]generating response:  99%|█████████▊| 215/218 [3:51:25<03:15, 65.26s/it]generating response:  99%|█████████▉| 216/218 [3:52:31<02:10, 65.29s/it]generating response: 100%|█████████▉| 217/218 [3:53:36<01:05, 65.37s/it]generating response: 100%|██████████| 218/218 [3:54:42<00:00, 65.41s/it]generating response: 100%|██████████| 218/218 [3:54:42<00:00, 64.60s/it]
generation part takes 14142.19s
Full generation completed in 41646.58s
query number: 218
-------minigpt4 without defence generation complete-------
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:24<01:39, 24.93s/it]denoise batch:  40%|████      | 2/5 [00:49<01:14, 24.84s/it]denoise batch:  60%|██████    | 3/5 [01:14<00:49, 24.84s/it]denoise batch:  80%|████████  | 4/5 [01:39<00:24, 24.84s/it]denoise batch: 100%|██████████| 5/5 [01:48<00:00, 19.08s/it]denoise batch: 100%|██████████| 5/5 [01:48<00:00, 21.65s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.75it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.87it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.38it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.08it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 218.78s
using qwen for generation
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:02<00:19,  2.11s/it]Loading checkpoint shards:  20%|██        | 2/10 [00:04<00:17,  2.23s/it]Loading checkpoint shards:  30%|███       | 3/10 [00:06<00:15,  2.25s/it]Loading checkpoint shards:  40%|████      | 4/10 [00:08<00:13,  2.18s/it]Loading checkpoint shards:  50%|█████     | 5/10 [00:09<00:08,  1.74s/it]Loading checkpoint shards:  60%|██████    | 6/10 [00:12<00:07,  1.93s/it]Loading checkpoint shards:  70%|███████   | 7/10 [00:13<00:05,  1.81s/it]Loading checkpoint shards:  80%|████████  | 8/10 [00:15<00:03,  1.69s/it]Loading checkpoint shards:  90%|█████████ | 9/10 [00:16<00:01,  1.63s/it]Loading checkpoint shards: 100%|██████████| 10/10 [00:17<00:00,  1.53s/it]Loading checkpoint shards: 100%|██████████| 10/10 [00:17<00:00,  1.78s/it]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:02<07:38,  2.11s/it]generating response:   1%|          | 2/218 [00:04<07:39,  2.13s/it]generating response:   1%|▏         | 3/218 [00:05<06:24,  1.79s/it]generating response:   2%|▏         | 4/218 [00:06<05:25,  1.52s/it]generating response:   2%|▏         | 5/218 [00:07<04:48,  1.35s/it]generating response:   3%|▎         | 6/218 [00:08<04:06,  1.16s/it]generating response:   3%|▎         | 7/218 [00:11<05:54,  1.68s/it]generating response:   4%|▎         | 8/218 [00:18<11:52,  3.39s/it]generating response:   4%|▍         | 9/218 [00:19<09:46,  2.80s/it]generating response:   6%|▋         | 14/218 [00:23<04:26,  1.31s/it]generating response:   7%|▋         | 15/218 [00:27<06:15,  1.85s/it]generating response:   7%|▋         | 16/218 [00:29<06:00,  1.78s/it]generating response:   8%|▊         | 17/218 [00:30<05:41,  1.70s/it]generating response:   8%|▊         | 18/218 [00:31<05:23,  1.62s/it]generating response:   9%|▊         | 19/218 [00:33<05:13,  1.58s/it]generating response:   9%|▉         | 20/218 [00:34<05:11,  1.57s/it]generating response:  10%|█         | 22/218 [00:36<04:12,  1.29s/it]generating response:  11%|█         | 24/218 [00:38<03:22,  1.04s/it]generating response:  11%|█▏        | 25/218 [00:39<03:31,  1.10s/it]generating response:  13%|█▎        | 28/218 [00:40<02:21,  1.34it/s]generating response:  14%|█▍        | 31/218 [00:41<02:01,  1.54it/s]generating response:  15%|█▍        | 32/218 [00:43<02:21,  1.32it/s]generating response:  15%|█▌        | 33/218 [00:44<02:50,  1.08it/s]generating response:  16%|█▌        | 35/218 [00:48<03:59,  1.31s/it]generating response:  17%|█▋        | 37/218 [00:50<03:25,  1.14s/it]generating response:  18%|█▊        | 39/218 [00:51<02:57,  1.01it/s]generating response:  18%|█▊        | 40/218 [00:54<03:36,  1.22s/it]generating response:  19%|█▉        | 41/218 [00:57<05:10,  1.76s/it]generating response:  19%|█▉        | 42/218 [00:59<04:54,  1.67s/it]generating response:  20%|█▉        | 43/218 [01:01<04:59,  1.71s/it]generating response:  20%|██        | 44/218 [01:03<05:15,  1.81s/it]generating response:  21%|██        | 46/218 [01:04<03:32,  1.23s/it]generating response:  22%|██▏       | 47/218 [01:05<03:18,  1.16s/it]generating response:  22%|██▏       | 48/218 [01:06<03:44,  1.32s/it]generating response:  22%|██▏       | 49/218 [01:07<03:32,  1.26s/it]generating response:  23%|██▎       | 50/218 [01:09<03:43,  1.33s/it]generating response:  23%|██▎       | 51/218 [01:10<03:37,  1.30s/it]generating response:  24%|██▍       | 52/218 [01:11<03:30,  1.27s/it]generating response:  24%|██▍       | 53/218 [01:12<03:06,  1.13s/it]generating response:  25%|██▍       | 54/218 [01:13<02:57,  1.08s/it]generating response:  25%|██▌       | 55/218 [01:15<03:11,  1.18s/it]generating response:  26%|██▌       | 56/218 [01:16<03:33,  1.32s/it]generating response:  26%|██▌       | 57/218 [01:18<03:59,  1.49s/it]generating response:  27%|██▋       | 58/218 [01:20<04:22,  1.64s/it]generating response:  27%|██▋       | 59/218 [01:22<04:11,  1.58s/it]generating response:  28%|██▊       | 60/218 [01:23<04:04,  1.55s/it]generating response:  30%|██▉       | 65/218 [01:25<01:46,  1.43it/s]generating response:  30%|███       | 66/218 [01:26<02:04,  1.22it/s]generating response:  31%|███       | 67/218 [01:28<02:40,  1.06s/it]generating response:  31%|███       | 68/218 [01:29<02:44,  1.10s/it]generating response:  32%|███▏      | 69/218 [01:31<03:06,  1.25s/it]generating response:  32%|███▏      | 70/218 [01:32<03:09,  1.28s/it]generating response:  33%|███▎      | 71/218 [01:34<03:24,  1.39s/it]generating response:  33%|███▎      | 72/218 [01:35<03:14,  1.33s/it]generating response:  34%|███▍      | 74/218 [01:37<02:26,  1.02s/it]generating response:  35%|███▍      | 76/218 [01:38<02:08,  1.10it/s]generating response:  35%|███▌      | 77/218 [01:39<02:19,  1.01it/s]generating response:  36%|███▌      | 78/218 [01:41<02:46,  1.19s/it]generating response:  36%|███▌      | 79/218 [01:43<03:07,  1.35s/it]generating response:  37%|███▋      | 81/218 [01:44<02:24,  1.05s/it]generating response:  38%|███▊      | 83/218 [01:48<03:06,  1.38s/it]generating response:  39%|███▉      | 86/218 [01:49<02:03,  1.07it/s]generating response:  40%|████      | 88/218 [01:51<02:00,  1.08it/s]generating response:  41%|████▏     | 90/218 [01:52<01:48,  1.19it/s]generating response:  42%|████▏     | 91/218 [01:54<02:03,  1.03it/s]generating response:  42%|████▏     | 92/218 [01:57<02:47,  1.33s/it]generating response:  43%|████▎     | 93/218 [01:59<03:25,  1.64s/it]generating response:  43%|████▎     | 94/218 [02:02<03:50,  1.86s/it]generating response:  44%|████▎     | 95/218 [02:03<03:23,  1.66s/it]generating response:  44%|████▍     | 96/218 [02:04<03:13,  1.59s/it]generating response:  44%|████▍     | 97/218 [02:06<03:09,  1.56s/it]generating response:  45%|████▍     | 98/218 [02:08<03:33,  1.78s/it]generating response:  45%|████▌     | 99/218 [02:09<03:07,  1.57s/it]generating response:  46%|████▌     | 100/218 [02:11<03:03,  1.55s/it]generating response:  46%|████▋     | 101/218 [02:12<02:37,  1.34s/it]generating response:  47%|████▋     | 103/218 [02:14<02:13,  1.16s/it]generating response:  48%|████▊     | 104/218 [02:16<02:38,  1.39s/it]generating response:  48%|████▊     | 105/218 [02:19<03:46,  2.00s/it]generating response:  49%|████▊     | 106/218 [02:21<03:38,  1.95s/it]generating response:  50%|████▉     | 108/218 [02:23<02:34,  1.40s/it]generating response:  51%|█████     | 111/218 [02:25<02:01,  1.13s/it]generating response:  53%|█████▎    | 115/218 [02:26<01:17,  1.33it/s]generating response:  55%|█████▍    | 119/218 [02:29<01:09,  1.42it/s]generating response:  55%|█████▌    | 120/218 [02:30<01:13,  1.32it/s]generating response:  56%|█████▌    | 121/218 [02:32<01:22,  1.17it/s]generating response:  56%|█████▌    | 122/218 [02:33<01:34,  1.02it/s]generating response:  56%|█████▋    | 123/218 [02:34<01:39,  1.05s/it]generating response:  58%|█████▊    | 127/218 [02:36<01:01,  1.47it/s]generating response:  59%|█████▊    | 128/218 [02:37<01:06,  1.35it/s]generating response:  60%|█████▉    | 130/218 [02:38<01:02,  1.42it/s]generating response:  60%|██████    | 131/218 [02:40<01:12,  1.20it/s]generating response:  61%|██████    | 132/218 [02:41<01:21,  1.06it/s]generating response:  62%|██████▏   | 135/218 [02:42<01:00,  1.36it/s]generating response:  62%|██████▏   | 136/218 [02:44<01:11,  1.14it/s]generating response:  68%|██████▊   | 149/218 [02:50<00:39,  1.76it/s]generating response:  69%|██████▉   | 150/218 [03:03<01:44,  1.54s/it]generating response:  69%|██████▉   | 151/218 [03:09<02:12,  1.98s/it]generating response:  70%|███████   | 153/218 [03:16<02:32,  2.35s/it]generating response:  71%|███████   | 154/218 [03:21<02:46,  2.60s/it]generating response:  72%|███████▏  | 156/218 [03:27<02:48,  2.73s/it]generating response:  72%|███████▏  | 157/218 [03:33<03:28,  3.41s/it]generating response:  73%|███████▎  | 159/218 [03:57<06:05,  6.19s/it]generating response:  74%|███████▍  | 162/218 [04:03<04:06,  4.41s/it]generating response:  76%|███████▌  | 166/218 [04:04<02:15,  2.60s/it]generating response:  77%|███████▋  | 167/218 [04:16<03:19,  3.92s/it]generating response:  79%|███████▉  | 172/218 [04:22<01:58,  2.58s/it]generating response:  80%|███████▉  | 174/218 [04:29<02:02,  2.78s/it]generating response:  80%|████████  | 175/218 [04:34<02:13,  3.10s/it]generating response:  83%|████████▎ | 182/218 [04:44<01:16,  2.11s/it]generating response:  84%|████████▍ | 183/218 [04:49<01:24,  2.42s/it]generating response:  86%|████████▌ | 188/218 [04:58<01:05,  2.17s/it]generating response:  87%|████████▋ | 189/218 [05:05<01:16,  2.64s/it]generating response:  87%|████████▋ | 190/218 [05:11<01:28,  3.15s/it]generating response:  88%|████████▊ | 191/218 [05:16<01:32,  3.43s/it]generating response:  88%|████████▊ | 192/218 [05:25<01:54,  4.39s/it]generating response:  89%|████████▊ | 193/218 [05:32<02:03,  4.93s/it]generating response:  89%|████████▉ | 194/218 [05:40<02:15,  5.63s/it]generating response:  89%|████████▉ | 195/218 [05:45<02:10,  5.68s/it]generating response:  90%|████████▉ | 196/218 [05:54<02:19,  6.35s/it]generating response:  90%|█████████ | 197/218 [06:02<02:22,  6.80s/it]generating response:  91%|█████████ | 198/218 [06:10<02:26,  7.33s/it]generating response:  93%|█████████▎| 202/218 [06:14<00:54,  3.43s/it]generating response:  93%|█████████▎| 203/218 [06:20<00:57,  3.82s/it]generating response:  94%|█████████▎| 204/218 [06:24<00:53,  3.81s/it]generating response:  95%|█████████▍| 207/218 [06:29<00:31,  2.87s/it]generating response:  95%|█████████▌| 208/218 [06:32<00:29,  2.94s/it]generating response:  96%|█████████▌| 209/218 [06:43<00:40,  4.47s/it]generating response:  96%|█████████▋| 210/218 [06:51<00:43,  5.41s/it]generating response:  97%|█████████▋| 211/218 [07:04<00:50,  7.21s/it]generating response:  97%|█████████▋| 212/218 [07:13<00:45,  7.55s/it]generating response:  98%|█████████▊| 213/218 [07:26<00:45,  9.19s/it]generating response:  99%|█████████▊| 215/218 [07:39<00:23,  7.89s/it]generating response:  99%|█████████▉| 216/218 [07:48<00:16,  8.27s/it]generating response: 100%|█████████▉| 217/218 [07:58<00:08,  8.71s/it]generating response: 100%|██████████| 218/218 [08:12<00:00, 10.08s/it]generating response: 100%|██████████| 218/218 [08:12<00:00,  2.26s/it]
generation part takes 538.83s
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:24<01:38, 24.64s/it]denoise batch:  40%|████      | 2/5 [00:49<01:14, 24.68s/it]denoise batch:  60%|██████    | 3/5 [01:14<00:49, 24.70s/it]denoise batch:  80%|████████  | 4/5 [01:38<00:24, 24.73s/it]denoise batch: 100%|██████████| 5/5 [01:47<00:00, 18.99s/it]denoise batch: 100%|██████████| 5/5 [01:47<00:00, 21.53s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.46it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.60it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.25it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.21it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 979.15s
using qwen for generation
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:01<00:15,  1.75s/it]Loading checkpoint shards:  20%|██        | 2/10 [00:02<00:07,  1.03it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:02<00:05,  1.40it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:03<00:03,  1.65it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:03<00:02,  1.82it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:04<00:02,  1.81it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:04<00:01,  1.78it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:05<00:01,  1.73it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:05<00:00,  1.63it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:06<00:00,  1.66it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:06<00:00,  1.54it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:01<06:57,  1.92s/it]generating response:   1%|          | 2/218 [00:04<07:22,  2.05s/it]generating response:   1%|▏         | 3/218 [00:05<06:14,  1.74s/it]generating response:   2%|▏         | 4/218 [00:06<05:18,  1.49s/it]generating response:   2%|▏         | 5/218 [00:07<04:43,  1.33s/it]generating response:   3%|▎         | 6/218 [00:08<04:03,  1.15s/it]generating response:   3%|▎         | 7/218 [00:11<05:51,  1.67s/it]generating response:   4%|▎         | 8/218 [00:30<25:54,  7.40s/it]generating response:   4%|▍         | 9/218 [00:32<19:21,  5.56s/it]generating response:   6%|▋         | 14/218 [00:35<07:20,  2.16s/it]generating response:   7%|▋         | 15/218 [00:40<08:40,  2.56s/it]generating response:   7%|▋         | 16/218 [00:41<07:56,  2.36s/it]generating response:   8%|▊         | 17/218 [00:42<07:12,  2.15s/it]generating response:   8%|▊         | 18/218 [00:44<06:32,  1.96s/it]generating response:   9%|▊         | 19/218 [00:45<06:05,  1.83s/it]generating response:   9%|▉         | 20/218 [00:47<05:48,  1.76s/it]generating response:  11%|█         | 24/218 [00:48<02:52,  1.13it/s]generating response:  11%|█▏        | 25/218 [00:49<03:05,  1.04it/s]generating response:  12%|█▏        | 26/218 [00:50<03:00,  1.06it/s]generating response:  13%|█▎        | 28/218 [00:51<02:30,  1.26it/s]generating response:  14%|█▍        | 31/218 [00:53<02:04,  1.50it/s]generating response:  15%|█▍        | 32/218 [00:54<02:25,  1.28it/s]generating response:  15%|█▌        | 33/218 [00:56<02:55,  1.05it/s]generating response:  16%|█▌        | 35/218 [01:00<04:05,  1.34s/it]generating response:  17%|█▋        | 37/218 [01:01<03:28,  1.15s/it]generating response:  18%|█▊        | 39/218 [01:03<02:56,  1.02it/s]generating response:  18%|█▊        | 40/218 [01:05<03:35,  1.21s/it]generating response:  19%|█▉        | 41/218 [01:09<05:11,  1.76s/it]generating response:  19%|█▉        | 42/218 [01:10<04:54,  1.67s/it]generating response:  20%|█▉        | 43/218 [01:12<04:59,  1.71s/it]generating response:  20%|██        | 44/218 [01:14<05:15,  1.81s/it]generating response:  22%|██▏       | 47/218 [01:15<02:53,  1.01s/it]generating response:  22%|██▏       | 48/218 [01:17<03:18,  1.17s/it]generating response:  22%|██▏       | 49/218 [01:18<03:14,  1.15s/it]generating response:  23%|██▎       | 50/218 [01:19<03:28,  1.24s/it]generating response:  23%|██▎       | 51/218 [01:21<03:26,  1.24s/it]generating response:  24%|██▍       | 52/218 [01:22<03:22,  1.22s/it]generating response:  24%|██▍       | 53/218 [01:22<03:02,  1.11s/it]generating response:  25%|██▍       | 54/218 [01:23<02:54,  1.07s/it]generating response:  25%|██▌       | 55/218 [01:25<03:09,  1.16s/it]generating response:  26%|██▌       | 56/218 [01:27<03:31,  1.31s/it]generating response:  27%|██▋       | 58/218 [01:29<03:06,  1.17s/it]generating response:  27%|██▋       | 59/218 [01:30<03:16,  1.23s/it]generating response:  28%|██▊       | 60/218 [01:31<03:23,  1.29s/it]generating response:  28%|██▊       | 62/218 [01:34<03:07,  1.20s/it]generating response:  30%|██▉       | 65/218 [01:35<02:12,  1.15it/s]generating response:  30%|███       | 66/218 [01:37<02:28,  1.02it/s]generating response:  31%|███       | 67/218 [01:38<02:36,  1.04s/it]generating response:  31%|███       | 68/218 [01:39<02:42,  1.08s/it]generating response:  32%|███▏      | 69/218 [01:41<03:06,  1.25s/it]generating response:  32%|███▏      | 70/218 [01:46<05:29,  2.23s/it]generating response:  33%|███▎      | 71/218 [01:47<05:06,  2.09s/it]generating response:  33%|███▎      | 72/218 [01:49<04:27,  1.83s/it]generating response:  34%|███▍      | 74/218 [01:50<03:05,  1.29s/it]generating response:  34%|███▍      | 75/218 [01:52<03:17,  1.38s/it]generating response:  35%|███▍      | 76/218 [01:53<03:18,  1.40s/it]generating response:  35%|███▌      | 77/218 [01:54<03:12,  1.36s/it]generating response:  36%|███▌      | 78/218 [01:56<03:28,  1.49s/it]generating response:  36%|███▌      | 79/218 [01:59<04:28,  1.93s/it]generating response:  37%|███▋      | 81/218 [02:00<03:05,  1.35s/it]generating response:  38%|███▊      | 83/218 [02:04<03:32,  1.58s/it]generating response:  39%|███▊      | 84/218 [02:08<04:37,  2.07s/it]generating response:  39%|███▉      | 86/218 [02:09<03:16,  1.49s/it]generating response:  40%|████      | 88/218 [02:11<02:47,  1.29s/it]generating response:  41%|████▏     | 90/218 [02:12<02:17,  1.07s/it]generating response:  42%|████▏     | 91/218 [02:14<02:27,  1.16s/it]generating response:  42%|████▏     | 92/218 [02:17<03:10,  1.51s/it]generating response:  43%|████▎     | 93/218 [02:19<03:44,  1.80s/it]generating response:  43%|████▎     | 94/218 [02:22<04:06,  1.98s/it]generating response:  44%|████▎     | 95/218 [02:23<03:34,  1.74s/it]generating response:  44%|████▍     | 96/218 [02:24<03:20,  1.64s/it]generating response:  44%|████▍     | 97/218 [02:26<03:14,  1.60s/it]generating response:  45%|████▍     | 98/218 [02:28<03:37,  1.81s/it]generating response:  45%|████▌     | 99/218 [02:29<03:09,  1.59s/it]generating response:  46%|████▌     | 100/218 [02:31<03:04,  1.56s/it]generating response:  46%|████▋     | 101/218 [02:32<02:38,  1.35s/it]generating response:  47%|████▋     | 103/218 [02:34<02:13,  1.16s/it]generating response:  48%|████▊     | 104/218 [02:36<02:40,  1.41s/it]generating response:  48%|████▊     | 105/218 [02:39<03:47,  2.01s/it]generating response:  49%|████▊     | 106/218 [02:41<03:39,  1.96s/it]generating response:  50%|████▉     | 108/218 [02:43<02:34,  1.41s/it]generating response:  51%|█████     | 111/218 [02:45<01:59,  1.12s/it]generating response:  53%|█████▎    | 115/218 [02:46<01:16,  1.35it/s]generating response:  55%|█████▍    | 119/218 [02:49<01:08,  1.44it/s]generating response:  55%|█████▌    | 120/218 [02:50<01:13,  1.33it/s]generating response:  56%|█████▌    | 121/218 [02:51<01:22,  1.17it/s]generating response:  56%|█████▌    | 122/218 [02:53<01:33,  1.02it/s]generating response:  56%|█████▋    | 123/218 [02:54<01:39,  1.05s/it]generating response:  58%|█████▊    | 127/218 [02:56<01:01,  1.47it/s]generating response:  59%|█████▊    | 128/218 [02:57<01:06,  1.35it/s]generating response:  60%|█████▉    | 130/218 [02:58<01:02,  1.42it/s]generating response:  60%|██████    | 131/218 [02:59<01:13,  1.18it/s]generating response:  61%|██████    | 132/218 [03:01<01:21,  1.05it/s]generating response:  61%|██████    | 133/218 [03:02<01:24,  1.00it/s]generating response:  62%|██████▏   | 135/218 [03:04<01:14,  1.11it/s]generating response:  62%|██████▏   | 136/218 [03:05<01:24,  1.03s/it]generating response:  63%|██████▎   | 137/218 [03:06<01:29,  1.10s/it]generating response:  68%|██████▊   | 149/218 [03:13<00:43,  1.58it/s]generating response:  69%|██████▉   | 150/218 [03:24<01:46,  1.56s/it]generating response:  69%|██████▉   | 151/218 [03:34<02:45,  2.47s/it]generating response:  70%|███████   | 153/218 [03:41<02:58,  2.74s/it]generating response:  71%|███████   | 154/218 [03:49<03:46,  3.55s/it]generating response:  72%|███████▏  | 156/218 [03:53<03:15,  3.16s/it]generating response:  72%|███████▏  | 157/218 [03:59<03:38,  3.58s/it]generating response:  73%|███████▎  | 159/218 [04:14<04:48,  4.89s/it]generating response:  73%|███████▎  | 160/218 [04:16<04:13,  4.36s/it]generating response:  74%|███████▍  | 162/218 [04:21<03:27,  3.70s/it]generating response:  76%|███████▌  | 166/218 [04:22<01:42,  1.98s/it]generating response:  77%|███████▋  | 167/218 [04:37<03:15,  3.84s/it]generating response:  79%|███████▉  | 172/218 [04:42<01:48,  2.37s/it]generating response:  80%|████████  | 175/218 [04:48<01:37,  2.27s/it]generating response:  83%|████████▎ | 180/218 [04:54<01:11,  1.87s/it]generating response:  84%|████████▍ | 183/218 [05:02<01:11,  2.04s/it]generating response:  86%|████████▌ | 188/218 [05:05<00:45,  1.50s/it]generating response:  87%|████████▋ | 190/218 [05:12<00:50,  1.80s/it]generating response:  88%|████████▊ | 191/218 [05:16<00:58,  2.16s/it]generating response:  88%|████████▊ | 192/218 [05:22<01:09,  2.67s/it]generating response:  89%|████████▊ | 193/218 [05:29<01:24,  3.37s/it]generating response:  89%|████████▉ | 194/218 [05:34<01:28,  3.69s/it]generating response:  89%|████████▉ | 195/218 [05:43<01:51,  4.87s/it]generating response:  90%|████████▉ | 196/218 [05:54<02:16,  6.22s/it]generating response:  90%|█████████ | 197/218 [06:04<02:29,  7.12s/it]generating response:  91%|█████████ | 198/218 [06:10<02:20,  7.05s/it]generating response:  93%|█████████▎| 202/218 [06:16<00:57,  3.60s/it]generating response:  94%|█████████▎| 204/218 [06:19<00:43,  3.08s/it]generating response:  95%|█████████▍| 207/218 [06:25<00:28,  2.58s/it]generating response:  95%|█████████▌| 208/218 [06:28<00:27,  2.72s/it]generating response:  96%|█████████▌| 209/218 [06:39<00:36,  4.10s/it]generating response:  96%|█████████▋| 210/218 [06:49<00:42,  5.32s/it]generating response:  97%|█████████▋| 211/218 [07:01<00:47,  6.84s/it]generating response:  97%|█████████▋| 212/218 [07:07<00:40,  6.73s/it]generating response:  98%|█████████▊| 213/218 [07:19<00:40,  8.19s/it]generating response:  99%|█████████▊| 215/218 [07:32<00:22,  7.34s/it]generating response: 100%|█████████▉| 217/218 [07:40<00:06,  6.22s/it]generating response: 100%|██████████| 218/218 [07:53<00:00,  7.53s/it]generating response: 100%|██████████| 218/218 [07:53<00:00,  2.17s/it]
generation part takes 491.29s
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:24<01:38, 24.64s/it]denoise batch:  40%|████      | 2/5 [00:49<01:14, 24.67s/it]denoise batch:  60%|██████    | 3/5 [01:14<00:49, 24.69s/it]denoise batch:  80%|████████  | 4/5 [01:38<00:24, 24.69s/it]denoise batch: 100%|██████████| 5/5 [01:47<00:00, 18.97s/it]denoise batch: 100%|██████████| 5/5 [01:47<00:00, 21.51s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.51it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.59it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.13it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.82it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 1687.43s
using qwen for generation
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:03,  2.29it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.33it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:02,  2.36it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.33it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.34it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.34it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:03<00:01,  2.13it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:01,  1.98it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:04<00:00,  1.84it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  1.86it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.06it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:01<06:57,  1.92s/it]generating response:   1%|          | 2/218 [00:04<07:22,  2.05s/it]generating response:   1%|▏         | 3/218 [00:05<06:14,  1.74s/it]generating response:   2%|▏         | 4/218 [00:06<05:18,  1.49s/it]generating response:   2%|▏         | 5/218 [00:07<04:43,  1.33s/it]generating response:   3%|▎         | 6/218 [00:08<04:02,  1.15s/it]generating response:   3%|▎         | 7/218 [00:11<05:51,  1.67s/it]generating response:   4%|▎         | 8/218 [00:16<10:15,  2.93s/it]generating response:   4%|▍         | 9/218 [00:18<08:38,  2.48s/it]generating response:   6%|▋         | 14/218 [00:21<04:06,  1.21s/it]generating response:   7%|▋         | 15/218 [00:26<05:58,  1.77s/it]generating response:   7%|▋         | 16/218 [00:27<05:46,  1.71s/it]generating response:   8%|▊         | 17/218 [00:28<05:30,  1.65s/it]generating response:   8%|▊         | 18/218 [00:30<05:14,  1.57s/it]generating response:   9%|▊         | 19/218 [00:31<05:06,  1.54s/it]generating response:   9%|▉         | 20/218 [00:33<05:05,  1.54s/it]generating response:  11%|█         | 24/218 [00:34<02:35,  1.25it/s]generating response:  11%|█▏        | 25/218 [00:35<02:51,  1.13it/s]generating response:  13%|█▎        | 28/218 [00:36<02:05,  1.52it/s]generating response:  14%|█▍        | 31/218 [00:38<01:52,  1.66it/s]generating response:  15%|█▍        | 32/218 [00:39<02:15,  1.37it/s]generating response:  15%|█▌        | 33/218 [00:41<02:44,  1.12it/s]generating response:  16%|█▌        | 35/218 [00:46<04:32,  1.49s/it]generating response:  17%|█▋        | 37/218 [00:48<03:47,  1.26s/it]generating response:  18%|█▊        | 39/218 [00:49<03:13,  1.08s/it]generating response:  18%|█▊        | 40/218 [00:51<03:48,  1.28s/it]generating response:  19%|█▉        | 41/218 [00:55<05:19,  1.80s/it]generating response:  19%|█▉        | 42/218 [00:57<05:01,  1.71s/it]generating response:  20%|█▉        | 43/218 [00:58<05:04,  1.74s/it]generating response:  20%|██        | 44/218 [01:00<05:18,  1.83s/it]generating response:  22%|██▏       | 47/218 [01:01<02:55,  1.03s/it]generating response:  22%|██▏       | 48/218 [01:03<03:20,  1.18s/it]generating response:  23%|██▎       | 50/218 [01:05<02:52,  1.03s/it]generating response:  23%|██▎       | 51/218 [01:06<02:58,  1.07s/it]generating response:  24%|██▍       | 53/218 [01:07<02:15,  1.22it/s]generating response:  25%|██▍       | 54/218 [01:08<02:19,  1.18it/s]generating response:  25%|██▌       | 55/218 [01:09<02:39,  1.02it/s]generating response:  26%|██▌       | 56/218 [01:11<03:05,  1.15s/it]generating response:  26%|██▌       | 57/218 [01:13<04:00,  1.50s/it]generating response:  27%|██▋       | 58/218 [01:15<04:20,  1.63s/it]generating response:  27%|██▋       | 59/218 [01:17<04:11,  1.58s/it]generating response:  28%|██▊       | 60/218 [01:18<04:03,  1.54s/it]generating response:  28%|██▊       | 61/218 [01:20<04:10,  1.59s/it]generating response:  28%|██▊       | 62/218 [01:22<04:34,  1.76s/it]generating response:  30%|██▉       | 65/218 [01:24<02:42,  1.06s/it]generating response:  30%|███       | 66/218 [01:25<02:53,  1.14s/it]generating response:  31%|███       | 67/218 [01:26<02:55,  1.16s/it]generating response:  31%|███       | 68/218 [01:27<02:56,  1.18s/it]generating response:  32%|███▏      | 70/218 [01:29<02:23,  1.03it/s]generating response:  33%|███▎      | 71/218 [01:30<02:47,  1.14s/it]generating response:  33%|███▎      | 72/218 [01:32<02:47,  1.15s/it]generating response:  34%|███▍      | 74/218 [01:33<02:13,  1.08it/s]generating response:  34%|███▍      | 75/218 [01:35<02:36,  1.09s/it]generating response:  35%|███▍      | 76/218 [01:36<02:47,  1.18s/it]generating response:  35%|███▌      | 77/218 [01:37<02:50,  1.21s/it]generating response:  36%|███▌      | 78/218 [01:39<03:12,  1.38s/it]generating response:  36%|███▌      | 79/218 [01:41<03:29,  1.51s/it]generating response:  37%|███▋      | 81/218 [01:42<02:33,  1.12s/it]generating response:  39%|███▊      | 84/218 [01:46<02:41,  1.20s/it]generating response:  40%|████      | 88/218 [01:48<01:49,  1.18it/s]generating response:  41%|████▏     | 90/218 [01:49<01:41,  1.26it/s]generating response:  42%|████▏     | 91/218 [01:51<01:55,  1.10it/s]generating response:  42%|████▏     | 92/218 [01:53<02:33,  1.22s/it]generating response:  43%|████▎     | 93/218 [01:56<03:10,  1.53s/it]generating response:  43%|████▎     | 94/218 [01:59<03:37,  1.75s/it]generating response:  44%|████▍     | 97/218 [02:00<02:17,  1.14s/it]generating response:  45%|████▌     | 99/218 [02:01<01:52,  1.06it/s]generating response:  46%|████▌     | 100/218 [02:03<02:03,  1.04s/it]generating response:  46%|████▋     | 101/218 [02:04<01:57,  1.00s/it]generating response:  47%|████▋     | 103/218 [02:05<01:52,  1.02it/s]generating response:  48%|████▊     | 104/218 [02:07<02:17,  1.20s/it]generating response:  48%|████▊     | 105/218 [02:11<03:22,  1.79s/it]generating response:  49%|████▊     | 106/218 [02:13<03:21,  1.80s/it]generating response:  50%|████▉     | 108/218 [02:14<02:26,  1.34s/it]generating response:  50%|█████     | 110/218 [02:15<01:49,  1.02s/it]generating response:  51%|█████     | 111/218 [02:18<02:19,  1.30s/it]generating response:  53%|█████▎    | 115/218 [02:19<01:19,  1.30it/s]generating response:  55%|█████▍    | 119/218 [02:22<01:10,  1.41it/s]generating response:  55%|█████▌    | 120/218 [02:23<01:15,  1.31it/s]generating response:  56%|█████▌    | 121/218 [02:24<01:24,  1.15it/s]generating response:  56%|█████▌    | 122/218 [02:26<01:35,  1.00it/s]generating response:  56%|█████▋    | 123/218 [02:27<01:41,  1.07s/it]generating response:  57%|█████▋    | 125/218 [02:28<01:25,  1.09it/s]generating response:  58%|█████▊    | 127/218 [02:30<01:17,  1.18it/s]generating response:  59%|█████▊    | 128/218 [02:31<01:29,  1.01it/s]generating response:  60%|█████▉    | 130/218 [02:33<01:15,  1.17it/s]generating response:  60%|██████    | 131/218 [02:34<01:24,  1.03it/s]generating response:  61%|██████    | 132/218 [02:35<01:31,  1.06s/it]generating response:  61%|██████    | 133/218 [02:36<01:32,  1.08s/it]generating response:  62%|██████▏   | 135/218 [02:38<01:18,  1.06it/s]generating response:  62%|██████▏   | 136/218 [02:39<01:27,  1.07s/it]generating response:  63%|██████▎   | 137/218 [02:41<01:31,  1.13s/it]generating response:  63%|██████▎   | 138/218 [02:43<01:43,  1.30s/it]generating response:  68%|██████▊   | 149/218 [02:49<00:49,  1.41it/s]generating response:  69%|██████▉   | 150/218 [02:58<01:41,  1.49s/it]generating response:  69%|██████▉   | 151/218 [03:04<02:17,  2.05s/it]generating response:  70%|███████   | 153/218 [03:11<02:38,  2.45s/it]generating response:  71%|███████   | 154/218 [03:19<03:26,  3.23s/it]generating response:  72%|███████▏  | 156/218 [03:23<03:00,  2.92s/it]generating response:  72%|███████▏  | 157/218 [03:35<04:32,  4.46s/it]generating response:  73%|███████▎  | 159/218 [03:50<05:27,  5.56s/it]generating response:  74%|███████▍  | 162/218 [04:04<04:48,  5.15s/it]generating response:  76%|███████▌  | 166/218 [04:09<02:59,  3.46s/it]generating response:  77%|███████▋  | 167/218 [04:23<04:09,  4.89s/it]generating response:  79%|███████▉  | 172/218 [04:28<02:16,  2.96s/it]generating response:  80%|███████▉  | 174/218 [04:35<02:15,  3.07s/it]generating response:  80%|████████  | 175/218 [04:42<02:32,  3.54s/it]generating response:  83%|████████▎ | 180/218 [04:50<01:38,  2.60s/it]generating response:  86%|████████▌ | 188/218 [04:53<00:43,  1.46s/it]generating response:  87%|████████▋ | 189/218 [05:01<00:57,  2.00s/it]generating response:  87%|████████▋ | 190/218 [05:07<01:07,  2.43s/it]generating response:  88%|████████▊ | 191/218 [05:11<01:10,  2.61s/it]generating response:  88%|████████▊ | 192/218 [05:16<01:21,  3.13s/it]generating response:  89%|████████▊ | 193/218 [05:29<02:02,  4.92s/it]generating response:  89%|████████▉ | 194/218 [05:38<02:20,  5.85s/it]generating response:  89%|████████▉ | 195/218 [05:45<02:19,  6.07s/it]generating response:  90%|████████▉ | 196/218 [05:54<02:28,  6.75s/it]generating response:  90%|█████████ | 197/218 [06:02<02:28,  7.08s/it]generating response:  91%|█████████ | 198/218 [06:10<02:26,  7.34s/it]generating response:  93%|█████████▎| 202/218 [06:14<00:56,  3.53s/it]generating response:  93%|█████████▎| 203/218 [06:19<00:56,  3.80s/it]generating response:  94%|█████████▎| 204/218 [06:23<00:53,  3.79s/it]generating response:  95%|█████████▍| 207/218 [06:29<00:32,  2.97s/it]generating response:  95%|█████████▌| 208/218 [06:32<00:30,  3.02s/it]generating response:  96%|█████████▌| 209/218 [06:42<00:39,  4.34s/it]generating response:  96%|█████████▋| 210/218 [06:52<00:45,  5.63s/it]generating response:  97%|█████████▋| 211/218 [07:05<00:51,  7.37s/it]generating response:  97%|█████████▋| 212/218 [07:13<00:46,  7.67s/it]generating response:  98%|█████████▊| 213/218 [07:27<00:46,  9.27s/it]generating response:  99%|█████████▊| 215/218 [07:39<00:23,  7.93s/it]generating response:  99%|█████████▉| 216/218 [07:48<00:16,  8.05s/it]generating response: 100%|█████████▉| 217/218 [07:56<00:08,  8.23s/it]generating response: 100%|██████████| 218/218 [08:10<00:00,  9.68s/it]generating response: 100%|██████████| 218/218 [08:10<00:00,  2.25s/it]
generation part takes 505.79s
Full generation completed in 2193.33s
query number: 218
-------qwen with defence generation complete-------
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processed 218 images, 218 texts in 0.08s
using qwen for generation
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:04,  2.18it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.12it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:03,  2.22it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.29it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.16it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.15it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:03<00:01,  2.18it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:01,  1.99it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:04<00:00,  1.84it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  1.89it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.02it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:02<10:44,  2.97s/it]generating response:   1%|          | 2/218 [00:04<08:00,  2.22s/it]generating response:   1%|▏         | 3/218 [00:07<09:04,  2.53s/it]generating response:   2%|▏         | 4/218 [00:08<07:01,  1.97s/it]generating response:   2%|▏         | 5/218 [00:09<05:48,  1.64s/it]generating response:   3%|▎         | 6/218 [00:10<04:45,  1.35s/it]generating response:   3%|▎         | 7/218 [00:12<05:53,  1.67s/it]generating response:   4%|▎         | 8/218 [00:41<36:26, 10.41s/it]generating response:   4%|▍         | 9/218 [00:43<26:34,  7.63s/it]generating response:   5%|▍         | 10/218 [00:50<25:21,  7.32s/it]generating response:   5%|▌         | 11/218 [00:51<19:05,  5.53s/it]generating response:   6%|▌         | 12/218 [00:53<15:14,  4.44s/it]generating response:   6%|▌         | 13/218 [00:55<12:17,  3.60s/it]generating response:   6%|▋         | 14/218 [00:58<12:05,  3.55s/it]generating response:   7%|▋         | 15/218 [01:03<13:05,  3.87s/it]generating response:   7%|▋         | 16/218 [01:04<10:37,  3.16s/it]generating response:   8%|▊         | 17/218 [01:06<08:47,  2.63s/it]generating response:   8%|▊         | 18/218 [01:07<07:28,  2.24s/it]generating response:   9%|▊         | 19/218 [01:08<06:38,  2.00s/it]generating response:   9%|▉         | 20/218 [01:10<06:09,  1.87s/it]generating response:  10%|▉         | 21/218 [01:13<07:28,  2.28s/it]generating response:  10%|█         | 22/218 [01:15<06:59,  2.14s/it]generating response:  11%|█         | 23/218 [01:17<06:34,  2.02s/it]generating response:  11%|█         | 24/218 [01:18<05:46,  1.79s/it]generating response:  11%|█▏        | 25/218 [01:19<05:19,  1.65s/it]generating response:  12%|█▏        | 26/218 [01:20<04:31,  1.41s/it]generating response:  12%|█▏        | 27/218 [01:21<03:51,  1.21s/it]generating response:  13%|█▎        | 28/218 [01:22<03:43,  1.17s/it]generating response:  13%|█▎        | 29/218 [01:24<04:22,  1.39s/it]generating response:  14%|█▍        | 30/218 [01:25<04:27,  1.43s/it]generating response:  14%|█▍        | 31/218 [01:27<04:31,  1.45s/it]generating response:  15%|█▍        | 32/218 [01:28<04:23,  1.42s/it]generating response:  15%|█▌        | 33/218 [01:30<04:33,  1.48s/it]generating response:  16%|█▌        | 34/218 [01:33<05:47,  1.89s/it]generating response:  16%|█▌        | 35/218 [01:39<09:35,  3.15s/it]generating response:  17%|█▋        | 36/218 [01:41<09:04,  2.99s/it]generating response:  17%|█▋        | 37/218 [01:43<07:44,  2.57s/it]generating response:  17%|█▋        | 38/218 [01:46<08:23,  2.80s/it]generating response:  18%|█▊        | 39/218 [01:48<06:59,  2.34s/it]generating response:  18%|█▊        | 40/218 [01:50<06:36,  2.23s/it]generating response:  19%|█▉        | 41/218 [01:53<07:18,  2.48s/it]generating response:  19%|█▉        | 42/218 [01:54<06:19,  2.15s/it]generating response:  20%|█▉        | 43/218 [01:56<05:59,  2.05s/it]generating response:  20%|██        | 44/218 [01:58<05:59,  2.07s/it]generating response:  21%|██        | 45/218 [01:59<04:51,  1.69s/it]generating response:  21%|██        | 46/218 [02:00<04:07,  1.44s/it]generating response:  22%|██▏       | 47/218 [02:01<03:39,  1.28s/it]generating response:  22%|██▏       | 48/218 [02:02<03:57,  1.40s/it]generating response:  22%|██▏       | 49/218 [02:03<03:40,  1.30s/it]generating response:  23%|██▎       | 50/218 [02:05<03:49,  1.37s/it]generating response:  23%|██▎       | 51/218 [02:06<03:41,  1.32s/it]generating response:  24%|██▍       | 52/218 [02:07<03:32,  1.28s/it]generating response:  24%|██▍       | 53/218 [02:08<03:07,  1.13s/it]generating response:  25%|██▍       | 54/218 [02:09<02:57,  1.08s/it]generating response:  25%|██▌       | 55/218 [02:10<03:11,  1.18s/it]generating response:  26%|██▌       | 56/218 [02:13<04:02,  1.50s/it]generating response:  26%|██▌       | 57/218 [02:15<04:19,  1.61s/it]generating response:  27%|██▋       | 58/218 [02:17<04:36,  1.73s/it]generating response:  27%|██▋       | 59/218 [02:18<04:21,  1.64s/it]generating response:  28%|██▊       | 60/218 [02:19<04:02,  1.53s/it]generating response:  28%|██▊       | 61/218 [02:21<04:09,  1.59s/it]generating response:  28%|██▊       | 62/218 [02:23<04:34,  1.76s/it]generating response:  29%|██▉       | 63/218 [02:25<04:32,  1.76s/it]generating response:  29%|██▉       | 64/218 [02:26<04:06,  1.60s/it]generating response:  30%|██▉       | 65/218 [02:28<04:00,  1.57s/it]generating response:  30%|███       | 66/218 [02:29<03:53,  1.53s/it]generating response:  31%|███       | 67/218 [02:31<04:09,  1.65s/it]generating response:  31%|███       | 68/218 [02:32<03:48,  1.52s/it]generating response:  32%|███▏      | 69/218 [02:34<03:57,  1.60s/it]generating response:  32%|███▏      | 70/218 [02:39<06:26,  2.61s/it]generating response:  33%|███▎      | 71/218 [02:41<05:44,  2.34s/it]generating response:  33%|███▎      | 72/218 [02:42<04:50,  1.99s/it]generating response:  33%|███▎      | 73/218 [02:43<04:07,  1.71s/it]generating response:  34%|███▍      | 74/218 [02:44<03:45,  1.57s/it]generating response:  34%|███▍      | 75/218 [02:46<03:47,  1.59s/it]generating response:  35%|███▍      | 76/218 [02:47<03:39,  1.55s/it]generating response:  35%|███▌      | 77/218 [02:49<03:26,  1.47s/it]generating response:  36%|███▌      | 78/218 [02:50<03:40,  1.57s/it]generating response:  36%|███▌      | 79/218 [02:52<03:47,  1.64s/it]generating response:  37%|███▋      | 80/218 [02:53<03:33,  1.55s/it]generating response:  37%|███▋      | 81/218 [02:55<03:20,  1.46s/it]generating response:  38%|███▊      | 82/218 [02:56<03:22,  1.49s/it]generating response:  38%|███▊      | 83/218 [03:00<04:56,  2.20s/it]generating response:  39%|███▊      | 84/218 [03:04<06:01,  2.70s/it]generating response:  39%|███▉      | 85/218 [03:08<06:44,  3.04s/it]generating response:  39%|███▉      | 86/218 [03:09<05:25,  2.46s/it]generating response:  40%|███▉      | 87/218 [03:10<04:31,  2.07s/it]generating response:  40%|████      | 88/218 [03:12<04:19,  2.00s/it]generating response:  41%|████      | 89/218 [03:13<03:39,  1.70s/it]generating response:  41%|████▏     | 90/218 [03:14<03:21,  1.57s/it]generating response:  42%|████▏     | 91/218 [03:16<03:19,  1.57s/it]generating response:  42%|████▏     | 92/218 [03:18<03:34,  1.70s/it]generating response:  43%|████▎     | 93/218 [03:20<04:11,  2.01s/it]generating response:  43%|████▎     | 94/218 [03:23<04:28,  2.17s/it]generating response:  44%|████▎     | 95/218 [03:24<03:45,  1.84s/it]generating response:  44%|████▍     | 96/218 [03:25<03:27,  1.70s/it]generating response:  44%|████▍     | 97/218 [03:27<03:18,  1.64s/it]generating response:  45%|████▍     | 98/218 [03:29<03:41,  1.85s/it]generating response:  45%|████▌     | 99/218 [03:30<03:11,  1.61s/it]generating response:  46%|████▌     | 100/218 [03:32<03:05,  1.57s/it]generating response:  46%|████▋     | 101/218 [03:33<02:38,  1.35s/it]generating response:  47%|████▋     | 102/218 [03:34<02:41,  1.40s/it]generating response:  47%|████▋     | 103/218 [03:36<02:57,  1.54s/it]generating response:  48%|████▊     | 104/218 [03:38<03:16,  1.72s/it]generating response:  48%|████▊     | 105/218 [03:42<04:22,  2.32s/it]generating response:  49%|████▊     | 106/218 [03:44<04:03,  2.17s/it]generating response:  49%|████▉     | 107/218 [03:45<03:33,  1.92s/it]generating response:  50%|████▉     | 108/218 [03:46<03:13,  1.76s/it]generating response:  50%|█████     | 109/218 [03:48<02:57,  1.63s/it]generating response:  50%|█████     | 110/218 [03:49<02:33,  1.42s/it]generating response:  51%|█████     | 111/218 [03:51<02:55,  1.64s/it]generating response:  51%|█████▏    | 112/218 [03:52<02:47,  1.58s/it]generating response:  52%|█████▏    | 113/218 [03:54<02:43,  1.56s/it]generating response:  52%|█████▏    | 114/218 [03:55<02:34,  1.49s/it]generating response:  53%|█████▎    | 115/218 [03:56<02:27,  1.44s/it]generating response:  53%|█████▎    | 116/218 [03:58<02:24,  1.42s/it]generating response:  54%|█████▎    | 117/218 [03:59<02:12,  1.31s/it]generating response:  54%|█████▍    | 118/218 [04:00<02:02,  1.22s/it]generating response:  55%|█████▍    | 119/218 [04:02<02:39,  1.62s/it]generating response:  55%|█████▌    | 120/218 [04:04<02:23,  1.46s/it]generating response:  56%|█████▌    | 121/218 [04:05<02:20,  1.45s/it]generating response:  56%|█████▌    | 122/218 [04:07<02:22,  1.48s/it]generating response:  56%|█████▋    | 123/218 [04:08<02:16,  1.43s/it]generating response:  57%|█████▋    | 124/218 [04:09<02:08,  1.37s/it]generating response:  57%|█████▋    | 125/218 [04:10<02:06,  1.36s/it]generating response:  58%|█████▊    | 126/218 [04:12<02:05,  1.37s/it]generating response:  58%|█████▊    | 127/218 [04:13<02:06,  1.39s/it]generating response:  59%|█████▊    | 128/218 [04:14<01:56,  1.29s/it]generating response:  59%|█████▉    | 129/218 [04:16<01:54,  1.29s/it]generating response:  60%|█████▉    | 130/218 [04:17<01:52,  1.28s/it]generating response:  60%|██████    | 131/218 [04:18<01:54,  1.32s/it]generating response:  61%|██████    | 132/218 [04:20<01:54,  1.33s/it]generating response:  61%|██████    | 133/218 [04:21<01:48,  1.28s/it]generating response:  61%|██████▏   | 134/218 [04:22<01:48,  1.29s/it]generating response:  62%|██████▏   | 135/218 [04:24<01:52,  1.35s/it]generating response:  62%|██████▏   | 136/218 [04:25<01:54,  1.40s/it]generating response:  63%|██████▎   | 137/218 [04:26<01:51,  1.37s/it]generating response:  63%|██████▎   | 138/218 [04:28<01:59,  1.49s/it]generating response:  64%|██████▍   | 139/218 [04:30<02:14,  1.71s/it]generating response:  64%|██████▍   | 140/218 [04:37<04:09,  3.20s/it]generating response:  65%|██████▍   | 141/218 [04:42<04:42,  3.67s/it]generating response:  65%|██████▌   | 142/218 [04:48<05:35,  4.41s/it]generating response:  66%|██████▌   | 143/218 [04:50<04:43,  3.78s/it]generating response:  66%|██████▌   | 144/218 [04:52<03:58,  3.22s/it]generating response:  67%|██████▋   | 145/218 [04:58<04:44,  3.90s/it]generating response:  67%|██████▋   | 146/218 [05:03<05:09,  4.29s/it]generating response:  67%|██████▋   | 147/218 [05:05<04:26,  3.75s/it]generating response:  68%|██████▊   | 148/218 [05:10<04:42,  4.04s/it]generating response:  68%|██████▊   | 149/218 [05:16<05:21,  4.66s/it]generating response:  69%|██████▉   | 150/218 [05:23<06:05,  5.38s/it]generating response:  69%|██████▉   | 151/218 [05:28<05:50,  5.22s/it]generating response:  70%|██████▉   | 152/218 [05:35<06:07,  5.57s/it]generating response:  70%|███████   | 153/218 [05:40<05:59,  5.52s/it]generating response:  71%|███████   | 154/218 [05:48<06:38,  6.23s/it]generating response:  71%|███████   | 155/218 [05:54<06:31,  6.21s/it]generating response:  72%|███████▏  | 156/218 [05:59<06:09,  5.95s/it]generating response:  72%|███████▏  | 157/218 [06:05<05:49,  5.72s/it]generating response:  72%|███████▏  | 158/218 [06:16<07:23,  7.39s/it]generating response:  73%|███████▎  | 159/218 [06:35<10:39, 10.83s/it]generating response:  73%|███████▎  | 160/218 [06:39<08:39,  8.96s/it]generating response:  74%|███████▍  | 161/218 [06:47<08:10,  8.60s/it]generating response:  74%|███████▍  | 162/218 [06:57<08:20,  8.94s/it]generating response:  75%|███████▍  | 163/218 [07:10<09:19, 10.18s/it]generating response:  75%|███████▌  | 164/218 [07:12<06:59,  7.77s/it]generating response:  76%|███████▌  | 165/218 [07:23<07:44,  8.76s/it]generating response:  76%|███████▌  | 166/218 [07:24<05:36,  6.46s/it]generating response:  77%|███████▋  | 167/218 [07:35<06:36,  7.78s/it]generating response:  77%|███████▋  | 168/218 [07:49<07:59,  9.59s/it]generating response:  78%|███████▊  | 169/218 [07:57<07:24,  9.07s/it]generating response:  78%|███████▊  | 170/218 [08:07<07:30,  9.39s/it]generating response:  78%|███████▊  | 171/218 [08:12<06:28,  8.27s/it]generating response:  79%|███████▉  | 172/218 [08:18<05:45,  7.51s/it]generating response:  79%|███████▉  | 173/218 [08:27<05:53,  7.86s/it]generating response:  80%|███████▉  | 174/218 [08:34<05:31,  7.53s/it]generating response:  80%|████████  | 175/218 [08:40<05:04,  7.08s/it]generating response:  81%|████████  | 176/218 [08:48<05:12,  7.43s/it]generating response:  81%|████████  | 177/218 [08:58<05:42,  8.34s/it]generating response:  82%|████████▏ | 178/218 [09:03<04:50,  7.27s/it]generating response:  82%|████████▏ | 179/218 [09:10<04:39,  7.16s/it]generating response:  83%|████████▎ | 180/218 [09:17<04:25,  7.00s/it]generating response:  83%|████████▎ | 181/218 [09:21<03:47,  6.15s/it]generating response:  83%|████████▎ | 182/218 [09:28<03:56,  6.56s/it]generating response:  84%|████████▍ | 183/218 [09:34<03:41,  6.33s/it]generating response:  84%|████████▍ | 184/218 [09:40<03:34,  6.32s/it]generating response:  85%|████████▍ | 185/218 [09:49<03:53,  7.09s/it]generating response:  85%|████████▌ | 186/218 [09:54<03:19,  6.24s/it]generating response:  86%|████████▌ | 187/218 [10:02<03:35,  6.96s/it]generating response:  86%|████████▌ | 188/218 [10:07<03:08,  6.29s/it]generating response:  87%|████████▋ | 189/218 [10:11<02:44,  5.66s/it]generating response:  87%|████████▋ | 190/218 [10:20<03:06,  6.66s/it]generating response:  88%|████████▊ | 191/218 [10:24<02:37,  5.85s/it]generating response:  88%|████████▊ | 192/218 [10:30<02:30,  5.78s/it]generating response:  89%|████████▊ | 193/218 [10:39<02:52,  6.89s/it]generating response:  89%|████████▉ | 194/218 [10:44<02:31,  6.30s/it]generating response:  89%|████████▉ | 195/218 [10:53<02:44,  7.14s/it]generating response:  90%|████████▉ | 196/218 [11:03<02:54,  7.92s/it]generating response:  90%|█████████ | 197/218 [11:10<02:40,  7.63s/it]generating response:  91%|█████████ | 198/218 [11:16<02:26,  7.31s/it]generating response:  91%|█████████▏| 199/218 [11:24<02:20,  7.42s/it]generating response:  92%|█████████▏| 200/218 [11:33<02:24,  8.00s/it]generating response:  92%|█████████▏| 201/218 [11:36<01:48,  6.36s/it]generating response:  93%|█████████▎| 202/218 [11:41<01:34,  5.89s/it]generating response:  93%|█████████▎| 203/218 [11:46<01:25,  5.69s/it]generating response:  94%|█████████▎| 204/218 [11:50<01:11,  5.10s/it]generating response:  94%|█████████▍| 205/218 [11:58<01:16,  5.90s/it]generating response:  94%|█████████▍| 206/218 [12:02<01:06,  5.54s/it]generating response:  95%|█████████▍| 207/218 [12:08<01:02,  5.70s/it]generating response:  95%|█████████▌| 208/218 [12:12<00:50,  5.03s/it]generating response:  96%|█████████▌| 209/218 [12:21<00:56,  6.24s/it]generating response:  96%|█████████▋| 210/218 [12:30<00:55,  6.97s/it]generating response:  97%|█████████▋| 211/218 [12:44<01:04,  9.17s/it]generating response:  97%|█████████▋| 212/218 [12:52<00:53,  8.95s/it]generating response:  98%|█████████▊| 213/218 [13:04<00:49,  9.81s/it]generating response:  98%|█████████▊| 214/218 [13:26<00:53, 13.48s/it]generating response:  99%|█████████▊| 215/218 [13:40<00:40, 13.58s/it]generating response:  99%|█████████▉| 216/218 [13:49<00:24, 12.10s/it]generating response: 100%|█████████▉| 217/218 [13:58<00:11, 11.23s/it]generating response: 100%|██████████| 218/218 [14:09<00:00, 11.24s/it]generating response: 100%|██████████| 218/218 [14:09<00:00,  3.90s/it]
generation part takes 865.07s
processed 218 images, 218 texts in 865.22s
using qwen for generation
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:03,  2.45it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.47it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:02,  2.51it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.51it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:01<00:01,  2.53it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.55it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:02<00:01,  2.42it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:00,  2.29it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:03<00:00,  2.21it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.29it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.37it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:02<08:08,  2.25s/it]generating response:   1%|          | 2/218 [00:03<06:56,  1.93s/it]generating response:   1%|▏         | 3/218 [00:06<08:29,  2.37s/it]generating response:   2%|▏         | 4/218 [00:07<06:40,  1.87s/it]generating response:   2%|▏         | 5/218 [00:09<05:35,  1.58s/it]generating response:   3%|▎         | 6/218 [00:09<04:37,  1.31s/it]generating response:   3%|▎         | 7/218 [00:12<05:48,  1.65s/it]generating response:   4%|▎         | 8/218 [00:18<10:34,  3.02s/it]generating response:   4%|▍         | 9/218 [00:19<08:52,  2.55s/it]generating response:   5%|▍         | 10/218 [00:25<12:28,  3.60s/it]generating response:   5%|▌         | 11/218 [00:27<10:24,  3.02s/it]generating response:   6%|▌         | 12/218 [00:29<09:13,  2.69s/it]generating response:   6%|▌         | 13/218 [00:30<08:06,  2.37s/it]generating response:   6%|▋         | 14/218 [00:34<09:10,  2.70s/it]generating response:   7%|▋         | 15/218 [00:38<11:04,  3.27s/it]generating response:   7%|▋         | 16/218 [00:40<09:12,  2.74s/it]generating response:   8%|▊         | 17/218 [00:41<07:48,  2.33s/it]generating response:   8%|▊         | 18/218 [00:43<06:46,  2.03s/it]generating response:   9%|▊         | 19/218 [00:44<06:09,  1.86s/it]generating response:   9%|▉         | 20/218 [00:46<05:49,  1.76s/it]generating response:  10%|▉         | 21/218 [00:49<07:14,  2.21s/it]generating response:  10%|█         | 22/218 [00:51<06:47,  2.08s/it]generating response:  11%|█         | 23/218 [00:52<06:25,  1.98s/it]generating response:  11%|█         | 24/218 [00:54<05:49,  1.80s/it]generating response:  11%|█▏        | 25/218 [00:55<05:20,  1.66s/it]generating response:  12%|█▏        | 26/218 [00:56<04:32,  1.42s/it]generating response:  12%|█▏        | 27/218 [00:57<03:52,  1.22s/it]generating response:  13%|█▎        | 28/218 [00:58<03:42,  1.17s/it]generating response:  13%|█▎        | 29/218 [01:00<04:22,  1.39s/it]generating response:  14%|█▍        | 30/218 [01:01<04:27,  1.42s/it]generating response:  14%|█▍        | 31/218 [01:03<04:31,  1.45s/it]generating response:  15%|█▍        | 32/218 [01:04<04:22,  1.41s/it]generating response:  15%|█▌        | 33/218 [01:06<04:32,  1.47s/it]generating response:  16%|█▌        | 34/218 [01:11<08:29,  2.77s/it]generating response:  16%|█▌        | 35/218 [01:17<10:45,  3.53s/it]generating response:  17%|█▋        | 36/218 [01:19<09:53,  3.26s/it]generating response:  17%|█▋        | 37/218 [01:21<08:18,  2.75s/it]generating response:  17%|█▋        | 38/218 [01:24<08:46,  2.93s/it]generating response:  18%|█▊        | 39/218 [01:26<07:15,  2.43s/it]generating response:  18%|█▊        | 40/218 [01:27<06:47,  2.29s/it]generating response:  19%|█▉        | 41/218 [01:31<08:03,  2.73s/it]generating response:  19%|█▉        | 42/218 [01:33<06:50,  2.33s/it]generating response:  20%|█▉        | 43/218 [01:34<06:21,  2.18s/it]generating response:  20%|██        | 44/218 [01:37<06:14,  2.15s/it]generating response:  21%|██        | 45/218 [01:37<05:02,  1.75s/it]generating response:  21%|██        | 46/218 [01:38<04:28,  1.56s/it]generating response:  22%|██▏       | 47/218 [01:39<03:53,  1.37s/it]generating response:  22%|██▏       | 48/218 [01:41<04:07,  1.46s/it]generating response:  22%|██▏       | 49/218 [01:42<03:47,  1.35s/it]generating response:  23%|██▎       | 50/218 [01:44<03:54,  1.40s/it]generating response:  23%|██▎       | 51/218 [01:45<03:44,  1.34s/it]generating response:  24%|██▍       | 52/218 [01:46<03:34,  1.29s/it]generating response:  24%|██▍       | 53/218 [01:47<03:08,  1.14s/it]generating response:  25%|██▍       | 54/218 [01:48<02:58,  1.09s/it]generating response:  25%|██▌       | 55/218 [01:49<03:12,  1.18s/it]generating response:  26%|██▌       | 56/218 [01:51<04:03,  1.50s/it]generating response:  26%|██▌       | 57/218 [01:54<04:48,  1.79s/it]generating response:  27%|██▋       | 58/218 [01:56<04:56,  1.85s/it]generating response:  27%|██▋       | 59/218 [01:57<04:34,  1.73s/it]generating response:  28%|██▊       | 60/218 [01:59<04:12,  1.60s/it]generating response:  28%|██▊       | 61/218 [02:00<04:16,  1.63s/it]generating response:  28%|██▊       | 62/218 [02:03<04:38,  1.79s/it]generating response:  29%|██▉       | 63/218 [02:04<04:35,  1.78s/it]generating response:  29%|██▉       | 64/218 [02:05<04:08,  1.61s/it]generating response:  30%|██▉       | 65/218 [02:07<04:01,  1.58s/it]generating response:  30%|███       | 66/218 [02:08<03:54,  1.54s/it]generating response:  31%|███       | 67/218 [02:10<03:47,  1.51s/it]generating response:  31%|███       | 68/218 [02:11<03:33,  1.42s/it]generating response:  32%|███▏      | 69/218 [02:13<03:47,  1.52s/it]generating response:  32%|███▏      | 70/218 [02:14<03:40,  1.49s/it]generating response:  33%|███▎      | 71/218 [02:16<03:48,  1.55s/it]generating response:  33%|███▎      | 72/218 [02:17<03:29,  1.44s/it]generating response:  33%|███▎      | 73/218 [02:18<03:11,  1.32s/it]generating response:  34%|███▍      | 74/218 [02:19<03:06,  1.29s/it]generating response:  34%|███▍      | 75/218 [02:21<03:18,  1.39s/it]generating response:  35%|███▍      | 76/218 [02:22<03:19,  1.40s/it]generating response:  35%|███▌      | 77/218 [02:24<03:12,  1.36s/it]generating response:  36%|███▌      | 78/218 [02:26<03:30,  1.50s/it]generating response:  36%|███▌      | 79/218 [02:29<04:39,  2.01s/it]generating response:  37%|███▋      | 80/218 [02:30<04:09,  1.81s/it]generating response:  37%|███▋      | 81/218 [02:31<03:45,  1.65s/it]generating response:  38%|███▊      | 82/218 [02:33<03:37,  1.60s/it]generating response:  38%|███▊      | 83/218 [02:37<05:07,  2.28s/it]generating response:  39%|███▊      | 84/218 [02:41<06:08,  2.75s/it]generating response:  39%|███▉      | 85/218 [02:44<06:49,  3.08s/it]generating response:  39%|███▉      | 86/218 [02:46<05:28,  2.49s/it]generating response:  40%|███▉      | 87/218 [02:47<04:33,  2.09s/it]generating response:  40%|████      | 88/218 [02:49<04:21,  2.01s/it]generating response:  41%|████      | 89/218 [02:50<03:40,  1.71s/it]generating response:  41%|████▏     | 90/218 [02:51<03:22,  1.58s/it]generating response:  42%|████▏     | 91/218 [02:52<03:19,  1.57s/it]generating response:  42%|████▏     | 92/218 [03:21<20:38,  9.83s/it]generating response:  43%|████▎     | 93/218 [03:24<16:02,  7.70s/it]generating response:  43%|████▎     | 94/218 [03:27<12:42,  6.15s/it]generating response:  44%|████▎     | 95/218 [03:28<09:28,  4.62s/it]generating response:  44%|████▍     | 96/218 [03:29<07:25,  3.65s/it]generating response:  44%|████▍     | 97/218 [03:31<06:03,  3.01s/it]generating response:  45%|████▍     | 98/218 [03:33<05:36,  2.80s/it]generating response:  45%|████▌     | 99/218 [03:34<04:31,  2.28s/it]generating response:  46%|████▌     | 100/218 [03:36<04:00,  2.04s/it]generating response:  46%|████▋     | 101/218 [03:36<03:16,  1.68s/it]generating response:  47%|████▋     | 102/218 [03:38<03:08,  1.62s/it]generating response:  47%|████▋     | 103/218 [03:40<03:15,  1.70s/it]generating response:  48%|████▊     | 104/218 [03:42<03:29,  1.84s/it]generating response:  48%|████▊     | 105/218 [03:46<04:31,  2.40s/it]generating response:  49%|████▊     | 106/218 [03:47<04:09,  2.23s/it]generating response:  49%|████▉     | 107/218 [03:49<03:37,  1.96s/it]generating response:  50%|████▉     | 108/218 [03:50<03:15,  1.78s/it]generating response:  50%|█████     | 109/218 [03:51<02:59,  1.65s/it]generating response:  50%|█████     | 110/218 [03:52<02:35,  1.44s/it]generating response:  51%|█████     | 111/218 [03:54<02:46,  1.55s/it]generating response:  51%|█████▏    | 112/218 [03:56<02:41,  1.52s/it]generating response:  52%|█████▏    | 113/218 [03:57<02:38,  1.51s/it]generating response:  52%|█████▏    | 114/218 [03:58<02:31,  1.46s/it]generating response:  53%|█████▎    | 115/218 [04:00<02:25,  1.41s/it]generating response:  53%|█████▎    | 116/218 [04:01<02:23,  1.40s/it]generating response:  54%|█████▎    | 117/218 [04:02<02:11,  1.30s/it]generating response:  54%|█████▍    | 118/218 [04:03<02:01,  1.22s/it]generating response:  55%|█████▍    | 119/218 [04:06<02:39,  1.61s/it]generating response:  55%|█████▌    | 120/218 [04:07<02:23,  1.46s/it]generating response:  56%|█████▌    | 121/218 [04:08<02:20,  1.45s/it]generating response:  56%|█████▌    | 122/218 [04:10<02:21,  1.48s/it]generating response:  56%|█████▋    | 123/218 [04:11<02:15,  1.43s/it]generating response:  57%|█████▋    | 124/218 [04:12<02:08,  1.37s/it]generating response:  57%|█████▋    | 125/218 [04:14<02:06,  1.36s/it]generating response:  58%|█████▊    | 126/218 [04:15<02:05,  1.37s/it]generating response:  58%|█████▊    | 127/218 [04:17<02:06,  1.39s/it]generating response:  59%|█████▊    | 128/218 [04:18<02:00,  1.34s/it]generating response:  59%|█████▉    | 129/218 [04:19<01:57,  1.32s/it]generating response:  60%|█████▉    | 130/218 [04:20<01:54,  1.30s/it]generating response:  60%|██████    | 131/218 [04:22<01:55,  1.33s/it]generating response:  61%|██████    | 132/218 [04:23<01:55,  1.34s/it]generating response:  61%|██████    | 133/218 [04:24<01:49,  1.28s/it]generating response:  61%|██████▏   | 134/218 [04:26<01:49,  1.30s/it]generating response:  62%|██████▏   | 135/218 [04:27<01:52,  1.36s/it]generating response:  62%|██████▏   | 136/218 [04:29<01:54,  1.40s/it]generating response:  63%|██████▎   | 137/218 [04:30<01:51,  1.37s/it]generating response:  63%|██████▎   | 138/218 [04:32<01:59,  1.49s/it]generating response:  64%|██████▍   | 139/218 [04:34<02:13,  1.69s/it]generating response:  64%|██████▍   | 140/218 [04:41<04:12,  3.24s/it]generating response:  65%|██████▍   | 141/218 [04:45<04:44,  3.70s/it]generating response:  65%|██████▌   | 142/218 [04:51<05:32,  4.38s/it]generating response:  66%|██████▌   | 143/218 [04:54<04:42,  3.76s/it]generating response:  66%|██████▌   | 144/218 [04:56<03:56,  3.20s/it]generating response:  67%|██████▋   | 145/218 [05:02<05:09,  4.23s/it]generating response:  67%|██████▋   | 146/218 [05:07<05:07,  4.27s/it]generating response:  67%|██████▋   | 147/218 [05:12<05:23,  4.55s/it]generating response:  68%|██████▊   | 148/218 [05:16<05:18,  4.55s/it]generating response:  68%|██████▊   | 149/218 [05:22<05:46,  5.02s/it]generating response:  69%|██████▉   | 150/218 [05:30<06:37,  5.84s/it]generating response:  69%|██████▉   | 151/218 [05:36<06:33,  5.88s/it]generating response:  70%|██████▉   | 152/218 [05:41<06:16,  5.70s/it]generating response:  70%|███████   | 153/218 [05:47<06:12,  5.73s/it]generating response:  71%|███████   | 154/218 [05:54<06:25,  6.02s/it]generating response:  71%|███████   | 155/218 [05:58<05:42,  5.43s/it]generating response:  72%|███████▏  | 156/218 [06:03<05:35,  5.41s/it]generating response:  72%|███████▏  | 157/218 [06:16<07:47,  7.67s/it]generating response:  72%|███████▏  | 158/218 [06:22<07:05,  7.09s/it]generating response:  73%|███████▎  | 159/218 [06:41<10:22, 10.55s/it]generating response:  73%|███████▎  | 160/218 [06:43<07:45,  8.03s/it]generating response:  74%|███████▍  | 161/218 [06:53<08:17,  8.72s/it]generating response:  74%|███████▍  | 162/218 [06:58<07:03,  7.56s/it]generating response:  75%|███████▍  | 163/218 [07:16<09:47, 10.68s/it]generating response:  75%|███████▌  | 164/218 [07:35<11:59, 13.32s/it]generating response:  76%|███████▌  | 165/218 [07:43<10:16, 11.63s/it]generating response:  76%|███████▌  | 166/218 [07:44<07:20,  8.48s/it]generating response:  77%|███████▋  | 167/218 [08:01<09:18, 10.95s/it]generating response:  77%|███████▋  | 168/218 [08:16<10:14, 12.28s/it]generating response:  78%|███████▊  | 169/218 [08:25<09:14, 11.32s/it]generating response:  78%|███████▊  | 170/218 [08:34<08:30, 10.63s/it]generating response:  78%|███████▊  | 171/218 [08:40<07:05,  9.05s/it]generating response:  79%|███████▉  | 172/218 [08:45<06:01,  7.87s/it]generating response:  79%|███████▉  | 173/218 [08:52<05:46,  7.69s/it]generating response:  80%|███████▉  | 174/218 [08:59<05:26,  7.42s/it]generating response:  80%|████████  | 175/218 [09:04<04:53,  6.83s/it]generating response:  81%|████████  | 176/218 [09:10<04:30,  6.43s/it]generating response:  81%|████████  | 177/218 [09:19<04:56,  7.23s/it]generating response:  82%|████████▏ | 178/218 [09:26<04:43,  7.08s/it]generating response:  82%|████████▏ | 179/218 [09:33<04:41,  7.23s/it]generating response:  83%|████████▎ | 180/218 [09:40<04:23,  6.93s/it]generating response:  83%|████████▎ | 181/218 [09:43<03:39,  5.94s/it]generating response:  83%|████████▎ | 182/218 [09:51<03:51,  6.44s/it]generating response:  84%|████████▍ | 183/218 [09:56<03:35,  6.17s/it]generating response:  84%|████████▍ | 184/218 [10:04<03:44,  6.60s/it]generating response:  85%|████████▍ | 185/218 [10:13<04:00,  7.30s/it]generating response:  85%|████████▌ | 186/218 [10:20<03:47,  7.10s/it]generating response:  86%|████████▌ | 187/218 [10:25<03:24,  6.61s/it]generating response:  86%|████████▌ | 188/218 [10:32<03:24,  6.81s/it]generating response:  87%|████████▋ | 189/218 [10:44<03:56,  8.15s/it]generating response:  87%|████████▋ | 190/218 [10:57<04:33,  9.78s/it]generating response:  88%|████████▊ | 191/218 [11:01<03:35,  7.98s/it]generating response:  88%|████████▊ | 192/218 [11:07<03:09,  7.28s/it]generating response:  89%|████████▊ | 193/218 [11:15<03:08,  7.52s/it]generating response:  89%|████████▉ | 194/218 [11:20<02:46,  6.96s/it]generating response:  89%|████████▉ | 195/218 [11:26<02:33,  6.68s/it]generating response:  90%|████████▉ | 196/218 [11:36<02:43,  7.43s/it]generating response:  90%|█████████ | 197/218 [11:45<02:49,  8.08s/it]generating response:  91%|█████████ | 198/218 [11:55<02:49,  8.48s/it]generating response:  91%|█████████▏| 199/218 [12:02<02:36,  8.24s/it]generating response:  92%|█████████▏| 200/218 [12:08<02:14,  7.46s/it]generating response:  92%|█████████▏| 201/218 [12:10<01:41,  5.98s/it]generating response:  93%|█████████▎| 202/218 [12:18<01:41,  6.37s/it]generating response:  93%|█████████▎| 203/218 [12:24<01:33,  6.26s/it]generating response:  94%|█████████▎| 204/218 [12:27<01:17,  5.51s/it]generating response:  94%|█████████▍| 205/218 [12:34<01:16,  5.87s/it]generating response:  94%|█████████▍| 206/218 [12:38<01:03,  5.28s/it]generating response:  95%|█████████▍| 207/218 [12:43<00:58,  5.32s/it]generating response:  95%|█████████▌| 208/218 [12:47<00:46,  4.69s/it]generating response:  96%|█████████▌| 209/218 [13:09<01:30, 10.09s/it]generating response:  96%|█████████▋| 210/218 [13:18<01:17,  9.67s/it]generating response:  97%|█████████▋| 211/218 [13:32<01:17, 11.06s/it]generating response:  97%|█████████▋| 212/218 [13:41<01:01, 10.27s/it]generating response:  98%|█████████▊| 213/218 [13:53<00:53, 10.74s/it]generating response:  98%|█████████▊| 214/218 [14:15<00:57, 14.32s/it]generating response:  99%|█████████▊| 215/218 [14:28<00:41, 13.88s/it]generating response:  99%|█████████▉| 216/218 [14:36<00:24, 12.23s/it]generating response: 100%|█████████▉| 217/218 [14:47<00:11, 11.65s/it]generating response: 100%|██████████| 218/218 [14:58<00:00, 11.47s/it]generating response: 100%|██████████| 218/218 [14:58<00:00,  4.12s/it]
generation part takes 913.37s
processed 218 images, 218 texts in 1778.66s
using qwen for generation
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:04,  2.10it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.24it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:02,  2.37it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.42it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.47it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.50it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:02<00:01,  2.50it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:00,  2.43it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:03<00:00,  2.35it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.37it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.39it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:02<08:07,  2.25s/it]generating response:   1%|          | 2/218 [00:03<06:56,  1.93s/it]generating response:   1%|▏         | 3/218 [00:05<06:32,  1.83s/it]generating response:   2%|▏         | 4/218 [00:06<05:29,  1.54s/it]generating response:   2%|▏         | 5/218 [00:07<04:50,  1.37s/it]generating response:   3%|▎         | 6/218 [00:08<04:07,  1.17s/it]generating response:   3%|▎         | 7/218 [00:10<05:28,  1.56s/it]generating response:   4%|▎         | 8/218 [00:13<06:35,  1.88s/it]generating response:   4%|▍         | 9/218 [00:15<06:08,  1.76s/it]generating response:   5%|▍         | 10/218 [00:21<11:04,  3.19s/it]generating response:   5%|▌         | 11/218 [00:22<09:12,  2.67s/it]generating response:   6%|▌         | 12/218 [00:25<08:40,  2.53s/it]generating response:   6%|▌         | 13/218 [00:26<07:43,  2.26s/it]generating response:   6%|▋         | 14/218 [00:30<08:54,  2.62s/it]generating response:   7%|▋         | 15/218 [00:34<10:52,  3.22s/it]generating response:   7%|▋         | 16/218 [00:36<09:04,  2.70s/it]generating response:   8%|▊         | 17/218 [00:37<07:43,  2.30s/it]generating response:   8%|▊         | 18/218 [00:39<06:42,  2.01s/it]generating response:   9%|▊         | 19/218 [00:40<06:06,  1.84s/it]generating response:   9%|▉         | 20/218 [00:42<05:47,  1.75s/it]generating response:  10%|▉         | 21/218 [00:45<07:12,  2.20s/it]generating response:  10%|█         | 22/218 [00:47<06:46,  2.07s/it]generating response:  11%|█         | 23/218 [00:48<06:24,  1.97s/it]generating response:  11%|█         | 24/218 [00:50<05:48,  1.80s/it]generating response:  11%|█▏        | 25/218 [00:51<05:20,  1.66s/it]generating response:  12%|█▏        | 26/218 [00:52<04:31,  1.42s/it]generating response:  12%|█▏        | 27/218 [00:53<03:51,  1.21s/it]generating response:  13%|█▎        | 28/218 [00:54<03:42,  1.17s/it]generating response:  13%|█▎        | 29/218 [00:56<04:21,  1.39s/it]generating response:  14%|█▍        | 30/218 [00:57<04:27,  1.42s/it]generating response:  14%|█▍        | 31/218 [00:59<04:30,  1.45s/it]generating response:  15%|█▍        | 32/218 [01:00<04:22,  1.41s/it]generating response:  15%|█▌        | 33/218 [01:02<04:32,  1.47s/it]generating response:  16%|█▌        | 34/218 [01:07<08:29,  2.77s/it]generating response:  16%|█▌        | 35/218 [01:13<10:45,  3.53s/it]generating response:  17%|█▋        | 36/218 [01:15<09:53,  3.26s/it]generating response:  17%|█▋        | 37/218 [01:17<08:17,  2.75s/it]generating response:  17%|█▋        | 38/218 [01:20<08:46,  2.93s/it]generating response:  18%|█▊        | 39/218 [01:21<07:15,  2.43s/it]generating response:  18%|█▊        | 40/218 [01:23<06:46,  2.29s/it]generating response:  19%|█▉        | 41/218 [01:26<07:26,  2.52s/it]generating response:  19%|█▉        | 42/218 [01:28<06:23,  2.18s/it]generating response:  20%|█▉        | 43/218 [01:30<06:02,  2.07s/it]generating response:  20%|██        | 44/218 [01:32<06:01,  2.08s/it]generating response:  21%|██        | 45/218 [01:33<04:53,  1.69s/it]generating response:  21%|██        | 46/218 [01:33<04:08,  1.44s/it]generating response:  22%|██▏       | 47/218 [01:34<03:39,  1.28s/it]generating response:  22%|██▏       | 48/218 [01:36<03:57,  1.40s/it]generating response:  22%|██▏       | 49/218 [01:37<03:40,  1.30s/it]generating response:  23%|██▎       | 50/218 [01:39<03:49,  1.37s/it]generating response:  23%|██▎       | 51/218 [01:40<03:40,  1.32s/it]generating response:  24%|██▍       | 52/218 [01:41<03:31,  1.28s/it]generating response:  24%|██▍       | 53/218 [01:42<03:06,  1.13s/it]generating response:  25%|██▍       | 54/218 [01:43<02:57,  1.08s/it]generating response:  25%|██▌       | 55/218 [01:44<03:11,  1.17s/it]generating response:  26%|██▌       | 56/218 [01:46<04:02,  1.50s/it]generating response:  26%|██▌       | 57/218 [01:49<04:48,  1.79s/it]generating response:  27%|██▋       | 58/218 [01:51<04:55,  1.85s/it]generating response:  27%|██▋       | 59/218 [01:52<04:34,  1.73s/it]generating response:  28%|██▊       | 60/218 [01:54<04:11,  1.59s/it]generating response:  28%|██▊       | 61/218 [01:55<04:15,  1.63s/it]generating response:  28%|██▊       | 62/218 [01:57<04:38,  1.78s/it]generating response:  29%|██▉       | 63/218 [01:59<04:35,  1.78s/it]generating response:  29%|██▉       | 64/218 [02:00<04:08,  1.61s/it]generating response:  30%|██▉       | 65/218 [02:02<04:01,  1.58s/it]generating response:  30%|███       | 66/218 [02:03<03:54,  1.54s/it]generating response:  31%|███       | 67/218 [02:05<04:09,  1.66s/it]generating response:  31%|███       | 68/218 [02:06<03:48,  1.52s/it]generating response:  32%|███▏      | 69/218 [02:08<03:57,  1.60s/it]generating response:  32%|███▏      | 70/218 [02:13<06:26,  2.61s/it]generating response:  33%|███▎      | 71/218 [02:15<05:44,  2.34s/it]generating response:  33%|███▎      | 72/218 [02:16<04:50,  1.99s/it]generating response:  33%|███▎      | 73/218 [02:17<04:07,  1.71s/it]generating response:  34%|███▍      | 74/218 [02:18<03:45,  1.56s/it]generating response:  34%|███▍      | 75/218 [02:20<03:45,  1.58s/it]generating response:  35%|███▍      | 76/218 [02:21<03:38,  1.54s/it]generating response:  35%|███▌      | 77/218 [02:23<03:25,  1.46s/it]generating response:  36%|███▌      | 78/218 [02:25<03:39,  1.57s/it]generating response:  36%|███▌      | 79/218 [02:26<03:49,  1.65s/it]generating response:  37%|███▋      | 80/218 [02:28<03:34,  1.55s/it]generating response:  37%|███▋      | 81/218 [02:29<03:21,  1.47s/it]generating response:  38%|███▊      | 82/218 [02:31<03:23,  1.49s/it]generating response:  38%|███▊      | 83/218 [02:34<04:57,  2.20s/it]generating response:  39%|███▊      | 84/218 [02:38<06:01,  2.70s/it]generating response:  39%|███▉      | 85/218 [02:42<06:44,  3.05s/it]generating response:  39%|███▉      | 86/218 [02:43<05:25,  2.47s/it]generating response:  40%|███▉      | 87/218 [02:44<04:30,  2.07s/it]generating response:  40%|████      | 88/218 [02:46<04:19,  2.00s/it]generating response:  41%|████      | 89/218 [02:47<03:39,  1.70s/it]generating response:  41%|████▏     | 90/218 [02:48<03:21,  1.57s/it]generating response:  42%|████▏     | 91/218 [02:50<03:18,  1.57s/it]generating response:  42%|████▏     | 92/218 [02:52<03:34,  1.70s/it]generating response:  43%|████▎     | 93/218 [02:55<04:10,  2.01s/it]generating response:  43%|████▎     | 94/218 [02:57<04:28,  2.16s/it]generating response:  44%|████▎     | 95/218 [02:58<03:45,  1.83s/it]generating response:  44%|████▍     | 96/218 [03:00<03:27,  1.70s/it]generating response:  44%|████▍     | 97/218 [03:01<03:18,  1.64s/it]generating response:  45%|████▍     | 98/218 [03:04<03:41,  1.85s/it]generating response:  45%|████▌     | 99/218 [03:05<03:11,  1.61s/it]generating response:  46%|████▌     | 100/218 [03:06<03:05,  1.57s/it]generating response:  46%|████▋     | 101/218 [03:07<02:38,  1.35s/it]generating response:  47%|████▋     | 102/218 [03:08<02:41,  1.40s/it]generating response:  47%|████▋     | 103/218 [03:10<02:57,  1.54s/it]generating response:  48%|████▊     | 104/218 [03:12<03:12,  1.69s/it]generating response:  48%|████▊     | 105/218 [03:16<04:19,  2.30s/it]generating response:  49%|████▊     | 106/218 [03:18<04:01,  2.16s/it]generating response:  49%|████▉     | 107/218 [03:20<03:58,  2.15s/it]generating response:  50%|████▉     | 108/218 [03:21<03:30,  1.92s/it]generating response:  50%|█████     | 109/218 [03:23<03:09,  1.74s/it]generating response:  50%|█████     | 110/218 [03:24<02:42,  1.50s/it]generating response:  51%|█████     | 111/218 [03:25<02:51,  1.60s/it]generating response:  51%|█████▏    | 112/218 [03:27<02:44,  1.56s/it]generating response:  52%|█████▏    | 113/218 [03:28<02:41,  1.54s/it]generating response:  52%|█████▏    | 114/218 [03:30<02:33,  1.47s/it]generating response:  53%|█████▎    | 115/218 [03:31<02:26,  1.43s/it]generating response:  53%|█████▎    | 116/218 [03:33<02:25,  1.43s/it]generating response:  54%|█████▎    | 117/218 [03:34<02:13,  1.32s/it]generating response:  54%|█████▍    | 118/218 [03:35<02:02,  1.23s/it]generating response:  55%|█████▍    | 119/218 [03:37<02:40,  1.62s/it]generating response:  55%|█████▌    | 120/218 [03:38<02:23,  1.47s/it]generating response:  56%|█████▌    | 121/218 [03:40<02:20,  1.45s/it]generating response:  56%|█████▌    | 122/218 [03:41<02:21,  1.48s/it]generating response:  56%|█████▋    | 123/218 [03:43<02:15,  1.43s/it]generating response:  57%|█████▋    | 124/218 [03:44<02:08,  1.37s/it]generating response:  57%|█████▋    | 125/218 [03:45<02:06,  1.36s/it]generating response:  58%|█████▊    | 126/218 [03:46<02:05,  1.37s/it]generating response:  58%|█████▊    | 127/218 [03:48<02:06,  1.39s/it]generating response:  59%|█████▊    | 128/218 [03:49<02:09,  1.44s/it]generating response:  59%|█████▉    | 129/218 [03:51<02:03,  1.39s/it]generating response:  60%|█████▉    | 130/218 [03:52<01:58,  1.35s/it]generating response:  60%|██████    | 131/218 [03:53<01:58,  1.36s/it]generating response:  61%|██████    | 132/218 [03:55<01:57,  1.36s/it]generating response:  61%|██████    | 133/218 [03:56<01:50,  1.30s/it]generating response:  61%|██████▏   | 134/218 [03:57<01:50,  1.31s/it]generating response:  62%|██████▏   | 135/218 [03:59<01:53,  1.37s/it]generating response:  62%|██████▏   | 136/218 [04:00<01:55,  1.41s/it]generating response:  63%|██████▎   | 137/218 [04:02<01:51,  1.38s/it]generating response:  63%|██████▎   | 138/218 [04:03<01:59,  1.49s/it]generating response:  64%|██████▍   | 139/218 [04:05<02:13,  1.69s/it]generating response:  64%|██████▍   | 140/218 [04:10<03:20,  2.57s/it]generating response:  65%|██████▍   | 141/218 [04:14<03:57,  3.08s/it]generating response:  65%|██████▌   | 142/218 [04:20<05:01,  3.97s/it]generating response:  66%|██████▌   | 143/218 [04:23<04:20,  3.47s/it]generating response:  66%|██████▌   | 144/218 [04:25<03:41,  3.00s/it]generating response:  67%|██████▋   | 145/218 [04:30<04:23,  3.62s/it]generating response:  67%|██████▋   | 146/218 [04:34<04:42,  3.92s/it]generating response:  67%|██████▋   | 147/218 [04:38<04:27,  3.77s/it]generating response:  68%|██████▊   | 148/218 [04:43<04:55,  4.22s/it]generating response:  68%|██████▊   | 149/218 [04:49<05:30,  4.79s/it]generating response:  69%|██████▉   | 150/218 [05:02<08:08,  7.18s/it]generating response:  69%|██████▉   | 151/218 [05:08<07:36,  6.82s/it]generating response:  70%|██████▉   | 152/218 [05:14<07:12,  6.56s/it]generating response:  70%|███████   | 153/218 [05:19<06:43,  6.21s/it]generating response:  71%|███████   | 154/218 [05:28<07:20,  6.89s/it]generating response:  71%|███████   | 155/218 [05:34<07:07,  6.79s/it]generating response:  72%|███████▏  | 156/218 [05:41<07:01,  6.80s/it]generating response:  72%|███████▏  | 157/218 [05:53<08:29,  8.35s/it]generating response:  72%|███████▏  | 158/218 [05:59<07:38,  7.64s/it]generating response:  73%|███████▎  | 159/218 [06:23<12:19, 12.53s/it]generating response:  73%|███████▎  | 160/218 [06:30<10:40, 11.04s/it]generating response:  74%|███████▍  | 161/218 [06:39<09:51, 10.38s/it]generating response:  74%|███████▍  | 162/218 [06:54<10:54, 11.68s/it]generating response:  75%|███████▍  | 163/218 [07:12<12:26, 13.57s/it]generating response:  75%|███████▌  | 164/218 [07:31<13:47, 15.32s/it]generating response:  76%|███████▌  | 165/218 [07:37<11:04, 12.53s/it]generating response:  76%|███████▌  | 166/218 [07:46<09:47, 11.30s/it]generating response:  77%|███████▋  | 167/218 [07:59<10:02, 11.81s/it]generating response:  77%|███████▋  | 168/218 [08:08<09:12, 11.06s/it]generating response:  78%|███████▊  | 169/218 [08:17<08:26, 10.33s/it]generating response:  78%|███████▊  | 170/218 [08:24<07:27,  9.33s/it]generating response:  78%|███████▊  | 171/218 [08:28<06:12,  7.93s/it]generating response:  79%|███████▉  | 172/218 [08:34<05:36,  7.31s/it]generating response:  79%|███████▉  | 173/218 [08:41<05:15,  7.01s/it]generating response:  80%|███████▉  | 174/218 [08:48<05:07,  6.98s/it]generating response:  80%|████████  | 175/218 [08:53<04:35,  6.40s/it]generating response:  81%|████████  | 176/218 [09:00<04:47,  6.85s/it]generating response:  81%|████████  | 177/218 [09:11<05:30,  8.07s/it]generating response:  82%|████████▏ | 178/218 [09:17<04:52,  7.30s/it]generating response:  82%|████████▏ | 179/218 [09:24<04:43,  7.27s/it]generating response:  83%|████████▎ | 180/218 [09:31<04:31,  7.14s/it]generating response:  83%|████████▎ | 181/218 [09:36<03:59,  6.48s/it]generating response:  83%|████████▎ | 182/218 [09:45<04:17,  7.15s/it]generating response:  84%|████████▍ | 183/218 [09:50<03:54,  6.70s/it]generating response:  84%|████████▍ | 184/218 [09:56<03:35,  6.33s/it]generating response:  85%|████████▍ | 185/218 [10:01<03:22,  6.12s/it]generating response:  85%|████████▌ | 186/218 [10:07<03:15,  6.12s/it]generating response:  86%|████████▌ | 187/218 [10:15<03:19,  6.44s/it]generating response:  86%|████████▌ | 188/218 [10:20<03:04,  6.14s/it]generating response:  87%|████████▋ | 189/218 [10:27<03:08,  6.50s/it]generating response:  87%|████████▋ | 190/218 [10:34<03:01,  6.47s/it]generating response:  88%|████████▊ | 191/218 [10:37<02:29,  5.55s/it]generating response:  88%|████████▊ | 192/218 [10:43<02:27,  5.66s/it]generating response:  89%|████████▊ | 193/218 [10:51<02:38,  6.36s/it]generating response:  89%|████████▉ | 194/218 [10:58<02:35,  6.47s/it]generating response:  89%|████████▉ | 195/218 [11:09<02:58,  7.75s/it]generating response:  90%|████████▉ | 196/218 [11:17<02:55,  7.97s/it]generating response:  90%|█████████ | 197/218 [11:25<02:44,  7.83s/it]generating response:  91%|█████████ | 198/218 [11:32<02:34,  7.71s/it]generating response:  91%|█████████▏| 199/218 [11:40<02:26,  7.70s/it]generating response:  92%|█████████▏| 200/218 [11:45<02:07,  7.08s/it]generating response:  92%|█████████▏| 201/218 [11:50<01:49,  6.41s/it]generating response:  93%|█████████▎| 202/218 [11:56<01:37,  6.10s/it]generating response:  93%|█████████▎| 203/218 [12:01<01:29,  5.94s/it]generating response:  94%|█████████▎| 204/218 [12:05<01:13,  5.28s/it]generating response:  94%|█████████▍| 205/218 [12:12<01:15,  5.83s/it]generating response:  94%|█████████▍| 206/218 [12:17<01:06,  5.53s/it]generating response:  95%|█████████▍| 207/218 [12:22<01:00,  5.49s/it]generating response:  95%|█████████▌| 208/218 [12:25<00:48,  4.82s/it]generating response:  96%|█████████▌| 209/218 [12:38<01:03,  7.10s/it]generating response:  96%|█████████▋| 210/218 [12:47<01:00,  7.57s/it]generating response:  97%|█████████▋| 211/218 [13:00<01:04,  9.19s/it]generating response:  97%|█████████▋| 212/218 [13:12<01:00, 10.06s/it]generating response:  98%|█████████▊| 213/218 [13:25<00:55, 11.11s/it]generating response:  98%|█████████▊| 214/218 [13:51<01:01, 15.40s/it]generating response:  99%|█████████▊| 215/218 [14:04<00:44, 14.82s/it]generating response:  99%|█████████▉| 216/218 [14:14<00:26, 13.20s/it]generating response: 100%|█████████▉| 217/218 [14:24<00:12, 12.53s/it]generating response: 100%|██████████| 218/218 [14:36<00:00, 12.11s/it]generating response: 100%|██████████| 218/218 [14:36<00:00,  4.02s/it]
generation part takes 890.68s
Full generation completed in 2669.40s
query number: 218
-------qwen without defence generation complete-------
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:24<01:39, 24.91s/it]denoise batch:  40%|████      | 2/5 [00:49<01:14, 24.83s/it]denoise batch:  60%|██████    | 3/5 [01:14<00:49, 24.83s/it]denoise batch:  80%|████████  | 4/5 [01:39<00:24, 24.84s/it]denoise batch: 100%|██████████| 5/5 [01:48<00:00, 19.08s/it]denoise batch: 100%|██████████| 5/5 [01:48<00:00, 21.65s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.67it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.82it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.38it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.05it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 218.07s
using gpt4 for generation
generating response:   0%|          | 0/218 [00:00<?, ?it/s]exception encountered with query0
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408300565073872217824566)', 'type': 'one_api_error'}}
generating response:   0%|          | 1/218 [00:21<1:16:38, 21.19s/it]exception encountered with query2
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408302562792640309174645)', 'type': 'one_api_error'}}
generating response:   1%|▏         | 3/218 [00:41<46:11, 12.89s/it]  exception encountered with query3
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408304553943780849224621)', 'type': 'one_api_error'}}
generating response:   2%|▏         | 4/218 [01:01<54:38, 15.32s/it]exception encountered with query4
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408310588564898304824701)', 'type': 'one_api_error'}}
generating response:   2%|▏         | 5/218 [01:21<1:00:17, 16.98s/it]exception encountered with query5
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408312635963841586705698)', 'type': 'one_api_error'}}
generating response:   3%|▎         | 6/218 [01:41<1:03:57, 18.10s/it]exception encountered with query6
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408314619973093217480523)', 'type': 'one_api_error'}}
generating response:   3%|▎         | 7/218 [02:01<1:05:35, 18.65s/it]exception encountered with query7
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406040832075442353792151454)', 'type': 'one_api_error'}}
generating response:   4%|▎         | 8/218 [02:22<1:07:40, 19.34s/it]exception encountered with query8
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408322848941147192938967)', 'type': 'one_api_error'}}
generating response:   4%|▍         | 9/218 [02:44<1:09:37, 19.99s/it]exception encountered with query13
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408324946904012920413201)', 'type': 'one_api_error'}}
generating response:   6%|▋         | 14/218 [03:05<31:04,  9.14s/it] exception encountered with query14
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408330999425588220510617)', 'type': 'one_api_error'}}
generating response:   7%|▋         | 15/218 [03:25<37:14, 11.01s/it]exception encountered with query15
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408333042888517542611736)', 'type': 'one_api_error'}}
generating response:   7%|▋         | 16/218 [03:45<43:05, 12.80s/it]exception encountered with query16
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408335222804162548739447)', 'type': 'one_api_error'}}
generating response:   8%|▊         | 17/218 [04:07<49:18, 14.72s/it]exception encountered with query17
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408341452154686573127411)', 'type': 'one_api_error'}}
generating response:   8%|▊         | 18/218 [04:30<54:58, 16.49s/it]exception encountered with query18
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408343645005122345248627)', 'type': 'one_api_error'}}
generating response:   9%|▊         | 19/218 [04:52<59:12, 17.85s/it]exception encountered with query19
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408345866601865772960562)', 'type': 'one_api_error'}}
generating response:   9%|▉         | 20/218 [05:14<1:02:41, 19.00s/it]exception encountered with query21
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408352776886055274393624)', 'type': 'one_api_error'}}
generating response:  10%|█         | 22/218 [05:43<55:54, 17.11s/it]  exception encountered with query23
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408355081614598765713439)', 'type': 'one_api_error'}}
generating response:  11%|█         | 24/218 [06:06<48:25, 14.98s/it]exception encountered with query24
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408361327770471075870513)', 'type': 'one_api_error'}}
generating response:  11%|█▏        | 25/218 [06:28<53:19, 16.58s/it]exception encountered with query27
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408363497369588479955555)', 'type': 'one_api_error'}}
generating response:  13%|█▎        | 28/218 [06:50<38:19, 12.10s/it]exception encountered with query29
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408365819180539531908705)', 'type': 'one_api_error'}}
generating response:  14%|█▍        | 30/218 [07:13<37:26, 11.95s/it]exception encountered with query30
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408372077964131956212394)', 'type': 'one_api_error'}}
generating response:  14%|█▍        | 31/218 [07:36<43:18, 13.90s/it]exception encountered with query31
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408374197160141498273967)', 'type': 'one_api_error'}}
generating response:  15%|█▍        | 32/218 [07:57<47:43, 15.39s/it]exception encountered with query32
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408380398204863628416592)', 'type': 'one_api_error'}}
generating response:  15%|█▌        | 33/218 [08:19<52:07, 16.91s/it]exception encountered with query34
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408382449323765953585826)', 'type': 'one_api_error'}}
generating response:  16%|█▌        | 35/218 [08:40<43:32, 14.28s/it]exception encountered with query36
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408384695047544591419260)', 'type': 'one_api_error'}}
generating response:  17%|█▋        | 37/218 [09:02<39:46, 13.19s/it]exception encountered with query38
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408390732362157960597676)', 'type': 'one_api_error'}}
generating response:  18%|█▊        | 39/218 [09:22<36:16, 12.16s/it]exception encountered with query39
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408393032590333763700610)', 'type': 'one_api_error'}}
generating response:  18%|█▊        | 40/218 [09:45<42:24, 14.29s/it]exception encountered with query40
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408395074251260135385976)', 'type': 'one_api_error'}}
generating response:  19%|█▉        | 41/218 [10:06<46:03, 15.61s/it]exception encountered with query41
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408401251124924602810096)', 'type': 'one_api_error'}}
generating response:  19%|█▉        | 42/218 [10:28<50:06, 17.08s/it]exception encountered with query42
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408403212342090640931418)', 'type': 'one_api_error'}}
generating response:  20%|█▉        | 43/218 [10:47<51:39, 17.71s/it]exception encountered with query43
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408405196757412459164515)', 'type': 'one_api_error'}}
generating response:  20%|██        | 44/218 [11:07<53:00, 18.28s/it]exception encountered with query45
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408411323863637301309054)', 'type': 'one_api_error'}}
generating response:  21%|██        | 46/218 [11:28<42:57, 14.99s/it]exception encountered with query46
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408413483434739321316415)', 'type': 'one_api_error'}}
generating response:  22%|██▏       | 47/218 [11:50<47:08, 16.54s/it]exception encountered with query47
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060408415679725677005186738)', 'type': 'one_api_error'}}
generating response:  22%|██▏       | 48/218 [12:12<50:44, 17.91s/it]generating response:  22%|██▏       | 49/218 [12:37<55:59, 19.88s/it]generating response:  23%|██▎       | 50/218 [12:45<46:33, 16.63s/it]generating response:  23%|██▎       | 51/218 [12:52<38:22, 13.79s/it]generating response:  24%|██▍       | 52/218 [13:00<33:58, 12.28s/it]generating response:  24%|██▍       | 53/218 [13:07<29:12, 10.62s/it]generating response:  25%|██▍       | 54/218 [13:14<25:50,  9.45s/it]generating response:  25%|██▌       | 55/218 [13:31<32:19, 11.90s/it]generating response:  26%|██▌       | 57/218 [13:47<26:42,  9.95s/it]generating response:  27%|██▋       | 58/218 [13:52<23:16,  8.73s/it]generating response:  27%|██▋       | 59/218 [13:56<20:09,  7.61s/it]generating response:  28%|██▊       | 60/218 [14:01<18:08,  6.89s/it]generating response:  28%|██▊       | 62/218 [14:07<13:27,  5.17s/it]generating response:  30%|██▉       | 65/218 [14:12<09:07,  3.58s/it]generating response:  30%|███       | 66/218 [14:24<12:58,  5.12s/it]generating response:  31%|███       | 67/218 [14:29<12:46,  5.08s/it]generating response:  31%|███       | 68/218 [14:34<12:47,  5.11s/it]generating response:  32%|███▏      | 69/218 [14:40<13:02,  5.25s/it]generating response:  32%|███▏      | 70/218 [14:48<14:38,  5.94s/it]generating response:  33%|███▎      | 71/218 [14:52<13:27,  5.49s/it]generating response:  33%|███▎      | 72/218 [15:01<15:41,  6.45s/it]generating response:  34%|███▍      | 74/218 [15:08<12:08,  5.06s/it]generating response:  34%|███▍      | 75/218 [15:12<11:42,  4.91s/it]generating response:  35%|███▍      | 76/218 [15:17<11:48,  4.99s/it]generating response:  35%|███▌      | 77/218 [15:21<11:03,  4.71s/it]generating response:  36%|███▌      | 78/218 [15:28<12:13,  5.24s/it]generating response:  36%|███▌      | 79/218 [15:35<13:25,  5.79s/it]generating response:  37%|███▋      | 81/218 [15:39<09:28,  4.15s/it]generating response:  38%|███▊      | 83/218 [15:46<08:26,  3.75s/it]generating response:  39%|███▊      | 84/218 [15:51<09:18,  4.17s/it]generating response:  39%|███▉      | 86/218 [15:56<07:26,  3.38s/it]generating response:  40%|████      | 88/218 [16:34<19:34,  9.03s/it]generating response:  41%|████▏     | 90/218 [16:38<13:57,  6.54s/it]generating response:  42%|████▏     | 91/218 [16:43<13:29,  6.38s/it]generating response:  42%|████▏     | 92/218 [16:57<16:41,  7.95s/it]generating response:  43%|████▎     | 93/218 [17:21<24:24, 11.72s/it]generating response:  43%|████▎     | 94/218 [17:30<22:53, 11.08s/it]generating response:  44%|████▍     | 96/218 [17:34<14:41,  7.23s/it]generating response:  44%|████▍     | 97/218 [17:41<14:23,  7.13s/it]generating response:  45%|████▍     | 98/218 [17:52<16:13,  8.11s/it]generating response:  45%|████▌     | 99/218 [17:56<14:03,  7.09s/it]generating response:  46%|████▌     | 100/218 [18:01<13:03,  6.64s/it]generating response:  46%|████▋     | 101/218 [18:20<19:26,  9.97s/it]generating response:  47%|████▋     | 103/218 [18:30<14:48,  7.72s/it]generating response:  48%|████▊     | 104/218 [18:39<15:36,  8.22s/it]generating response:  48%|████▊     | 105/218 [18:49<16:12,  8.60s/it]generating response:  49%|████▊     | 106/218 [18:55<14:50,  7.95s/it]generating response:  50%|████▉     | 108/218 [19:06<12:42,  6.93s/it]exception encountered with query110
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 2024060408491082290014234096589)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  51%|█████     | 111/218 [19:30<13:15,  7.43s/it]generating response:  53%|█████▎    | 115/218 [19:43<09:20,  5.44s/it]generating response:  55%|█████▍    | 119/218 [19:55<07:14,  4.39s/it]generating response:  55%|█████▌    | 120/218 [19:59<07:06,  4.36s/it]generating response:  56%|█████▌    | 121/218 [20:06<07:35,  4.69s/it]generating response:  56%|█████▌    | 122/218 [20:19<10:02,  6.28s/it]generating response:  56%|█████▋    | 123/218 [20:27<10:35,  6.69s/it]generating response:  57%|█████▋    | 125/218 [20:32<07:48,  5.03s/it]generating response:  58%|█████▊    | 127/218 [20:38<06:34,  4.33s/it]generating response:  59%|█████▊    | 128/218 [20:48<08:12,  5.47s/it]generating response:  60%|█████▉    | 130/218 [21:06<09:48,  6.68s/it]generating response:  60%|██████    | 131/218 [21:14<10:19,  7.12s/it]generating response:  61%|██████    | 132/218 [21:28<12:15,  8.55s/it]generating response:  61%|██████    | 133/218 [21:37<12:18,  8.69s/it]generating response:  62%|██████▏   | 135/218 [21:54<12:03,  8.72s/it]generating response:  62%|██████▏   | 136/218 [22:01<11:08,  8.16s/it]generating response:  68%|██████▊   | 149/218 [22:08<02:19,  2.02s/it]generating response:  69%|██████▉   | 150/218 [22:24<03:33,  3.14s/it]generating response:  69%|██████▉   | 151/218 [22:31<04:01,  3.60s/it]generating response:  70%|███████   | 153/218 [22:42<04:22,  4.04s/it]generating response:  71%|███████   | 154/218 [22:49<04:40,  4.39s/it]generating response:  72%|███████▏  | 156/218 [22:55<04:12,  4.06s/it]generating response:  72%|███████▏  | 157/218 [23:07<05:29,  5.40s/it]generating response:  73%|███████▎  | 159/218 [23:22<05:58,  6.07s/it]generating response:  74%|███████▍  | 162/218 [23:39<05:32,  5.93s/it]generating response:  76%|███████▌  | 166/218 [24:26<07:19,  8.45s/it]generating response:  77%|███████▋  | 167/218 [24:49<08:48, 10.36s/it]generating response:  80%|████████  | 175/218 [24:55<03:16,  4.57s/it]generating response:  83%|████████▎ | 180/218 [25:03<02:14,  3.53s/it]generating response:  83%|████████▎ | 182/218 [25:21<02:40,  4.45s/it]exception encountered with query182
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 2024060408553319497035490208714)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  84%|████████▍ | 183/218 [25:50<04:07,  7.06s/it]generating response:  86%|████████▌ | 188/218 [26:06<02:39,  5.32s/it]generating response:  87%|████████▋ | 189/218 [26:17<02:54,  6.02s/it]generating response:  87%|████████▋ | 190/218 [26:29<03:09,  6.77s/it]generating response:  88%|████████▊ | 191/218 [26:44<03:40,  8.17s/it]generating response:  88%|████████▊ | 192/218 [26:58<04:00,  9.23s/it]generating response:  89%|████████▊ | 193/218 [27:08<03:57,  9.49s/it]generating response:  89%|████████▉ | 194/218 [27:28<04:42, 11.79s/it]generating response:  89%|████████▉ | 195/218 [27:52<05:45, 15.02s/it]generating response:  90%|████████▉ | 196/218 [28:05<05:14, 14.30s/it]generating response:  90%|█████████ | 197/218 [28:16<04:45, 13.58s/it]generating response:  91%|█████████ | 198/218 [28:27<04:14, 12.72s/it]generating response:  93%|█████████▎| 202/218 [28:36<01:41,  6.32s/it]generating response:  93%|█████████▎| 203/218 [28:51<01:57,  7.80s/it]generating response:  94%|█████████▎| 204/218 [29:10<02:21, 10.12s/it]generating response:  95%|█████████▍| 207/218 [29:57<02:20, 12.77s/it]generating response:  95%|█████████▌| 208/218 [30:06<02:00, 12.03s/it]generating response:  96%|█████████▌| 209/218 [30:33<02:16, 15.12s/it]generating response:  96%|█████████▋| 210/218 [30:50<02:03, 15.50s/it]generating response:  97%|█████████▋| 211/218 [31:20<02:13, 19.03s/it]generating response:  97%|█████████▋| 212/218 [31:34<01:46, 17.76s/it]generating response:  98%|█████████▊| 213/218 [31:48<01:24, 16.83s/it]generating response:  99%|█████████▊| 215/218 [32:12<00:44, 14.71s/it]generating response:  99%|█████████▉| 216/218 [32:31<00:31, 15.78s/it]generating response: 100%|█████████▉| 217/218 [32:57<00:18, 18.19s/it]generating response: 100%|██████████| 218/218 [33:10<00:00, 16.98s/it]generating response: 100%|██████████| 218/218 [33:10<00:00,  9.13s/it]
generation part takes 1990.70s
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:25<01:40, 25.11s/it]denoise batch:  40%|████      | 2/5 [00:49<01:14, 24.90s/it]denoise batch:  60%|██████    | 3/5 [01:14<00:49, 24.87s/it]denoise batch:  80%|████████  | 4/5 [01:39<00:24, 24.88s/it]denoise batch: 100%|██████████| 5/5 [01:48<00:00, 19.10s/it]denoise batch: 100%|██████████| 5/5 [01:48<00:00, 21.69s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.58it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.79it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.35it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.01it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 2425.25s
using gpt4 for generation
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:27<1:41:14, 27.99s/it]generating response:   1%|          | 2/218 [00:35<58:17, 16.19s/it]  generating response:   1%|▏         | 3/218 [00:44<45:49, 12.79s/it]generating response:   2%|▏         | 4/218 [00:50<35:15,  9.88s/it]generating response:   2%|▏         | 5/218 [00:54<27:55,  7.87s/it]generating response:   3%|▎         | 6/218 [01:02<27:43,  7.85s/it]generating response:   3%|▎         | 7/218 [01:53<1:17:52, 22.14s/it]generating response:   4%|▎         | 8/218 [03:04<2:12:06, 37.74s/it]generating response:   4%|▍         | 9/218 [03:15<1:41:53, 29.25s/it]generating response:   6%|▋         | 14/218 [03:22<34:02, 10.01s/it] generating response:   7%|▋         | 15/218 [03:33<34:33, 10.21s/it]generating response:   7%|▋         | 16/218 [03:41<32:54,  9.78s/it]generating response:   8%|▊         | 17/218 [03:51<32:36,  9.74s/it]generating response:   8%|▊         | 18/218 [04:12<41:49, 12.55s/it]generating response:   9%|▊         | 19/218 [04:18<35:49, 10.80s/it]generating response:   9%|▉         | 20/218 [04:25<32:00,  9.70s/it]generating response:  10%|█         | 22/218 [04:36<26:12,  8.02s/it]generating response:  11%|█         | 24/218 [14:18<6:13:46, 115.60s/it]generating response:  11%|█▏        | 25/218 [14:25<4:57:30, 92.49s/it] generating response:  12%|█▏        | 27/218 [14:33<3:07:09, 58.79s/it]generating response:  13%|█▎        | 28/218 [14:52<2:39:38, 50.41s/it]generating response:  14%|█▍        | 31/218 [15:07<1:29:42, 28.78s/it]generating response:  15%|█▍        | 32/218 [15:24<1:22:25, 26.59s/it]generating response:  15%|█▌        | 33/218 [15:33<1:10:23, 22.83s/it]generating response:  16%|█▌        | 35/218 [15:39<46:46, 15.34s/it]  generating response:  17%|█▋        | 37/218 [15:48<35:01, 11.61s/it]generating response:  18%|█▊        | 39/218 [15:51<24:39,  8.27s/it]generating response:  18%|█▊        | 40/218 [16:03<26:30,  8.93s/it]generating response:  19%|█▉        | 41/218 [16:06<23:07,  7.84s/it]generating response:  19%|█▉        | 42/218 [16:13<22:00,  7.50s/it]generating response:  20%|█▉        | 43/218 [16:20<21:36,  7.41s/it]generating response:  20%|██        | 44/218 [16:23<18:17,  6.31s/it]generating response:  22%|██▏       | 47/218 [16:54<24:09,  8.48s/it]generating response:  22%|██▏       | 48/218 [17:05<25:08,  8.87s/it]generating response:  22%|██▏       | 49/218 [17:12<24:10,  8.58s/it]generating response:  23%|██▎       | 50/218 [17:20<23:15,  8.31s/it]generating response:  23%|██▎       | 51/218 [17:31<25:11,  9.05s/it]generating response:  24%|██▍       | 52/218 [17:36<22:11,  8.02s/it]generating response:  24%|██▍       | 53/218 [17:42<20:04,  7.30s/it]generating response:  25%|██▍       | 54/218 [17:48<19:14,  7.04s/it]generating response:  25%|██▌       | 55/218 [17:55<18:54,  6.96s/it]generating response:  26%|██▌       | 56/218 [18:01<17:56,  6.64s/it]generating response:  26%|██▌       | 57/218 [18:22<29:26, 10.97s/it]generating response:  27%|██▋       | 58/218 [18:27<24:07,  9.05s/it]generating response:  27%|██▋       | 59/218 [18:31<20:21,  7.68s/it]generating response:  28%|██▊       | 60/218 [18:36<17:49,  6.77s/it]generating response:  28%|██▊       | 61/218 [18:56<28:16, 10.81s/it]generating response:  30%|██▉       | 65/218 [19:02<12:41,  4.98s/it]generating response:  30%|███       | 66/218 [19:39<27:20, 10.79s/it]generating response:  31%|███       | 67/218 [19:44<24:11,  9.61s/it]generating response:  31%|███       | 68/218 [19:49<21:42,  8.68s/it]generating response:  32%|███▏      | 69/218 [19:54<18:48,  7.57s/it]generating response:  32%|███▏      | 70/218 [20:03<20:00,  8.11s/it]generating response:  33%|███▎      | 71/218 [23:05<2:15:05, 55.14s/it]generating response:  33%|███▎      | 72/218 [28:25<5:14:18, 129.17s/it]generating response:  34%|███▍      | 74/218 [28:33<2:56:43, 73.63s/it] generating response:  34%|███▍      | 75/218 [28:38<2:16:16, 57.18s/it]generating response:  35%|███▍      | 76/218 [28:44<1:44:10, 44.02s/it]generating response:  35%|███▌      | 77/218 [28:48<1:17:55, 33.16s/it]generating response:  36%|███▌      | 78/218 [28:57<1:01:59, 26.57s/it]generating response:  36%|███▌      | 79/218 [29:06<50:21, 21.74s/it]  generating response:  37%|███▋      | 81/218 [29:13<30:34, 13.39s/it]generating response:  38%|███▊      | 83/218 [29:20<21:33,  9.58s/it]generating response:  39%|███▊      | 84/218 [29:28<20:51,  9.34s/it]generating response:  39%|███▉      | 86/218 [29:33<14:26,  6.57s/it]generating response:  40%|████      | 88/218 [29:43<13:15,  6.12s/it]generating response:  41%|████▏     | 90/218 [29:47<09:57,  4.67s/it]generating response:  42%|████▏     | 91/218 [29:53<10:36,  5.01s/it]generating response:  42%|████▏     | 92/218 [30:05<13:26,  6.40s/it]generating response:  43%|████▎     | 93/218 [30:12<14:02,  6.74s/it]generating response:  43%|████▎     | 94/218 [30:30<19:32,  9.45s/it]generating response:  44%|████▎     | 95/218 [30:36<17:21,  8.47s/it]generating response:  44%|████▍     | 96/218 [30:40<15:04,  7.41s/it]generating response:  44%|████▍     | 97/218 [30:46<14:04,  6.98s/it]generating response:  45%|████▍     | 98/218 [31:01<18:22,  9.19s/it]generating response:  45%|████▌     | 99/218 [31:04<14:42,  7.42s/it]generating response:  46%|████▌     | 100/218 [31:08<12:52,  6.55s/it]generating response:  46%|████▋     | 101/218 [31:32<22:43, 11.65s/it]generating response:  47%|████▋     | 103/218 [31:40<15:23,  8.03s/it]generating response:  48%|████▊     | 104/218 [32:13<27:01, 14.22s/it]generating response:  48%|████▊     | 105/218 [32:53<39:20, 20.89s/it]generating response:  49%|████▊     | 106/218 [32:58<31:02, 16.63s/it]generating response:  50%|████▉     | 108/218 [33:15<24:05, 13.14s/it]exception encountered with query110
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 2024060409400514907530770784833)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  51%|█████     | 111/218 [33:36<18:12, 10.21s/it]generating response:  53%|█████▎    | 115/218 [33:47<11:18,  6.58s/it]generating response:  55%|█████▍    | 119/218 [33:59<08:32,  5.18s/it]generating response:  55%|█████▌    | 120/218 [34:03<08:05,  4.95s/it]generating response:  56%|█████▌    | 121/218 [34:09<08:19,  5.15s/it]generating response:  56%|█████▋    | 123/218 [43:55<2:26:57, 92.82s/it]generating response:  58%|█████▊    | 127/218 [44:03<1:16:39, 50.54s/it]generating response:  59%|█████▊    | 128/218 [44:11<1:06:45, 44.51s/it]generating response:  60%|█████▉    | 130/218 [44:18<47:53, 32.65s/it]  generating response:  60%|██████    | 131/218 [44:27<41:19, 28.50s/it]generating response:  61%|██████    | 132/218 [44:34<34:56, 24.37s/it]generating response:  61%|██████    | 133/218 [44:49<31:30, 22.24s/it]generating response:  62%|██████▏   | 135/218 [44:54<20:21, 14.72s/it]generating response:  62%|██████▏   | 136/218 [45:00<17:29, 12.80s/it]generating response:  68%|██████▊   | 149/218 [45:10<03:39,  3.19s/it]generating response:  69%|██████▉   | 150/218 [45:32<05:18,  4.68s/it]generating response:  69%|██████▉   | 151/218 [45:47<06:25,  5.75s/it]generating response:  71%|███████   | 154/218 [45:55<05:10,  4.85s/it]generating response:  72%|███████▏  | 156/218 [46:02<04:40,  4.53s/it]generating response:  72%|███████▏  | 157/218 [46:07<04:38,  4.56s/it]generating response:  73%|███████▎  | 159/218 [47:03<11:00, 11.20s/it]generating response:  74%|███████▍  | 162/218 [47:17<08:09,  8.75s/it]generating response:  76%|███████▌  | 166/218 [47:37<06:15,  7.21s/it]generating response:  77%|███████▋  | 167/218 [48:03<08:09,  9.59s/it]generating response:  79%|███████▉  | 172/218 [48:13<04:33,  5.95s/it]generating response:  80%|████████  | 175/218 [48:25<03:53,  5.43s/it]generating response:  83%|████████▎ | 180/218 [48:34<02:27,  3.89s/it]generating response:  83%|████████▎ | 182/218 [48:53<02:58,  4.96s/it]generating response:  86%|████████▌ | 188/218 [49:03<01:45,  3.51s/it]generating response:  87%|████████▋ | 189/218 [49:21<02:21,  4.88s/it]generating response:  87%|████████▋ | 190/218 [49:33<02:41,  5.77s/it]generating response:  88%|████████▊ | 191/218 [49:43<02:51,  6.34s/it]generating response:  88%|████████▊ | 192/218 [49:58<03:23,  7.83s/it]generating response:  89%|████████▊ | 193/218 [50:10<03:40,  8.81s/it]generating response:  89%|████████▉ | 194/218 [50:20<03:34,  8.94s/it]generating response:  89%|████████▉ | 195/218 [50:36<04:04, 10.62s/it]generating response:  90%|████████▉ | 196/218 [50:51<04:18, 11.74s/it]generating response:  90%|█████████ | 197/218 [51:08<04:37, 13.22s/it]generating response:  91%|█████████ | 198/218 [51:25<04:45, 14.27s/it]generating response:  93%|█████████▎| 202/218 [51:37<01:57,  7.37s/it]generating response:  94%|█████████▎| 204/218 [51:59<01:58,  8.47s/it]generating response:  95%|█████████▍| 207/218 [52:09<01:10,  6.39s/it]generating response:  95%|█████████▌| 208/218 [52:16<01:05,  6.50s/it]generating response:  96%|█████████▌| 209/218 [53:13<02:22, 15.83s/it]generating response:  96%|█████████▋| 210/218 [53:29<02:08, 16.01s/it]generating response:  97%|█████████▋| 211/218 [53:43<01:48, 15.54s/it]generating response:  97%|█████████▋| 212/218 [54:25<02:11, 21.95s/it]generating response:  98%|█████████▊| 213/218 [54:36<01:35, 19.09s/it]generating response:  99%|█████████▊| 215/218 [55:07<00:52, 17.55s/it]generating response:  99%|█████████▉| 216/218 [55:35<00:40, 20.11s/it]generating response: 100%|█████████▉| 217/218 [55:57<00:20, 20.59s/it]generating response: 100%|██████████| 218/218 [56:10<00:00, 18.51s/it]generating response: 100%|██████████| 218/218 [56:10<00:00, 15.46s/it]
generation part takes 3370.64s
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:25<01:40, 25.10s/it]denoise batch:  40%|████      | 2/5 [00:49<01:14, 24.92s/it]denoise batch:  60%|██████    | 3/5 [01:14<00:49, 24.88s/it]denoise batch:  80%|████████  | 4/5 [01:39<00:24, 24.86s/it]denoise batch: 100%|██████████| 5/5 [01:48<00:00, 19.08s/it]denoise batch: 100%|██████████| 5/5 [01:48<00:00, 21.68s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.50it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.67it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.22it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.89it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 6012.78s
using gpt4 for generation
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [02:39<9:35:35, 159.15s/it]generating response:   1%|          | 2/218 [02:59<4:40:00, 77.78s/it] generating response:   1%|▏         | 3/218 [03:42<3:41:45, 61.89s/it]exception encountered with query3
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060410101576496238387557894)', 'type': '', 'param': '', 'code': '401'}}
generating response:   2%|▏         | 4/218 [03:57<2:34:26, 43.30s/it]exception encountered with query4
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041010318643873328919001)', 'type': 'one_api_error'}}
generating response:   2%|▏         | 5/218 [04:11<1:56:25, 32.80s/it]exception encountered with query5
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041010518552911981265524)', 'type': 'one_api_error'}}
generating response:   3%|▎         | 6/218 [04:31<1:40:30, 28.44s/it]exception encountered with query6
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410111088076597398769311)', 'type': 'one_api_error'}}
generating response:   3%|▎         | 7/218 [04:51<1:30:05, 25.62s/it]exception encountered with query7
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410113174122984757884562)', 'type': 'one_api_error'}}
generating response:   4%|▎         | 8/218 [05:12<1:24:22, 24.11s/it]exception encountered with query8
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410115351515216589651539)', 'type': 'one_api_error'}}
generating response:   4%|▍         | 9/218 [05:34<1:21:27, 23.38s/it]exception encountered with query13
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410121423672670650443618)', 'type': 'one_api_error'}}
generating response:   6%|▋         | 14/218 [05:55<34:18, 10.09s/it] exception encountered with query14
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410123518729830919030931)', 'type': 'one_api_error'}}
generating response:   7%|▋         | 15/218 [06:16<40:12, 11.88s/it]exception encountered with query15
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410125590079493882207789)', 'type': 'one_api_error'}}
generating response:   7%|▋         | 16/218 [06:36<45:40, 13.57s/it]exception encountered with query16
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410131787455476186856700)', 'type': 'one_api_error'}}
generating response:   8%|▊         | 17/218 [06:58<51:28, 15.37s/it]exception encountered with query17
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041013403736645761131746)', 'type': 'one_api_error'}}
generating response:   8%|▊         | 18/218 [07:20<56:31, 16.96s/it]exception encountered with query18
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410140233169095960351674)', 'type': 'one_api_error'}}
generating response:   9%|▊         | 19/218 [07:43<1:00:41, 18.30s/it]exception encountered with query19
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410143037730686301219855)', 'type': 'one_api_error'}}
generating response:   9%|▉         | 20/218 [08:11<1:08:51, 20.87s/it]exception encountered with query23
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410145437780656568582712)', 'type': 'one_api_error'}}
generating response:  11%|█         | 24/218 [08:35<38:36, 11.94s/it]  exception encountered with query24
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410151754117155731699311)', 'type': 'one_api_error'}}
generating response:  11%|█▏        | 25/218 [08:58<44:45, 13.92s/it]exception encountered with query27
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410153913251067061232318)', 'type': 'one_api_error'}}
generating response:  13%|█▎        | 28/218 [09:19<34:53, 11.02s/it]exception encountered with query30
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410160158848726294836563)', 'type': 'one_api_error'}}
generating response:  14%|█▍        | 31/218 [09:42<30:09,  9.68s/it]exception encountered with query31
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410162245408854557217721)', 'type': 'one_api_error'}}
generating response:  15%|█▍        | 32/218 [10:03<35:17, 11.39s/it]exception encountered with query32
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410164398033739183138779)', 'type': 'one_api_error'}}
generating response:  15%|█▌        | 33/218 [10:24<40:44, 13.22s/it]exception encountered with query34
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410170634279648741484047)', 'type': 'one_api_error'}}
generating response:  16%|█▌        | 35/218 [10:47<38:10, 12.52s/it]exception encountered with query36
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410172846918746759838170)', 'type': 'one_api_error'}}
generating response:  17%|█▋        | 37/218 [11:09<36:21, 12.05s/it]exception encountered with query38
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041017498294298820982081)', 'type': 'one_api_error'}}
generating response:  18%|█▊        | 39/218 [11:29<34:16, 11.49s/it]exception encountered with query39
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410181317519777826989695)', 'type': 'one_api_error'}}
generating response:  18%|█▊        | 40/218 [11:54<41:02, 13.84s/it]exception encountered with query40
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410183444855218064570589)', 'type': 'one_api_error'}}
generating response:  19%|█▉        | 41/218 [12:15<45:22, 15.38s/it]exception encountered with query41
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410185587430517547486661)', 'type': 'one_api_error'}}
generating response:  19%|█▉        | 42/218 [12:36<49:12, 16.78s/it]exception encountered with query42
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410191581742665895603983)', 'type': 'one_api_error'}}
generating response:  20%|█▉        | 43/218 [12:56<51:11, 17.55s/it]exception encountered with query43
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041019361674128062397477)', 'type': 'one_api_error'}}
generating response:  20%|██        | 44/218 [13:16<52:53, 18.24s/it]exception encountered with query45
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410195980114212137467570)', 'type': 'one_api_error'}}
generating response:  21%|██        | 46/218 [13:40<44:32, 15.54s/it]exception encountered with query46
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410202273087908610967255)', 'type': 'one_api_error'}}
generating response:  22%|██▏       | 47/218 [14:03<49:12, 17.26s/it]exception encountered with query47
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410204416579912684627427)', 'type': 'one_api_error'}}
generating response:  22%|██▏       | 48/218 [14:25<51:52, 18.31s/it]exception encountered with query49
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410210610058274082688823)', 'type': 'one_api_error'}}
generating response:  23%|██▎       | 50/218 [14:46<42:42, 15.25s/it]exception encountered with query50
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410212631230734313248981)', 'type': 'one_api_error'}}
generating response:  23%|██▎       | 51/218 [15:07<45:35, 16.38s/it]exception encountered with query51
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410214670223471165789397)', 'type': 'one_api_error'}}
generating response:  24%|██▍       | 52/218 [15:27<48:03, 17.37s/it]exception encountered with query52
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410220730381347161460211)', 'type': 'one_api_error'}}
generating response:  24%|██▍       | 53/218 [15:48<50:05, 18.22s/it]exception encountered with query53
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410222843272888511377260)', 'type': 'one_api_error'}}
generating response:  25%|██▍       | 54/218 [16:09<51:56, 19.00s/it]exception encountered with query54
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410224826765530396747932)', 'type': 'one_api_error'}}
generating response:  25%|██▌       | 55/218 [16:29<52:14, 19.23s/it]exception encountered with query55
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410230824796963693746338)', 'type': 'one_api_error'}}
generating response:  26%|██▌       | 56/218 [16:49<52:30, 19.45s/it]exception encountered with query56
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410232966252981915086843)', 'type': 'one_api_error'}}
generating response:  26%|██▌       | 57/218 [17:10<53:43, 20.02s/it]exception encountered with query57
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410235060476479497782408)', 'type': 'one_api_error'}}
generating response:  27%|██▋       | 58/218 [17:31<54:06, 20.29s/it]exception encountered with query58
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410241168428952177551861)', 'type': 'one_api_error'}}
generating response:  27%|██▋       | 59/218 [17:52<54:23, 20.53s/it]exception encountered with query59
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410243348567498923648063)', 'type': 'one_api_error'}}
generating response:  28%|██▊       | 60/218 [18:14<55:03, 20.91s/it]exception encountered with query61
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410245415357116838730498)', 'type': 'one_api_error'}}
generating response:  28%|██▊       | 62/218 [18:35<41:44, 16.06s/it]exception encountered with query64
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060410251598653204216433601)', 'type': 'one_api_error'}}
generating response:  30%|██▉       | 65/218 [18:56<29:52, 11.71s/it]generating response:  30%|███       | 66/218 [19:16<33:19, 13.15s/it]generating response:  31%|███       | 67/218 [19:22<29:14, 11.62s/it]generating response:  31%|███       | 68/218 [19:27<25:14, 10.10s/it]generating response:  32%|███▏      | 69/218 [19:32<22:18,  8.98s/it]generating response:  32%|███▏      | 70/218 [19:40<21:20,  8.65s/it]generating response:  33%|███▎      | 71/218 [19:46<19:05,  7.79s/it]generating response:  33%|███▎      | 72/218 [19:51<17:27,  7.17s/it]generating response:  34%|███▍      | 74/218 [19:59<13:35,  5.66s/it]generating response:  34%|███▍      | 75/218 [20:08<15:29,  6.50s/it]generating response:  35%|███▍      | 76/218 [20:13<14:24,  6.09s/it]generating response:  35%|███▌      | 77/218 [20:20<14:48,  6.30s/it]generating response:  36%|███▌      | 79/218 [20:27<11:49,  5.11s/it]generating response:  37%|███▋      | 81/218 [20:32<09:33,  4.19s/it]generating response:  38%|███▊      | 83/218 [21:06<19:20,  8.60s/it]generating response:  39%|███▊      | 84/218 [21:12<18:25,  8.25s/it]generating response:  39%|███▉      | 86/218 [21:19<14:00,  6.36s/it]generating response:  40%|████      | 88/218 [21:32<13:57,  6.44s/it]generating response:  41%|████▏     | 90/218 [21:37<11:07,  5.21s/it]generating response:  42%|████▏     | 91/218 [21:43<11:06,  5.25s/it]generating response:  42%|████▏     | 92/218 [21:53<13:20,  6.35s/it]generating response:  43%|████▎     | 93/218 [22:01<13:59,  6.72s/it]generating response:  43%|████▎     | 94/218 [22:07<13:26,  6.50s/it]generating response:  44%|████▎     | 95/218 [22:15<14:01,  6.84s/it]generating response:  44%|████▍     | 96/218 [22:19<12:31,  6.16s/it]generating response:  44%|████▍     | 97/218 [22:25<12:20,  6.12s/it]generating response:  45%|████▍     | 98/218 [22:35<14:29,  7.25s/it]generating response:  45%|████▌     | 99/218 [22:40<13:07,  6.61s/it]generating response:  46%|████▋     | 101/218 [22:54<13:13,  6.78s/it]generating response:  47%|████▋     | 103/218 [23:05<12:04,  6.30s/it]generating response:  48%|████▊     | 104/218 [23:13<12:38,  6.66s/it]generating response:  48%|████▊     | 105/218 [23:22<13:43,  7.29s/it]generating response:  49%|████▊     | 106/218 [23:32<14:43,  7.89s/it]generating response:  50%|████▉     | 108/218 [24:04<20:44, 11.31s/it]exception encountered with query110
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 2024060410304141099137066967369)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  51%|█████     | 111/218 [24:24<16:18,  9.14s/it]generating response:  53%|█████▎    | 115/218 [24:33<09:58,  5.81s/it]generating response:  55%|█████▍    | 119/218 [24:41<07:06,  4.31s/it]generating response:  55%|█████▌    | 120/218 [24:44<06:46,  4.15s/it]generating response:  56%|█████▌    | 121/218 [24:51<07:23,  4.57s/it]generating response:  56%|█████▌    | 122/218 [24:56<07:20,  4.59s/it]generating response:  56%|█████▋    | 123/218 [25:03<08:12,  5.18s/it]generating response:  58%|█████▊    | 127/218 [25:13<05:33,  3.67s/it]generating response:  59%|█████▊    | 128/218 [25:22<06:50,  4.56s/it]generating response:  60%|█████▉    | 130/218 [25:31<06:42,  4.57s/it]generating response:  60%|██████    | 131/218 [25:40<07:51,  5.42s/it]generating response:  61%|██████    | 132/218 [26:01<12:22,  8.63s/it]generating response:  61%|██████    | 133/218 [26:10<12:23,  8.75s/it]generating response:  62%|██████▏   | 135/218 [26:22<10:33,  7.63s/it]generating response:  62%|██████▏   | 136/218 [26:27<09:43,  7.11s/it]generating response:  63%|██████▎   | 137/218 [26:34<09:21,  6.93s/it]generating response:  68%|██████▊   | 149/218 [26:44<02:19,  2.03s/it]generating response:  69%|██████▉   | 150/218 [27:01<03:47,  3.35s/it]generating response:  69%|██████▉   | 151/218 [27:09<04:22,  3.92s/it]generating response:  70%|███████   | 153/218 [27:21<04:44,  4.38s/it]generating response:  71%|███████   | 154/218 [27:30<05:20,  5.01s/it]generating response:  72%|███████▏  | 156/218 [27:40<05:10,  5.01s/it]generating response:  72%|███████▏  | 157/218 [27:44<04:59,  4.91s/it]generating response:  73%|███████▎  | 159/218 [28:03<06:16,  6.39s/it]generating response:  74%|███████▍  | 162/218 [28:30<06:57,  7.46s/it]generating response:  76%|███████▌  | 166/218 [29:37<10:00, 11.55s/it]generating response:  77%|███████▋  | 167/218 [29:57<10:51, 12.77s/it]generating response:  79%|███████▉  | 172/218 [30:20<06:39,  8.68s/it]generating response:  80%|███████▉  | 174/218 [30:41<06:43,  9.18s/it]generating response:  80%|████████  | 175/218 [30:54<06:53,  9.62s/it]generating response:  83%|████████▎ | 180/218 [31:05<03:48,  6.01s/it]generating response:  87%|████████▋ | 190/218 [31:20<01:34,  3.36s/it]generating response:  88%|████████▊ | 191/218 [31:29<01:42,  3.80s/it]generating response:  88%|████████▊ | 192/218 [31:51<02:25,  5.59s/it]generating response:  89%|████████▊ | 193/218 [32:04<02:42,  6.51s/it]generating response:  89%|████████▉ | 194/218 [32:17<02:59,  7.47s/it]generating response:  89%|████████▉ | 195/218 [32:30<03:14,  8.45s/it]generating response:  90%|████████▉ | 196/218 [32:51<04:03, 11.06s/it]generating response:  90%|█████████ | 197/218 [33:09<04:21, 12.44s/it]generating response:  91%|█████████ | 198/218 [33:32<05:01, 15.07s/it]generating response:  93%|█████████▎| 202/218 [33:40<01:59,  7.45s/it]generating response:  93%|█████████▎| 203/218 [33:53<02:06,  8.47s/it]generating response:  94%|█████████▎| 204/218 [34:05<02:08,  9.16s/it]generating response:  95%|█████████▍| 207/218 [34:23<01:24,  7.70s/it]generating response:  95%|█████████▌| 208/218 [34:30<01:15,  7.59s/it]generating response:  96%|█████████▌| 209/218 [34:55<01:40, 11.14s/it]generating response:  96%|█████████▋| 210/218 [35:10<01:35, 11.92s/it]generating response:  97%|█████████▋| 211/218 [35:23<01:25, 12.23s/it]generating response:  97%|█████████▋| 212/218 [35:35<01:12, 12.11s/it]generating response:  98%|█████████▊| 213/218 [35:48<01:01, 12.37s/it]generating response:  99%|█████████▊| 215/218 [36:06<00:32, 10.91s/it]generating response: 100%|█████████▉| 217/218 [36:23<00:09,  9.98s/it]generating response: 100%|██████████| 218/218 [37:22<00:00, 20.53s/it]generating response: 100%|██████████| 218/218 [37:22<00:00, 10.29s/it]
generation part takes 2242.24s
Full generation completed in 8255.07s
query number: 218
-------gpt4 with defence generation complete-------
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processed 218 images, 218 texts in 0.07s
using gpt4 for generation
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [01:13<4:26:07, 73.58s/it]generating response:   1%|          | 2/218 [01:27<2:18:44, 38.54s/it]generating response:   1%|▏         | 3/218 [02:01<2:10:43, 36.48s/it]generating response:   2%|▏         | 4/218 [02:09<1:29:33, 25.11s/it]generating response:   2%|▏         | 5/218 [02:13<1:01:48, 17.41s/it]generating response:   3%|▎         | 6/218 [02:39<1:11:52, 20.34s/it]generating response:   3%|▎         | 7/218 [02:46<56:43, 16.13s/it]  generating response:   4%|▎         | 8/218 [03:07<1:02:04, 17.74s/it]generating response:   4%|▍         | 9/218 [03:18<54:02, 15.51s/it]  generating response:   5%|▍         | 10/218 [03:38<58:57, 17.01s/it]generating response:   5%|▌         | 11/218 [03:42<44:46, 12.98s/it]generating response:   6%|▌         | 12/218 [03:48<37:27, 10.91s/it]generating response:   6%|▌         | 13/218 [03:55<32:53,  9.63s/it]generating response:   6%|▋         | 14/218 [04:15<43:46, 12.88s/it]generating response:   7%|▋         | 15/218 [04:35<50:12, 14.84s/it]generating response:   7%|▋         | 16/218 [04:40<40:49, 12.13s/it]generating response:   8%|▊         | 17/218 [04:48<36:20, 10.85s/it]generating response:   8%|▊         | 18/218 [04:53<30:03,  9.02s/it]generating response:   9%|▊         | 19/218 [04:59<26:19,  7.94s/it]generating response:   9%|▉         | 20/218 [05:06<25:21,  7.68s/it]generating response:  10%|▉         | 21/218 [05:14<26:03,  7.94s/it]generating response:  10%|█         | 22/218 [05:24<28:01,  8.58s/it]generating response:  11%|█         | 23/218 [05:34<29:28,  9.07s/it]generating response:  11%|█         | 24/218 [05:42<27:26,  8.49s/it]generating response:  11%|█▏        | 25/218 [05:48<25:12,  7.83s/it]generating response:  12%|█▏        | 26/218 [05:58<27:13,  8.51s/it]generating response:  12%|█▏        | 27/218 [06:04<24:58,  7.84s/it]generating response:  13%|█▎        | 28/218 [06:11<23:20,  7.37s/it]generating response:  13%|█▎        | 29/218 [06:31<35:57, 11.41s/it]generating response:  14%|█▍        | 30/218 [06:37<30:01,  9.58s/it]generating response:  14%|█▍        | 31/218 [06:43<26:51,  8.62s/it]generating response:  15%|█▍        | 32/218 [06:50<25:21,  8.18s/it]generating response:  15%|█▌        | 33/218 [07:00<27:00,  8.76s/it]generating response:  16%|█▌        | 34/218 [07:17<34:07, 11.13s/it]generating response:  16%|█▌        | 35/218 [07:25<31:11, 10.23s/it]generating response:  17%|█▋        | 36/218 [07:31<27:13,  8.98s/it]generating response:  17%|█▋        | 37/218 [07:54<39:18, 13.03s/it]generating response:  17%|█▋        | 38/218 [07:58<30:58, 10.32s/it]generating response:  18%|█▊        | 39/218 [08:02<25:05,  8.41s/it]generating response:  18%|█▊        | 40/218 [08:12<27:08,  9.15s/it]generating response:  19%|█▉        | 41/218 [08:17<23:14,  7.88s/it]generating response:  19%|█▉        | 42/218 [08:23<21:17,  7.26s/it]generating response:  20%|█▉        | 43/218 [08:54<41:40, 14.29s/it]generating response:  20%|██        | 44/218 [08:58<32:58, 11.37s/it]generating response:  21%|██        | 45/218 [09:05<28:31,  9.90s/it]generating response:  21%|██        | 46/218 [09:13<27:11,  9.48s/it]generating response:  22%|██▏       | 47/218 [09:24<27:51,  9.78s/it]generating response:  22%|██▏       | 48/218 [09:34<28:04,  9.91s/it]generating response:  22%|██▏       | 49/218 [09:46<29:25, 10.45s/it]generating response:  23%|██▎       | 50/218 [09:53<26:25,  9.44s/it]generating response:  23%|██▎       | 51/218 [10:01<24:56,  8.96s/it]generating response:  24%|██▍       | 52/218 [10:08<23:15,  8.41s/it]generating response:  24%|██▍       | 53/218 [10:13<20:35,  7.49s/it]generating response:  25%|██▍       | 54/218 [10:24<22:58,  8.41s/it]generating response:  25%|██▌       | 55/218 [10:31<22:09,  8.16s/it]generating response:  26%|██▌       | 56/218 [10:50<30:46, 11.40s/it]generating response:  26%|██▌       | 57/218 [10:57<26:24,  9.84s/it]generating response:  27%|██▋       | 58/218 [11:10<28:59, 10.87s/it]generating response:  27%|██▋       | 59/218 [11:14<23:41,  8.94s/it]generating response:  28%|██▊       | 60/218 [11:19<20:06,  7.63s/it]generating response:  28%|██▊       | 61/218 [11:24<17:54,  6.84s/it]generating response:  28%|██▊       | 62/218 [11:28<15:26,  5.94s/it]generating response:  29%|██▉       | 63/218 [11:33<14:39,  5.67s/it]generating response:  29%|██▉       | 64/218 [11:38<14:22,  5.60s/it]generating response:  30%|██▉       | 65/218 [11:45<15:06,  5.92s/it]generating response:  30%|███       | 66/218 [11:53<16:22,  6.46s/it]generating response:  31%|███       | 67/218 [11:57<14:50,  5.89s/it]generating response:  31%|███       | 68/218 [12:02<14:17,  5.72s/it]generating response:  32%|███▏      | 69/218 [12:07<13:43,  5.53s/it]generating response:  32%|███▏      | 70/218 [12:15<14:46,  5.99s/it]generating response:  33%|███▎      | 71/218 [12:21<15:03,  6.14s/it]generating response:  33%|███▎      | 72/218 [12:28<15:54,  6.54s/it]generating response:  33%|███▎      | 73/218 [12:35<15:27,  6.40s/it]generating response:  34%|███▍      | 74/218 [13:18<42:22, 17.66s/it]generating response:  34%|███▍      | 75/218 [13:25<34:16, 14.38s/it]generating response:  35%|███▍      | 76/218 [13:33<29:09, 12.32s/it]generating response:  35%|███▌      | 77/218 [13:37<23:07,  9.84s/it]generating response:  36%|███▌      | 78/218 [13:47<22:54,  9.82s/it]generating response:  36%|███▌      | 79/218 [13:57<23:30, 10.15s/it]generating response:  37%|███▋      | 80/218 [14:07<22:55,  9.97s/it]generating response:  37%|███▋      | 81/218 [14:13<19:43,  8.64s/it]generating response:  38%|███▊      | 82/218 [14:18<17:29,  7.71s/it]generating response:  38%|███▊      | 83/218 [14:27<17:53,  7.96s/it]generating response:  39%|███▊      | 84/218 [14:38<20:07,  9.01s/it]generating response:  39%|███▉      | 85/218 [14:46<19:18,  8.71s/it]generating response:  39%|███▉      | 86/218 [14:52<17:10,  7.81s/it]generating response:  40%|███▉      | 87/218 [15:00<17:34,  8.05s/it]generating response:  40%|████      | 88/218 [15:07<16:26,  7.59s/it]generating response:  41%|████      | 89/218 [15:11<13:47,  6.42s/it]generating response:  41%|████▏     | 90/218 [15:14<11:46,  5.52s/it]generating response:  42%|████▏     | 91/218 [15:19<11:31,  5.45s/it]generating response:  42%|████▏     | 92/218 [15:28<13:15,  6.32s/it]generating response:  43%|████▎     | 93/218 [15:38<15:30,  7.44s/it]generating response:  43%|████▎     | 94/218 [15:44<14:44,  7.13s/it]generating response:  44%|████▎     | 95/218 [15:49<13:21,  6.51s/it]generating response:  44%|████▍     | 96/218 [15:58<14:36,  7.18s/it]generating response:  44%|████▍     | 97/218 [16:03<13:13,  6.56s/it]generating response:  45%|████▍     | 98/218 [16:14<15:36,  7.80s/it]generating response:  45%|████▌     | 99/218 [16:19<14:04,  7.09s/it]generating response:  46%|████▌     | 100/218 [16:28<14:50,  7.55s/it]generating response:  46%|████▋     | 101/218 [16:43<19:20,  9.92s/it]generating response:  47%|████▋     | 102/218 [16:51<17:48,  9.21s/it]generating response:  47%|████▋     | 103/218 [16:56<15:24,  8.04s/it]generating response:  48%|████▊     | 104/218 [17:02<14:02,  7.39s/it]generating response:  48%|████▊     | 105/218 [17:10<14:13,  7.55s/it]generating response:  49%|████▊     | 106/218 [17:16<12:59,  6.96s/it]generating response:  49%|████▉     | 107/218 [17:21<12:18,  6.65s/it]generating response:  50%|████▉     | 108/218 [17:31<13:46,  7.52s/it]generating response:  50%|█████     | 109/218 [17:36<12:29,  6.88s/it]generating response:  50%|█████     | 110/218 [17:41<11:22,  6.32s/it]exception encountered with query110
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 2024060411025386339156141955075)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  51%|█████     | 111/218 [18:28<32:40, 18.33s/it]generating response:  51%|█████▏    | 112/218 [18:34<26:13, 14.85s/it]generating response:  52%|█████▏    | 113/218 [18:40<20:58, 11.98s/it]generating response:  52%|█████▏    | 114/218 [18:46<17:37, 10.17s/it]generating response:  53%|█████▎    | 115/218 [19:02<20:40, 12.05s/it]generating response:  53%|█████▎    | 116/218 [19:29<28:05, 16.52s/it]generating response:  54%|█████▎    | 117/218 [19:36<22:49, 13.56s/it]generating response:  54%|█████▍    | 118/218 [19:45<20:35, 12.35s/it]generating response:  55%|█████▍    | 119/218 [19:56<19:41, 11.94s/it]generating response:  55%|█████▌    | 120/218 [20:01<16:01,  9.81s/it]generating response:  56%|█████▌    | 121/218 [20:07<14:09,  8.75s/it]generating response:  56%|█████▌    | 122/218 [20:14<12:48,  8.00s/it]generating response:  56%|█████▋    | 123/218 [20:22<12:37,  7.97s/it]generating response:  57%|█████▋    | 124/218 [20:28<11:57,  7.63s/it]generating response:  57%|█████▋    | 125/218 [20:40<13:44,  8.87s/it]generating response:  58%|█████▊    | 126/218 [20:47<12:49,  8.37s/it]generating response:  58%|█████▊    | 127/218 [20:58<13:34,  8.96s/it]generating response:  59%|█████▊    | 128/218 [21:11<15:28, 10.31s/it]generating response:  59%|█████▉    | 129/218 [21:14<11:59,  8.08s/it]generating response:  60%|█████▉    | 130/218 [21:28<14:36,  9.96s/it]generating response:  60%|██████    | 131/218 [21:36<13:35,  9.37s/it]generating response:  61%|██████    | 132/218 [21:45<13:09,  9.19s/it]generating response:  61%|██████    | 133/218 [21:53<12:23,  8.74s/it]generating response:  61%|██████▏   | 134/218 [22:18<18:58, 13.56s/it]generating response:  62%|██████▏   | 135/218 [22:23<15:25, 11.14s/it]generating response:  62%|██████▏   | 136/218 [22:30<13:19,  9.75s/it]generating response:  63%|██████▎   | 137/218 [22:36<11:41,  8.66s/it]generating response:  63%|██████▎   | 138/218 [22:42<10:34,  7.94s/it]generating response:  64%|██████▍   | 139/218 [22:50<10:36,  8.06s/it]generating response:  64%|██████▍   | 140/218 [23:00<11:00,  8.47s/it]generating response:  65%|██████▍   | 141/218 [23:10<11:35,  9.03s/it]generating response:  65%|██████▌   | 142/218 [23:21<12:12,  9.64s/it]generating response:  66%|██████▌   | 143/218 [23:30<11:52,  9.51s/it]generating response:  66%|██████▌   | 144/218 [23:43<12:48, 10.39s/it]generating response:  67%|██████▋   | 145/218 [23:59<14:39, 12.05s/it]generating response:  67%|██████▋   | 146/218 [24:08<13:34, 11.32s/it]generating response:  67%|██████▋   | 147/218 [24:19<13:18, 11.24s/it]generating response:  68%|██████▊   | 148/218 [24:34<14:18, 12.26s/it]generating response:  68%|██████▊   | 149/218 [24:50<15:28, 13.45s/it]generating response:  69%|██████▉   | 150/218 [25:06<16:04, 14.18s/it]generating response:  69%|██████▉   | 151/218 [25:15<14:08, 12.66s/it]generating response:  70%|██████▉   | 152/218 [25:35<16:14, 14.76s/it]generating response:  70%|███████   | 153/218 [25:47<15:09, 13.99s/it]generating response:  71%|███████   | 154/218 [25:57<13:26, 12.61s/it]generating response:  71%|███████   | 155/218 [26:03<11:09, 10.63s/it]generating response:  72%|███████▏  | 156/218 [26:14<11:21, 10.99s/it]generating response:  72%|███████▏  | 157/218 [26:23<10:31, 10.36s/it]generating response:  72%|███████▏  | 158/218 [26:29<09:07,  9.12s/it]generating response:  73%|███████▎  | 159/218 [26:52<12:58, 13.20s/it]generating response:  73%|███████▎  | 160/218 [27:38<22:04, 22.83s/it]generating response:  74%|███████▍  | 161/218 [27:54<19:56, 21.00s/it]generating response:  74%|███████▍  | 162/218 [28:19<20:39, 22.13s/it]generating response:  75%|███████▍  | 163/218 [28:43<20:42, 22.58s/it]generating response:  75%|███████▌  | 164/218 [29:13<22:31, 25.04s/it]generating response:  76%|███████▌  | 165/218 [30:03<28:29, 32.26s/it]generating response:  76%|███████▌  | 166/218 [30:17<23:25, 27.03s/it]generating response:  77%|███████▋  | 167/218 [30:41<22:13, 26.16s/it]generating response:  77%|███████▋  | 168/218 [31:07<21:33, 25.86s/it]generating response:  78%|███████▊  | 169/218 [31:21<18:12, 22.29s/it]generating response:  78%|███████▊  | 170/218 [31:30<14:48, 18.51s/it]generating response:  78%|███████▊  | 171/218 [31:40<12:32, 16.02s/it]generating response:  79%|███████▉  | 172/218 [31:58<12:32, 16.36s/it]generating response:  79%|███████▉  | 173/218 [32:09<11:10, 14.89s/it]generating response:  80%|███████▉  | 174/218 [32:21<10:20, 14.09s/it]generating response:  80%|████████  | 175/218 [32:36<10:08, 14.14s/it]generating response:  81%|████████  | 176/218 [32:50<09:58, 14.24s/it]generating response:  81%|████████  | 177/218 [33:23<13:33, 19.83s/it]generating response:  82%|████████▏ | 178/218 [33:38<12:15, 18.38s/it]generating response:  82%|████████▏ | 179/218 [33:48<10:23, 15.99s/it]generating response:  83%|████████▎ | 180/218 [33:59<09:05, 14.35s/it]generating response:  83%|████████▎ | 181/218 [34:08<07:56, 12.88s/it]generating response:  83%|████████▎ | 182/218 [34:22<07:53, 13.14s/it]exception encountered with query182
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 2024060411190979072461102133565)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  84%|████████▍ | 183/218 [34:55<11:07, 19.08s/it]generating response:  84%|████████▍ | 184/218 [35:04<09:02, 15.95s/it]generating response:  85%|████████▍ | 185/218 [35:14<07:50, 14.27s/it]generating response:  85%|████████▌ | 186/218 [35:37<08:56, 16.77s/it]generating response:  86%|████████▌ | 187/218 [35:53<08:36, 16.67s/it]generating response:  86%|████████▌ | 188/218 [36:13<08:50, 17.69s/it]generating response:  87%|████████▋ | 189/218 [36:24<07:33, 15.64s/it]generating response:  87%|████████▋ | 190/218 [36:36<06:47, 14.56s/it]generating response:  88%|████████▊ | 191/218 [36:54<07:02, 15.64s/it]generating response:  88%|████████▊ | 192/218 [37:08<06:34, 15.18s/it]generating response:  89%|████████▊ | 193/218 [37:23<06:19, 15.16s/it]generating response:  89%|████████▉ | 194/218 [37:43<06:32, 16.37s/it]generating response:  89%|████████▉ | 195/218 [37:54<05:40, 14.80s/it]generating response:  90%|████████▉ | 196/218 [39:16<12:48, 34.92s/it]generating response:  90%|█████████ | 197/218 [39:36<10:41, 30.54s/it]generating response:  91%|█████████ | 198/218 [40:01<09:38, 28.92s/it]generating response:  91%|█████████▏| 199/218 [40:22<08:22, 26.44s/it]generating response:  92%|█████████▏| 200/218 [40:32<06:29, 21.63s/it]generating response:  92%|█████████▏| 201/218 [40:40<04:59, 17.61s/it]generating response:  93%|█████████▎| 202/218 [40:50<04:01, 15.12s/it]generating response:  93%|█████████▎| 203/218 [41:02<03:33, 14.26s/it]generating response:  94%|█████████▎| 204/218 [41:14<03:12, 13.75s/it]generating response:  94%|█████████▍| 205/218 [41:20<02:27, 11.37s/it]generating response:  94%|█████████▍| 206/218 [41:40<02:48, 14.01s/it]generating response:  95%|█████████▍| 207/218 [41:53<02:28, 13.49s/it]generating response:  95%|█████████▌| 208/218 [42:02<02:00, 12.09s/it]generating response:  96%|█████████▌| 209/218 [42:15<01:52, 12.52s/it]generating response:  96%|█████████▋| 210/218 [42:45<02:22, 17.87s/it]generating response:  97%|█████████▋| 211/218 [43:00<01:57, 16.74s/it]generating response:  97%|█████████▋| 212/218 [43:08<01:26, 14.34s/it]generating response:  98%|█████████▊| 213/218 [43:30<01:22, 16.60s/it]generating response:  98%|█████████▊| 214/218 [43:43<01:01, 15.39s/it]generating response:  99%|█████████▊| 215/218 [44:05<00:52, 17.49s/it]generating response:  99%|█████████▉| 216/218 [44:30<00:39, 19.63s/it]generating response: 100%|█████████▉| 217/218 [44:52<00:20, 20.37s/it]generating response: 100%|██████████| 218/218 [45:07<00:00, 18.73s/it]generating response: 100%|██████████| 218/218 [45:07<00:00, 12.42s/it]
generation part takes 2707.23s
processed 218 images, 218 texts in 2707.34s
using gpt4 for generation
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:07<26:22,  7.29s/it]generating response:   1%|          | 2/218 [00:15<27:15,  7.57s/it]generating response:   1%|▏         | 3/218 [00:22<27:19,  7.62s/it]generating response:   2%|▏         | 4/218 [00:27<23:36,  6.62s/it]generating response:   2%|▏         | 5/218 [00:31<19:54,  5.61s/it]generating response:   3%|▎         | 6/218 [00:37<20:20,  5.76s/it]generating response:   3%|▎         | 7/218 [00:48<25:46,  7.33s/it]generating response:   4%|▎         | 8/218 [01:10<42:38, 12.18s/it]generating response:   4%|▍         | 9/218 [01:19<38:16, 10.99s/it]generating response:   5%|▍         | 10/218 [01:25<33:33,  9.68s/it]generating response:   5%|▌         | 11/218 [01:30<27:37,  8.01s/it]generating response:   6%|▌         | 12/218 [01:35<24:46,  7.21s/it]generating response:   6%|▌         | 13/218 [01:40<22:07,  6.48s/it]generating response:   6%|▋         | 14/218 [01:46<21:29,  6.32s/it]generating response:   7%|▋         | 15/218 [01:52<21:44,  6.43s/it]generating response:   7%|▋         | 16/218 [02:06<28:48,  8.56s/it]generating response:   8%|▊         | 17/218 [02:17<31:09,  9.30s/it]generating response:   8%|▊         | 18/218 [02:23<27:41,  8.31s/it]generating response:   9%|▊         | 19/218 [02:29<25:42,  7.75s/it]generating response:   9%|▉         | 20/218 [02:48<36:22, 11.02s/it]generating response:  10%|▉         | 21/218 [02:55<32:00,  9.75s/it]generating response:  10%|█         | 22/218 [03:10<37:22, 11.44s/it]generating response:  11%|█         | 23/218 [03:24<39:36, 12.19s/it]generating response:  11%|█         | 24/218 [03:30<33:34, 10.38s/it]generating response:  11%|█▏        | 25/218 [03:42<34:44, 10.80s/it]generating response:  12%|█▏        | 26/218 [03:48<30:14,  9.45s/it]generating response:  12%|█▏        | 27/218 [03:54<26:36,  8.36s/it]generating response:  13%|█▎        | 28/218 [03:59<23:29,  7.42s/it]generating response:  13%|█▎        | 29/218 [04:08<24:46,  7.86s/it]generating response:  14%|█▍        | 30/218 [04:15<23:31,  7.51s/it]generating response:  14%|█▍        | 31/218 [04:26<26:20,  8.45s/it]generating response:  15%|█▍        | 32/218 [04:33<25:20,  8.18s/it]generating response:  15%|█▌        | 33/218 [04:42<25:38,  8.32s/it]generating response:  16%|█▌        | 34/218 [04:47<22:31,  7.35s/it]generating response:  16%|█▌        | 35/218 [04:55<22:46,  7.47s/it]generating response:  17%|█▋        | 36/218 [05:00<20:51,  6.88s/it]generating response:  17%|█▋        | 37/218 [05:08<21:09,  7.01s/it]generating response:  17%|█▋        | 38/218 [05:15<21:46,  7.26s/it]generating response:  18%|█▊        | 39/218 [05:18<17:50,  5.98s/it]generating response:  18%|█▊        | 40/218 [05:30<23:09,  7.81s/it]generating response:  19%|█▉        | 41/218 [05:34<19:29,  6.61s/it]generating response:  19%|█▉        | 42/218 [05:40<18:51,  6.43s/it]generating response:  20%|█▉        | 43/218 [05:47<18:43,  6.42s/it]generating response:  20%|██        | 44/218 [05:50<16:01,  5.53s/it]generating response:  21%|██        | 45/218 [05:57<17:01,  5.90s/it]generating response:  21%|██        | 46/218 [06:04<18:14,  6.36s/it]generating response:  22%|██▏       | 47/218 [06:14<20:42,  7.27s/it]generating response:  22%|██▏       | 48/218 [06:22<21:52,  7.72s/it]generating response:  22%|██▏       | 49/218 [06:29<20:30,  7.28s/it]generating response:  23%|██▎       | 50/218 [06:37<21:03,  7.52s/it]generating response:  23%|██▎       | 51/218 [06:45<21:17,  7.65s/it]generating response:  24%|██▍       | 52/218 [06:53<21:17,  7.69s/it]generating response:  24%|██▍       | 53/218 [06:58<19:27,  7.08s/it]generating response:  25%|██▍       | 54/218 [07:08<21:28,  7.86s/it]generating response:  25%|██▌       | 55/218 [07:16<21:25,  7.88s/it]generating response:  26%|██▌       | 56/218 [07:21<19:02,  7.05s/it]generating response:  26%|██▌       | 57/218 [07:26<17:19,  6.46s/it]generating response:  27%|██▋       | 58/218 [07:31<16:23,  6.15s/it]generating response:  27%|██▋       | 59/218 [07:36<15:23,  5.81s/it]generating response:  28%|██▊       | 60/218 [07:42<14:55,  5.67s/it]generating response:  28%|██▊       | 61/218 [07:46<14:03,  5.37s/it]generating response:  28%|██▊       | 62/218 [07:51<13:26,  5.17s/it]generating response:  29%|██▉       | 63/218 [07:55<12:22,  4.79s/it]generating response:  29%|██▉       | 64/218 [08:02<13:45,  5.36s/it]generating response:  30%|██▉       | 65/218 [08:08<14:02,  5.51s/it]generating response:  30%|███       | 66/218 [08:27<24:21,  9.61s/it]generating response:  31%|███       | 67/218 [08:35<23:16,  9.25s/it]generating response:  31%|███       | 68/218 [08:40<19:33,  7.82s/it]generating response:  32%|███▏      | 69/218 [08:49<20:23,  8.21s/it]exception encountered with query69
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 20240604113838701013900667569)', 'type': '', 'param': '', 'code': '401'}}
generating response:  32%|███▏      | 70/218 [09:02<23:58,  9.72s/it]generating response:  33%|███▎      | 71/218 [09:11<23:18,  9.52s/it]generating response:  33%|███▎      | 72/218 [09:19<22:15,  9.15s/it]generating response:  33%|███▎      | 73/218 [09:31<23:44,  9.82s/it]generating response:  34%|███▍      | 74/218 [09:41<24:08, 10.06s/it]exception encountered with query74
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060411392860194085296626490)', 'type': '', 'param': '', 'code': '401'}}
generating response:  34%|███▍      | 75/218 [09:53<24:48, 10.41s/it]generating response:  35%|███▍      | 76/218 [10:06<26:52, 11.36s/it]generating response:  35%|███▌      | 77/218 [10:11<22:11,  9.44s/it]generating response:  36%|███▌      | 78/218 [10:18<19:58,  8.56s/it]generating response:  36%|███▌      | 79/218 [10:25<18:49,  8.13s/it]generating response:  37%|███▋      | 80/218 [10:31<17:32,  7.63s/it]generating response:  37%|███▋      | 81/218 [10:37<16:03,  7.03s/it]generating response:  38%|███▊      | 82/218 [10:40<13:35,  6.00s/it]generating response:  38%|███▊      | 83/218 [10:47<13:49,  6.15s/it]exception encountered with query83
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060411403564938381362147535)', 'type': '', 'param': '', 'code': '401'}}
generating response:  39%|███▊      | 84/218 [11:00<18:06,  8.11s/it]exception encountered with query84
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060411404737421819489121773)', 'type': '', 'param': '', 'code': '401'}}
generating response:  39%|███▉      | 85/218 [11:11<20:22,  9.19s/it]exception encountered with query85
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 202406041140599204227569593721)', 'type': '', 'param': '', 'code': '401'}}
generating response:  39%|███▉      | 86/218 [11:23<21:53,  9.95s/it]exception encountered with query86
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060411411214967886765813799)', 'type': '', 'param': '', 'code': '401'}}
generating response:  40%|███▉      | 87/218 [11:37<24:06, 11.04s/it]exception encountered with query87
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060411412610138019655023265)', 'type': '', 'param': '', 'code': '401'}}
generating response:  40%|████      | 88/218 [11:51<25:47, 11.91s/it]exception encountered with query88
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 202406041141387225089026566430)', 'type': '', 'param': '', 'code': '401'}}
generating response:  41%|████      | 89/218 [12:02<25:18, 11.77s/it]exception encountered with query89
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411415871315383981093283)', 'type': 'one_api_error'}}
generating response:  41%|████▏     | 90/218 [12:23<30:39, 14.37s/it]exception encountered with query90
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411422074803126290802781)', 'type': 'one_api_error'}}
generating response:  42%|████▏     | 91/218 [12:45<35:18, 16.68s/it]exception encountered with query91
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411424282375341558414347)', 'type': 'one_api_error'}}
generating response:  42%|████▏     | 92/218 [13:07<38:26, 18.30s/it]exception encountered with query92
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411430661852176045467420)', 'type': 'one_api_error'}}
generating response:  43%|████▎     | 93/218 [13:30<41:34, 19.95s/it]exception encountered with query93
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411432892681925874865553)', 'type': 'one_api_error'}}
generating response:  43%|████▎     | 94/218 [13:53<42:40, 20.65s/it]exception encountered with query94
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041143507600260740885343)', 'type': 'one_api_error'}}
generating response:  44%|████▎     | 95/218 [14:14<42:37, 20.79s/it]exception encountered with query95
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411441125073340588387822)', 'type': 'one_api_error'}}
generating response:  44%|████▍     | 96/218 [14:35<42:30, 20.90s/it]exception encountered with query96
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411443213212324845151457)', 'type': 'one_api_error'}}
generating response:  44%|████▍     | 97/218 [14:56<42:08, 20.90s/it]exception encountered with query97
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411445486747475140659185)', 'type': 'one_api_error'}}
generating response:  45%|████▍     | 98/218 [15:19<42:56, 21.47s/it]exception encountered with query98
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411451568415416944819543)', 'type': 'one_api_error'}}
generating response:  45%|████▌     | 99/218 [15:39<42:09, 21.25s/it]exception encountered with query99
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411453634546254715814153)', 'type': 'one_api_error'}}
generating response:  46%|████▌     | 100/218 [16:00<41:26, 21.07s/it]exception encountered with query100
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411455893926626583179005)', 'type': 'one_api_error'}}
generating response:  46%|████▋     | 101/218 [16:23<41:59, 21.53s/it]exception encountered with query101
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411462232074209612736326)', 'type': 'one_api_error'}}
generating response:  47%|████▋     | 102/218 [16:46<42:41, 22.08s/it]exception encountered with query102
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411473780603895586018896)', 'type': 'one_api_error'}}
generating response:  47%|████▋     | 103/218 [18:02<1:13:03, 38.12s/it]exception encountered with query103
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041148058449335363287742)', 'type': 'one_api_error'}}
generating response:  48%|████▊     | 104/218 [18:29<1:06:13, 34.86s/it]exception encountered with query104
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411482859405834740245786)', 'type': 'one_api_error'}}
generating response:  48%|████▊     | 105/218 [18:52<59:15, 31.46s/it]  exception encountered with query105
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411485056123738640149762)', 'type': 'one_api_error'}}
generating response:  49%|████▊     | 106/218 [19:14<53:23, 28.60s/it]exception encountered with query106
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060411491835850395476563031)', 'type': 'one_api_error'}}
generating response:  49%|████▉     | 107/218 [19:42<52:28, 28.37s/it]generating response:  50%|████▉     | 108/218 [20:10<51:54, 28.31s/it]generating response:  50%|█████     | 109/218 [20:17<39:29, 21.74s/it]generating response:  50%|█████     | 110/218 [20:22<29:59, 16.66s/it]exception encountered with query110
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 2024060411513921110174533423934)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  51%|█████     | 111/218 [22:07<1:17:04, 43.22s/it]generating response:  51%|█████▏    | 112/218 [22:15<57:35, 32.60s/it]  generating response:  52%|█████▏    | 113/218 [22:18<41:34, 23.76s/it]generating response:  52%|█████▏    | 114/218 [22:26<33:06, 19.10s/it]generating response:  53%|█████▎    | 115/218 [25:08<1:46:14, 61.89s/it]generating response:  53%|█████▎    | 116/218 [25:13<1:16:10, 44.81s/it]generating response:  54%|█████▎    | 117/218 [25:20<56:39, 33.66s/it]  generating response:  54%|█████▍    | 118/218 [25:29<43:36, 26.17s/it]generating response:  55%|█████▍    | 119/218 [25:36<33:53, 20.54s/it]generating response:  55%|█████▌    | 120/218 [25:39<25:00, 15.31s/it]generating response:  56%|█████▌    | 121/218 [25:52<23:13, 14.36s/it]generating response:  56%|█████▌    | 122/218 [25:56<18:08, 11.34s/it]generating response:  56%|█████▋    | 123/218 [26:06<17:29, 11.05s/it]generating response:  57%|█████▋    | 124/218 [26:19<18:08, 11.58s/it]generating response:  57%|█████▋    | 125/218 [26:29<16:58, 10.95s/it]generating response:  58%|█████▊    | 126/218 [26:57<24:53, 16.24s/it]generating response:  58%|█████▊    | 127/218 [27:04<20:27, 13.48s/it]generating response:  59%|█████▊    | 128/218 [27:14<18:29, 12.33s/it]generating response:  59%|█████▉    | 129/218 [27:22<16:32, 11.15s/it]generating response:  60%|█████▉    | 130/218 [27:35<17:03, 11.63s/it]generating response:  60%|██████    | 131/218 [27:51<18:37, 12.85s/it]generating response:  61%|██████    | 132/218 [28:04<18:44, 13.08s/it]generating response:  61%|██████    | 133/218 [28:19<19:22, 13.68s/it]generating response:  61%|██████▏   | 134/218 [28:36<20:11, 14.42s/it]generating response:  62%|██████▏   | 135/218 [28:43<17:15, 12.47s/it]generating response:  62%|██████▏   | 136/218 [28:50<14:29, 10.60s/it]generating response:  63%|██████▎   | 137/218 [28:57<13:09,  9.75s/it]generating response:  63%|██████▎   | 138/218 [29:03<11:10,  8.38s/it]generating response:  64%|██████▍   | 139/218 [29:17<13:35, 10.32s/it]generating response:  64%|██████▍   | 140/218 [29:30<14:12, 10.93s/it]generating response:  65%|██████▍   | 141/218 [29:42<14:35, 11.36s/it]generating response:  65%|██████▌   | 142/218 [29:53<13:59, 11.05s/it]generating response:  66%|██████▌   | 143/218 [30:04<13:57, 11.16s/it]generating response:  66%|██████▌   | 144/218 [30:15<13:50, 11.22s/it]generating response:  67%|██████▋   | 145/218 [30:31<15:07, 12.43s/it]generating response:  67%|██████▋   | 146/218 [30:43<15:00, 12.50s/it]generating response:  67%|██████▋   | 147/218 [31:03<17:12, 14.54s/it]generating response:  68%|██████▊   | 148/218 [31:12<15:09, 13.00s/it]generating response:  68%|██████▊   | 149/218 [31:23<14:12, 12.35s/it]generating response:  69%|██████▉   | 150/218 [32:25<30:52, 27.25s/it]generating response:  69%|██████▉   | 151/218 [32:32<23:43, 21.25s/it]generating response:  70%|██████▉   | 152/218 [32:43<20:01, 18.20s/it]generating response:  70%|███████   | 153/218 [32:56<17:53, 16.52s/it]generating response:  71%|███████   | 154/218 [33:02<14:23, 13.49s/it]generating response:  71%|███████   | 155/218 [33:10<12:20, 11.75s/it]generating response:  72%|███████▏  | 156/218 [33:15<10:07,  9.80s/it]generating response:  72%|███████▏  | 157/218 [33:19<08:17,  8.15s/it]generating response:  72%|███████▏  | 158/218 [33:29<08:32,  8.54s/it]generating response:  73%|███████▎  | 159/218 [33:50<12:12, 12.42s/it]generating response:  73%|███████▎  | 160/218 [34:04<12:22, 12.79s/it]generating response:  74%|███████▍  | 161/218 [34:27<15:02, 15.83s/it]generating response:  74%|███████▍  | 162/218 [34:46<15:37, 16.74s/it]generating response:  75%|███████▍  | 163/218 [35:06<16:24, 17.90s/it]generating response:  75%|███████▌  | 164/218 [35:24<16:00, 17.78s/it]generating response:  76%|███████▌  | 165/218 [35:47<17:03, 19.31s/it]generating response:  76%|███████▌  | 166/218 [36:05<16:23, 18.91s/it]generating response:  77%|███████▋  | 167/218 [36:21<15:30, 18.25s/it]generating response:  77%|███████▋  | 168/218 [36:49<17:34, 21.09s/it]generating response:  78%|███████▊  | 169/218 [37:05<16:03, 19.66s/it]generating response:  78%|███████▊  | 170/218 [37:18<13:56, 17.44s/it]generating response:  78%|███████▊  | 171/218 [37:32<12:48, 16.36s/it]generating response:  79%|███████▉  | 172/218 [37:48<12:33, 16.37s/it]generating response:  79%|███████▉  | 173/218 [38:03<11:54, 15.89s/it]generating response:  80%|███████▉  | 174/218 [38:19<11:42, 15.96s/it]generating response:  80%|████████  | 175/218 [38:31<10:40, 14.89s/it]generating response:  81%|████████  | 176/218 [38:40<09:08, 13.06s/it]generating response:  81%|████████  | 177/218 [38:50<08:18, 12.16s/it]generating response:  82%|████████▏ | 178/218 [39:01<07:46, 11.67s/it]generating response:  82%|████████▏ | 179/218 [39:16<08:15, 12.70s/it]generating response:  83%|████████▎ | 180/218 [39:24<07:16, 11.48s/it]generating response:  83%|████████▎ | 181/218 [39:56<10:49, 17.54s/it]generating response:  83%|████████▎ | 182/218 [40:12<10:18, 17.18s/it]exception encountered with query182
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 202406041210078357229342615620)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  84%|████████▍ | 183/218 [40:34<10:46, 18.47s/it]generating response:  84%|████████▍ | 184/218 [40:49<09:55, 17.52s/it]generating response:  85%|████████▍ | 185/218 [41:10<10:14, 18.63s/it]generating response:  85%|████████▌ | 186/218 [41:41<11:50, 22.20s/it]generating response:  86%|████████▌ | 187/218 [41:53<09:54, 19.18s/it]generating response:  86%|████████▌ | 188/218 [42:01<07:54, 15.81s/it]generating response:  87%|████████▋ | 189/218 [42:15<07:23, 15.28s/it]generating response:  87%|████████▋ | 190/218 [42:28<06:45, 14.49s/it]generating response:  88%|████████▊ | 191/218 [42:40<06:10, 13.74s/it]generating response:  88%|████████▊ | 192/218 [43:00<06:46, 15.63s/it]generating response:  89%|████████▊ | 193/218 [43:09<05:44, 13.77s/it]generating response:  89%|████████▉ | 194/218 [43:25<05:45, 14.41s/it]generating response:  89%|████████▉ | 195/218 [43:43<05:53, 15.36s/it]generating response:  90%|████████▉ | 196/218 [43:55<05:21, 14.62s/it]generating response:  90%|█████████ | 197/218 [44:31<07:17, 20.84s/it]generating response:  91%|█████████ | 198/218 [44:42<05:56, 17.83s/it]generating response:  91%|█████████▏| 199/218 [44:52<04:53, 15.44s/it]generating response:  92%|█████████▏| 200/218 [44:58<03:48, 12.67s/it]generating response:  92%|█████████▏| 201/218 [45:07<03:17, 11.59s/it]generating response:  93%|█████████▎| 202/218 [45:14<02:43, 10.19s/it]generating response:  93%|█████████▎| 203/218 [45:27<02:45, 11.03s/it]generating response:  94%|█████████▎| 204/218 [45:36<02:27, 10.51s/it]generating response:  94%|█████████▍| 205/218 [45:43<02:03,  9.51s/it]generating response:  94%|█████████▍| 206/218 [45:53<01:53,  9.47s/it]generating response:  95%|█████████▍| 207/218 [46:07<02:01, 11.04s/it]generating response:  95%|█████████▌| 208/218 [46:14<01:36,  9.67s/it]generating response:  96%|█████████▌| 209/218 [46:27<01:37, 10.84s/it]generating response:  96%|█████████▋| 210/218 [46:45<01:42, 12.78s/it]generating response:  97%|█████████▋| 211/218 [46:58<01:31, 13.05s/it]generating response:  97%|█████████▋| 212/218 [47:10<01:16, 12.75s/it]generating response:  98%|█████████▊| 213/218 [47:21<01:00, 12.16s/it]generating response:  98%|█████████▊| 214/218 [47:36<00:51, 12.94s/it]generating response:  99%|█████████▊| 215/218 [47:49<00:39, 13.03s/it]generating response:  99%|█████████▉| 216/218 [48:07<00:29, 14.53s/it]generating response: 100%|█████████▉| 217/218 [48:43<00:20, 20.80s/it]generating response: 100%|██████████| 218/218 [48:55<00:00, 18.22s/it]generating response: 100%|██████████| 218/218 [48:55<00:00, 13.46s/it]
generation part takes 2935.28s
processed 218 images, 218 texts in 5642.65s
using gpt4 for generation
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:13<50:12, 13.88s/it]generating response:   1%|          | 2/218 [00:24<42:29, 11.80s/it]generating response:   1%|▏         | 3/218 [00:37<44:22, 12.38s/it]generating response:   2%|▏         | 4/218 [00:40<31:23,  8.80s/it]generating response:   2%|▏         | 5/218 [00:48<29:43,  8.37s/it]generating response:   3%|▎         | 6/218 [00:54<26:34,  7.52s/it]generating response:   3%|▎         | 7/218 [01:01<26:49,  7.63s/it]generating response:   4%|▎         | 8/218 [01:21<39:41, 11.34s/it]generating response:   4%|▍         | 9/218 [01:28<35:30, 10.19s/it]generating response:   5%|▍         | 10/218 [01:36<32:01,  9.24s/it]generating response:   5%|▌         | 11/218 [01:40<26:37,  7.72s/it]generating response:   6%|▌         | 12/218 [01:47<25:55,  7.55s/it]generating response:   6%|▌         | 13/218 [01:57<28:13,  8.26s/it]generating response:   6%|▋         | 14/218 [02:04<26:49,  7.89s/it]generating response:   7%|▋         | 15/218 [02:11<26:18,  7.78s/it]generating response:   7%|▋         | 16/218 [02:19<25:37,  7.61s/it]generating response:   8%|▊         | 17/218 [02:26<25:21,  7.57s/it]generating response:   8%|▊         | 18/218 [02:31<22:29,  6.75s/it]generating response:   9%|▊         | 19/218 [02:37<21:25,  6.46s/it]generating response:   9%|▉         | 20/218 [02:43<20:50,  6.32s/it]generating response:  10%|▉         | 21/218 [02:49<21:01,  6.40s/it]generating response:  10%|█         | 22/218 [03:02<26:44,  8.19s/it]generating response:  11%|█         | 23/218 [03:11<27:56,  8.60s/it]generating response:  11%|█         | 24/218 [03:18<26:03,  8.06s/it]generating response:  11%|█▏        | 25/218 [03:23<23:20,  7.25s/it]generating response:  12%|█▏        | 26/218 [03:29<21:41,  6.78s/it]generating response:  12%|█▏        | 27/218 [03:39<24:10,  7.60s/it]generating response:  13%|█▎        | 28/218 [03:45<22:54,  7.24s/it]generating response:  13%|█▎        | 29/218 [03:51<21:35,  6.85s/it]generating response:  14%|█▍        | 30/218 [03:59<22:41,  7.24s/it]generating response:  14%|█▍        | 31/218 [04:09<25:19,  8.12s/it]generating response:  15%|█▍        | 32/218 [04:14<22:14,  7.18s/it]generating response:  15%|█▌        | 33/218 [04:29<28:44,  9.32s/it]generating response:  16%|█▌        | 34/218 [04:35<25:53,  8.44s/it]generating response:  16%|█▌        | 35/218 [04:41<23:30,  7.71s/it]generating response:  17%|█▋        | 36/218 [04:46<21:01,  6.93s/it]generating response:  17%|█▋        | 37/218 [04:53<21:22,  7.09s/it]generating response:  17%|█▋        | 38/218 [04:57<18:04,  6.02s/it]generating response:  18%|█▊        | 39/218 [05:01<15:43,  5.27s/it]generating response:  18%|█▊        | 40/218 [05:09<18:12,  6.14s/it]generating response:  19%|█▉        | 41/218 [05:13<16:33,  5.61s/it]generating response:  19%|█▉        | 42/218 [05:18<15:38,  5.33s/it]generating response:  20%|█▉        | 43/218 [05:24<16:41,  5.72s/it]generating response:  20%|██        | 44/218 [05:28<14:27,  4.98s/it]generating response:  21%|██        | 45/218 [05:34<15:29,  5.37s/it]generating response:  21%|██        | 46/218 [05:40<16:07,  5.62s/it]generating response:  22%|██▏       | 47/218 [05:48<17:42,  6.21s/it]generating response:  22%|██▏       | 48/218 [05:58<20:43,  7.32s/it]generating response:  22%|██▏       | 49/218 [06:20<33:34, 11.92s/it]generating response:  23%|██▎       | 50/218 [06:30<31:36, 11.29s/it]generating response:  23%|██▎       | 51/218 [06:36<27:02,  9.71s/it]generating response:  24%|██▍       | 52/218 [06:43<24:38,  8.91s/it]generating response:  24%|██▍       | 53/218 [06:58<29:21, 10.68s/it]generating response:  25%|██▍       | 54/218 [07:04<24:58,  9.14s/it]generating response:  25%|██▌       | 55/218 [07:26<35:31, 13.08s/it]generating response:  26%|██▌       | 56/218 [07:32<29:25, 10.90s/it]generating response:  26%|██▌       | 57/218 [07:37<24:50,  9.26s/it]generating response:  27%|██▋       | 58/218 [07:44<23:03,  8.65s/it]generating response:  27%|██▋       | 59/218 [07:48<19:07,  7.22s/it]generating response:  28%|██▊       | 60/218 [07:52<16:41,  6.34s/it]generating response:  28%|██▊       | 61/218 [08:01<18:08,  6.93s/it]generating response:  28%|██▊       | 62/218 [08:05<15:49,  6.09s/it]generating response:  29%|██▉       | 63/218 [08:09<14:20,  5.55s/it]generating response:  29%|██▉       | 64/218 [08:16<15:02,  5.86s/it]generating response:  30%|██▉       | 65/218 [08:24<16:31,  6.48s/it]generating response:  30%|███       | 66/218 [08:30<16:28,  6.50s/it]generating response:  31%|███       | 67/218 [08:41<19:34,  7.78s/it]generating response:  31%|███       | 68/218 [08:46<17:06,  6.85s/it]generating response:  32%|███▏      | 69/218 [08:51<16:04,  6.47s/it]generating response:  32%|███▏      | 70/218 [09:00<17:29,  7.09s/it]generating response:  33%|███▎      | 71/218 [09:06<17:01,  6.95s/it]generating response:  33%|███▎      | 72/218 [09:35<32:32, 13.37s/it]generating response:  33%|███▎      | 73/218 [09:50<33:22, 13.81s/it]generating response:  34%|███▍      | 74/218 [09:58<29:03, 12.10s/it]generating response:  34%|███▍      | 75/218 [10:02<23:27,  9.84s/it]generating response:  35%|███▍      | 76/218 [10:07<19:44,  8.34s/it]generating response:  35%|███▌      | 77/218 [10:11<16:45,  7.13s/it]generating response:  36%|███▌      | 78/218 [10:17<15:47,  6.76s/it]generating response:  36%|███▌      | 79/218 [10:25<16:01,  6.91s/it]generating response:  37%|███▋      | 80/218 [10:31<15:27,  6.72s/it]generating response:  37%|███▋      | 81/218 [10:46<21:00,  9.20s/it]generating response:  38%|███▊      | 82/218 [10:51<17:51,  7.88s/it]generating response:  38%|███▊      | 83/218 [10:57<16:29,  7.33s/it]generating response:  39%|███▊      | 84/218 [11:05<17:02,  7.63s/it]generating response:  39%|███▉      | 85/218 [11:11<15:43,  7.09s/it]generating response:  39%|███▉      | 86/218 [11:27<21:18,  9.68s/it]generating response:  40%|███▉      | 87/218 [11:34<19:54,  9.12s/it]generating response:  40%|████      | 88/218 [11:41<18:03,  8.33s/it]generating response:  41%|████      | 89/218 [11:45<14:58,  6.96s/it]generating response:  41%|████▏     | 90/218 [11:58<19:13,  9.01s/it]generating response:  42%|████▏     | 91/218 [12:03<16:24,  7.75s/it]generating response:  42%|████▏     | 92/218 [12:19<21:24, 10.20s/it]generating response:  43%|████▎     | 93/218 [13:08<45:10, 21.69s/it]generating response:  43%|████▎     | 94/218 [13:14<35:00, 16.94s/it]generating response:  44%|████▎     | 95/218 [13:20<28:23, 13.85s/it]generating response:  44%|████▍     | 96/218 [13:24<22:11, 10.92s/it]generating response:  44%|████▍     | 97/218 [13:42<25:54, 12.85s/it]generating response:  45%|████▍     | 98/218 [13:56<26:33, 13.28s/it]generating response:  45%|████▌     | 99/218 [14:05<23:48, 12.00s/it]generating response:  46%|████▌     | 100/218 [14:11<20:20, 10.34s/it]generating response:  46%|████▋     | 101/218 [16:45<1:44:01, 53.35s/it]generating response:  47%|████▋     | 102/218 [17:27<1:36:21, 49.84s/it]generating response:  47%|████▋     | 103/218 [17:35<1:11:40, 37.40s/it]generating response:  48%|████▊     | 104/218 [17:42<53:35, 28.20s/it]  generating response:  48%|████▊     | 105/218 [17:50<41:40, 22.13s/it]generating response:  49%|████▊     | 106/218 [17:55<31:43, 17.00s/it]generating response:  49%|████▉     | 107/218 [18:28<40:29, 21.88s/it]generating response:  50%|████▉     | 108/218 [18:39<34:19, 18.72s/it]generating response:  50%|█████     | 109/218 [18:44<26:13, 14.43s/it]generating response:  50%|█████     | 110/218 [18:48<20:21, 11.31s/it]exception encountered with query110
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 202406041238099727276566080984)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  51%|█████     | 111/218 [19:43<43:40, 24.49s/it]generating response:  51%|█████▏    | 112/218 [19:51<34:35, 19.58s/it]generating response:  52%|█████▏    | 113/218 [19:57<26:45, 15.29s/it]generating response:  52%|█████▏    | 114/218 [20:02<21:23, 12.34s/it]generating response:  53%|█████▎    | 115/218 [20:29<28:57, 16.87s/it]generating response:  53%|█████▎    | 116/218 [21:18<44:35, 26.24s/it]generating response:  54%|█████▎    | 117/218 [21:36<40:06, 23.82s/it]generating response:  54%|█████▍    | 118/218 [21:45<32:24, 19.44s/it]generating response:  55%|█████▍    | 119/218 [22:04<31:38, 19.18s/it]generating response:  55%|█████▌    | 120/218 [22:21<30:41, 18.79s/it]generating response:  56%|█████▌    | 121/218 [22:28<24:21, 15.07s/it]generating response:  56%|█████▌    | 122/218 [22:33<19:09, 11.97s/it]generating response:  56%|█████▋    | 123/218 [22:40<16:43, 10.57s/it]generating response:  57%|█████▋    | 124/218 [22:47<15:03,  9.61s/it]generating response:  57%|█████▋    | 125/218 [22:51<12:04,  7.79s/it]generating response:  58%|█████▊    | 126/218 [23:50<35:35, 23.21s/it]generating response:  58%|█████▊    | 127/218 [23:57<28:04, 18.51s/it]generating response:  59%|█████▊    | 128/218 [24:07<23:41, 15.79s/it]generating response:  59%|█████▉    | 129/218 [24:12<18:44, 12.63s/it]generating response:  60%|█████▉    | 130/218 [25:02<34:50, 23.76s/it]generating response:  60%|██████    | 131/218 [26:00<49:18, 34.00s/it]generating response:  61%|██████    | 132/218 [27:25<1:10:43, 49.35s/it]generating response:  61%|██████    | 133/218 [27:46<57:56, 40.90s/it]  generating response:  61%|██████▏   | 134/218 [28:08<49:12, 35.15s/it]generating response:  62%|██████▏   | 135/218 [28:15<36:50, 26.64s/it]generating response:  62%|██████▏   | 136/218 [29:07<47:02, 34.42s/it]generating response:  63%|██████▎   | 137/218 [29:15<35:46, 26.49s/it]generating response:  63%|██████▎   | 138/218 [29:22<27:32, 20.66s/it]generating response:  64%|██████▍   | 139/218 [29:33<23:11, 17.62s/it]generating response:  64%|██████▍   | 140/218 [29:41<19:09, 14.74s/it]generating response:  65%|██████▍   | 141/218 [30:15<26:15, 20.46s/it]generating response:  65%|██████▌   | 142/218 [30:24<21:47, 17.20s/it]generating response:  66%|██████▌   | 143/218 [30:37<19:43, 15.79s/it]generating response:  66%|██████▌   | 144/218 [30:46<16:53, 13.70s/it]generating response:  67%|██████▋   | 145/218 [30:54<14:39, 12.05s/it]generating response:  67%|██████▋   | 146/218 [31:02<12:59, 10.82s/it]generating response:  67%|██████▋   | 147/218 [31:17<14:18, 12.09s/it]generating response:  68%|██████▊   | 148/218 [31:27<13:28, 11.54s/it]generating response:  68%|██████▊   | 149/218 [31:58<20:00, 17.39s/it]generating response:  69%|██████▉   | 150/218 [32:12<18:26, 16.27s/it]generating response:  69%|██████▉   | 151/218 [32:19<15:19, 13.72s/it]generating response:  70%|██████▉   | 152/218 [32:52<21:26, 19.49s/it]generating response:  70%|███████   | 153/218 [33:31<27:15, 25.16s/it]generating response:  71%|███████   | 154/218 [33:41<21:57, 20.59s/it]generating response:  71%|███████   | 155/218 [33:46<16:56, 16.14s/it]generating response:  72%|███████▏  | 156/218 [33:54<13:51, 13.41s/it]generating response:  72%|███████▏  | 157/218 [33:58<10:49, 10.65s/it]generating response:  72%|███████▏  | 158/218 [34:09<10:53, 10.89s/it]generating response:  73%|███████▎  | 159/218 [34:42<17:03, 17.35s/it]generating response:  73%|███████▎  | 160/218 [35:21<23:12, 24.00s/it]generating response:  74%|███████▍  | 161/218 [36:02<27:30, 28.96s/it]generating response:  74%|███████▍  | 162/218 [36:24<25:05, 26.88s/it]generating response:  75%|███████▍  | 163/218 [36:42<22:10, 24.20s/it]generating response:  75%|███████▌  | 164/218 [37:28<27:46, 30.86s/it]generating response:  76%|███████▌  | 165/218 [38:22<33:15, 37.66s/it]generating response:  76%|███████▌  | 166/218 [38:43<28:29, 32.88s/it]generating response:  77%|███████▋  | 167/218 [39:19<28:46, 33.85s/it]generating response:  77%|███████▋  | 168/218 [39:41<25:03, 30.07s/it]generating response:  78%|███████▊  | 169/218 [40:16<25:46, 31.55s/it]generating response:  78%|███████▊  | 170/218 [40:24<19:40, 24.60s/it]generating response:  78%|███████▊  | 171/218 [40:35<16:10, 20.65s/it]generating response:  79%|███████▉  | 172/218 [40:45<13:21, 17.42s/it]generating response:  79%|███████▉  | 173/218 [40:59<12:18, 16.42s/it]generating response:  80%|███████▉  | 174/218 [41:09<10:36, 14.47s/it]generating response:  80%|████████  | 175/218 [41:19<09:22, 13.08s/it]generating response:  81%|████████  | 176/218 [41:29<08:23, 11.98s/it]generating response:  81%|████████  | 177/218 [41:36<07:14, 10.59s/it]generating response:  82%|████████▏ | 178/218 [41:45<06:48, 10.20s/it]generating response:  82%|████████▏ | 179/218 [41:58<07:03, 10.85s/it]generating response:  83%|████████▎ | 180/218 [42:27<10:24, 16.42s/it]generating response:  83%|████████▎ | 181/218 [43:22<17:11, 27.87s/it]generating response:  83%|████████▎ | 182/218 [44:06<19:42, 32.84s/it]exception encountered with query182
Error code: 400 - {'error': {'message': "The response was filtered due to the prompt triggering Azure OpenAI's content management policy. Please modify your prompt and retry. To learn more about our content filtering policies please read our documentation: \r\nhttps://******/fwlink/?linkid=2198766. (request id: 202406041302598820848555970074)", 'type': '', 'param': 'prompt', 'code': 'content_filter'}}
generating response:  84%|████████▍ | 183/218 [44:29<17:22, 29.80s/it]generating response:  84%|████████▍ | 184/218 [44:38<13:24, 23.65s/it]generating response:  85%|████████▍ | 185/218 [45:02<13:04, 23.78s/it]generating response:  85%|████████▌ | 186/218 [45:13<10:39, 19.97s/it]generating response:  86%|████████▌ | 187/218 [45:31<09:56, 19.25s/it]generating response:  86%|████████▌ | 188/218 [45:41<08:11, 16.40s/it]generating response:  87%|████████▋ | 189/218 [46:06<09:14, 19.12s/it]generating response:  87%|████████▋ | 190/218 [46:21<08:20, 17.88s/it]generating response:  88%|████████▊ | 191/218 [46:33<07:12, 16.01s/it]generating response:  88%|████████▊ | 192/218 [46:49<07:00, 16.18s/it]generating response:  89%|████████▊ | 193/218 [47:20<08:31, 20.47s/it]generating response:  89%|████████▉ | 194/218 [47:33<07:21, 18.41s/it]generating response:  89%|████████▉ | 195/218 [47:48<06:39, 17.35s/it]generating response:  90%|████████▉ | 196/218 [48:11<06:58, 19.01s/it]generating response:  90%|█████████ | 197/218 [48:34<07:06, 20.30s/it]generating response:  91%|█████████ | 198/218 [48:46<05:54, 17.74s/it]generating response:  91%|█████████▏| 199/218 [48:59<05:06, 16.15s/it]generating response:  92%|█████████▏| 200/218 [49:17<05:05, 16.98s/it]generating response:  92%|█████████▏| 201/218 [49:26<04:05, 14.44s/it]generating response:  93%|█████████▎| 202/218 [49:44<04:07, 15.47s/it]generating response:  93%|█████████▎| 203/218 [50:05<04:19, 17.28s/it]generating response:  94%|█████████▎| 204/218 [50:22<03:58, 17.03s/it]exception encountered with query204
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060413090483688993260803934)', 'type': '', 'param': '', 'code': '401'}}
generating response:  94%|█████████▍| 205/218 [50:34<03:20, 15.44s/it]exception encountered with query205
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060413091682888635859653587)', 'type': '', 'param': '', 'code': '401'}}
generating response:  94%|█████████▍| 206/218 [50:46<02:52, 14.41s/it]exception encountered with query206
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060413092945366845113067194)', 'type': '', 'param': '', 'code': '401'}}
generating response:  95%|█████████▍| 207/218 [50:58<02:32, 13.89s/it]exception encountered with query207
Error code: 401 - {'error': {'message': 'Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource. (request id: 2024060413094127193944740116138)', 'type': '', 'param': '', 'code': '401'}}
generating response:  95%|█████████▌| 208/218 [51:10<02:12, 13.25s/it]exception encountered with query208
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041309563097192916145892)', 'type': 'one_api_error'}}
generating response:  96%|█████████▌| 209/218 [51:24<02:02, 13.62s/it]exception encountered with query209
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 202406041310178798735282685726)', 'type': 'one_api_error'}}
generating response:  96%|█████████▋| 210/218 [51:46<02:06, 15.86s/it]exception encountered with query210
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060413103793438199280992034)', 'type': 'one_api_error'}}
generating response:  97%|█████████▋| 211/218 [52:06<02:01, 17.35s/it]exception encountered with query211
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060413105938795765930303334)', 'type': 'one_api_error'}}
generating response:  97%|█████████▋| 212/218 [52:28<01:51, 18.58s/it]exception encountered with query212
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060413112081748555080021388)', 'type': 'one_api_error'}}
generating response:  98%|█████████▊| 213/218 [52:49<01:37, 19.44s/it]exception encountered with query213
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060413114097173133167823697)', 'type': 'one_api_error'}}
generating response:  98%|█████████▊| 214/218 [53:09<01:18, 19.65s/it]exception encountered with query214
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060413120251582806511028297)', 'type': 'one_api_error'}}
generating response:  99%|█████████▊| 215/218 [53:31<01:00, 20.23s/it]exception encountered with query215
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060413122567469935824727339)', 'type': 'one_api_error'}}
generating response:  99%|█████████▉| 216/218 [53:54<00:42, 21.13s/it]exception encountered with query216
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060413124619708037368977257)', 'type': 'one_api_error'}}
generating response: 100%|█████████▉| 217/218 [54:15<00:20, 20.92s/it]exception encountered with query217
Error code: 503 - {'error': {'message': '当前分组 default 下对于模型 gpt-4-vision-preview 无可用渠道 (request id: 2024060413130695832217832681094)', 'type': 'one_api_error'}}
generating response: 100%|██████████| 218/218 [54:35<00:00, 20.87s/it]generating response: 100%|██████████| 218/218 [54:35<00:00, 15.03s/it]
generation part takes 3275.95s
Full generation completed in 8918.61s
query number: 218
-------gpt4 without defence generation complete-------
