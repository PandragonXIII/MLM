/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/4 [00:00<?, ?it/s]denoise batch:  25%|██▌       | 1/4 [00:24<01:13, 24.64s/it]denoise batch:  50%|█████     | 2/4 [00:49<00:49, 24.61s/it]denoise batch:  75%|███████▌  | 3/4 [01:13<00:24, 24.63s/it]denoise batch: 100%|██████████| 4/4 [01:38<00:00, 24.68s/it]denoise batch: 100%|██████████| 4/4 [01:38<00:00, 24.66s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.55it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  3.94it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.92it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.33it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp_llava
Done
Defender initialized with threshold=-0.003936767578125
processed 200 images, 200 texts in 215.64s
using llava for generation
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.18s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.12s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.06s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.08s/it]
generating response:   0%|          | 0/200 [00:00<?, ?it/s]generating response:   0%|          | 1/200 [00:26<1:28:54, 26.81s/it]generating response:  11%|█         | 22/200 [00:48<05:33,  1.87s/it] generating response:  20%|██        | 41/200 [00:50<02:22,  1.12it/s]generating response:  34%|███▎      | 67/200 [00:52<01:02,  2.14it/s]generating response:  34%|███▍      | 69/200 [01:00<01:25,  1.53it/s]generating response:  42%|████▏     | 84/200 [01:04<00:58,  1.98it/s]generating response:  44%|████▎     | 87/200 [01:11<01:16,  1.48it/s]generating response:  50%|█████     | 100/200 [01:14<00:52,  1.89it/s]generating response:  60%|██████    | 120/200 [01:36<01:01,  1.30it/s]generating response:  60%|██████    | 121/200 [02:05<02:10,  1.65s/it]generating response:  62%|██████▎   | 125/200 [02:09<01:57,  1.57s/it]generating response:  69%|██████▉   | 138/200 [02:14<01:06,  1.08s/it]generating response:  74%|███████▍  | 149/200 [02:16<00:40,  1.27it/s]generating response:  79%|███████▉  | 158/200 [02:26<00:36,  1.16it/s]generating response:  92%|█████████▎| 185/200 [02:39<00:09,  1.50it/s]generating response: 100%|██████████| 200/200 [02:39<00:00,  1.25it/s]
generation part takes 174.40s
Full generation completed in 390.08s
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
processed 200 images, 200 texts in 0.07s
using llava for generation
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.26s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.16s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.11s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.14s/it]
generating response:   0%|          | 0/200 [00:00<?, ?it/s]generating response:   0%|          | 1/200 [00:20<1:06:33, 20.07s/it]generating response:   1%|          | 2/200 [00:23<34:40, 10.51s/it]  generating response:   2%|▏         | 3/200 [00:27<24:47,  7.55s/it]generating response:   2%|▏         | 4/200 [00:57<52:43, 16.14s/it]generating response:   2%|▎         | 5/200 [01:01<38:05, 11.72s/it]generating response:   3%|▎         | 6/200 [01:03<28:04,  8.68s/it]generating response:   4%|▎         | 7/200 [01:07<22:25,  6.97s/it]generating response:   4%|▍         | 8/200 [01:10<18:33,  5.80s/it]generating response:   4%|▍         | 9/200 [01:25<27:36,  8.67s/it]generating response:   5%|▌         | 10/200 [01:39<32:39, 10.31s/it]generating response:   6%|▌         | 11/200 [02:00<42:20, 13.44s/it]generating response:   6%|▌         | 12/200 [02:10<39:08, 12.49s/it]generating response:   6%|▋         | 13/200 [02:16<32:45, 10.51s/it]generating response:   7%|▋         | 14/200 [02:23<28:55,  9.33s/it]generating response:   8%|▊         | 15/200 [02:40<36:47, 11.93s/it]generating response:   8%|▊         | 16/200 [02:53<37:02, 12.08s/it]generating response:   8%|▊         | 17/200 [03:09<40:30, 13.28s/it]generating response:   9%|▉         | 18/200 [03:37<53:36, 17.67s/it]generating response:  10%|▉         | 19/200 [03:49<48:40, 16.14s/it]generating response:  10%|█         | 20/200 [04:01<44:39, 14.89s/it]generating response:  10%|█         | 21/200 [04:18<45:47, 15.35s/it]generating response:  11%|█         | 22/200 [04:39<51:07, 17.23s/it]generating response:  12%|█▏        | 23/200 [04:47<42:23, 14.37s/it]generating response:  12%|█▏        | 24/200 [04:54<35:13, 12.01s/it]generating response:  12%|█▎        | 25/200 [04:59<29:20, 10.06s/it]generating response:  13%|█▎        | 26/200 [05:12<31:30, 10.86s/it]generating response:  14%|█▎        | 27/200 [05:21<29:35, 10.26s/it]generating response:  14%|█▍        | 28/200 [05:28<27:07,  9.46s/it]generating response:  14%|█▍        | 29/200 [05:34<23:38,  8.29s/it]generating response:  15%|█▌        | 30/200 [05:51<31:09, 11.00s/it]generating response:  16%|█▌        | 31/200 [06:11<38:34, 13.69s/it]generating response:  16%|█▌        | 32/200 [06:29<42:03, 15.02s/it]generating response:  16%|█▋        | 33/200 [06:53<49:13, 17.69s/it]generating response:  17%|█▋        | 34/200 [07:15<51:58, 18.79s/it]generating response:  18%|█▊        | 35/200 [07:36<53:51, 19.58s/it]generating response:  18%|█▊        | 36/200 [08:03<59:16, 21.68s/it]generating response:  18%|█▊        | 37/200 [08:26<1:00:31, 22.28s/it]generating response:  19%|█▉        | 38/200 [08:48<59:45, 22.13s/it]  generating response:  20%|█▉        | 39/200 [09:13<1:01:26, 22.90s/it]generating response:  20%|██        | 40/200 [09:36<1:01:03, 22.90s/it]generating response:  20%|██        | 41/200 [09:38<44:12, 16.68s/it]  generating response:  21%|██        | 42/200 [09:41<33:12, 12.61s/it]generating response:  22%|██▏       | 43/200 [09:46<27:09, 10.38s/it]generating response:  22%|██▏       | 44/200 [09:53<24:07,  9.28s/it]generating response:  22%|██▎       | 45/200 [10:21<38:32, 14.92s/it]generating response:  23%|██▎       | 46/200 [10:38<40:07, 15.63s/it]generating response:  24%|██▎       | 47/200 [10:57<42:40, 16.73s/it]generating response:  24%|██▍       | 48/200 [11:24<49:42, 19.62s/it]generating response:  24%|██▍       | 49/200 [11:49<53:19, 21.19s/it]generating response:  25%|██▌       | 50/200 [12:07<51:03, 20.43s/it]generating response:  26%|██▌       | 51/200 [12:26<49:15, 19.84s/it]generating response:  26%|██▌       | 52/200 [12:49<51:20, 20.82s/it]generating response:  26%|██▋       | 53/200 [12:55<40:04, 16.36s/it]generating response:  27%|██▋       | 54/200 [13:04<34:25, 14.15s/it]generating response:  28%|██▊       | 55/200 [13:19<34:44, 14.37s/it]generating response:  28%|██▊       | 56/200 [13:36<36:44, 15.31s/it]generating response:  28%|██▊       | 57/200 [13:57<40:40, 17.07s/it]generating response:  29%|██▉       | 58/200 [14:00<30:22, 12.83s/it]generating response:  30%|██▉       | 59/200 [14:08<26:18, 11.20s/it]generating response:  30%|███       | 60/200 [14:16<23:59, 10.28s/it]generating response:  30%|███       | 61/200 [14:25<23:04,  9.96s/it]generating response:  31%|███       | 62/200 [14:32<20:37,  8.97s/it]generating response:  32%|███▏      | 63/200 [14:44<22:36,  9.90s/it]generating response:  32%|███▏      | 64/200 [14:48<18:49,  8.30s/it]generating response:  32%|███▎      | 65/200 [14:54<16:56,  7.53s/it]generating response:  33%|███▎      | 66/200 [14:59<15:06,  6.76s/it]generating response:  34%|███▎      | 67/200 [15:01<11:43,  5.29s/it]generating response:  34%|███▍      | 68/200 [15:09<13:07,  5.97s/it]generating response:  34%|███▍      | 69/200 [15:16<14:16,  6.53s/it]generating response:  35%|███▌      | 70/200 [15:23<13:59,  6.46s/it]generating response:  36%|███▌      | 71/200 [15:47<25:08, 11.69s/it]generating response:  36%|███▌      | 72/200 [16:00<25:56, 12.16s/it]generating response:  36%|███▋      | 73/200 [16:15<27:46, 13.12s/it]generating response:  37%|███▋      | 74/200 [16:17<20:39,  9.84s/it]generating response:  38%|███▊      | 75/200 [16:28<20:55, 10.05s/it]generating response:  38%|███▊      | 76/200 [16:44<24:28, 11.84s/it]generating response:  38%|███▊      | 77/200 [16:49<20:00,  9.76s/it]generating response:  39%|███▉      | 78/200 [16:56<18:15,  8.98s/it]generating response:  40%|███▉      | 79/200 [17:00<15:16,  7.58s/it]generating response:  40%|████      | 80/200 [17:06<14:12,  7.10s/it]generating response:  40%|████      | 81/200 [17:11<12:29,  6.30s/it]generating response:  41%|████      | 82/200 [17:16<11:39,  5.93s/it]generating response:  42%|████▏     | 83/200 [17:45<25:12, 12.92s/it]generating response:  42%|████▏     | 84/200 [17:49<19:36, 10.14s/it]generating response:  42%|████▎     | 85/200 [18:05<23:02, 12.02s/it]generating response:  43%|████▎     | 86/200 [18:26<27:41, 14.58s/it]generating response:  44%|████▎     | 87/200 [18:33<23:08, 12.29s/it]generating response:  44%|████▍     | 88/200 [18:43<21:44, 11.65s/it]generating response:  44%|████▍     | 89/200 [18:56<22:30, 12.17s/it]generating response:  45%|████▌     | 90/200 [19:05<20:45, 11.32s/it]generating response:  46%|████▌     | 91/200 [19:13<18:44, 10.31s/it]generating response:  46%|████▌     | 92/200 [19:37<25:43, 14.29s/it]generating response:  46%|████▋     | 93/200 [19:44<21:22, 11.98s/it]generating response:  47%|████▋     | 94/200 [19:47<16:45,  9.48s/it]generating response:  48%|████▊     | 95/200 [19:54<15:25,  8.81s/it]generating response:  48%|████▊     | 96/200 [20:02<14:48,  8.55s/it]generating response:  48%|████▊     | 97/200 [20:11<14:27,  8.42s/it]generating response:  49%|████▉     | 98/200 [20:27<18:26, 10.85s/it]generating response:  50%|████▉     | 99/200 [20:43<21:03, 12.51s/it]generating response:  50%|█████     | 100/200 [20:47<16:23,  9.83s/it]generating response:  50%|█████     | 101/200 [20:48<12:02,  7.29s/it]generating response:  51%|█████     | 102/200 [20:57<12:29,  7.64s/it]generating response:  52%|█████▏    | 103/200 [21:08<14:15,  8.82s/it]generating response:  52%|█████▏    | 104/200 [21:38<23:54, 14.95s/it]generating response:  52%|█████▎    | 105/200 [21:44<19:45, 12.48s/it]generating response:  53%|█████▎    | 106/200 [21:51<16:50, 10.75s/it]generating response:  54%|█████▎    | 107/200 [21:53<12:40,  8.18s/it]generating response:  54%|█████▍    | 108/200 [22:00<11:57,  7.80s/it]generating response:  55%|█████▍    | 109/200 [22:05<10:15,  6.77s/it]generating response:  55%|█████▌    | 110/200 [22:07<08:22,  5.58s/it]generating response:  56%|█████▌    | 111/200 [22:10<06:46,  4.56s/it]generating response:  56%|█████▌    | 112/200 [22:13<06:09,  4.20s/it]generating response:  56%|█████▋    | 113/200 [22:17<06:10,  4.26s/it]generating response:  57%|█████▋    | 114/200 [22:23<06:39,  4.65s/it]generating response:  57%|█████▊    | 115/200 [22:24<05:04,  3.58s/it]generating response:  58%|█████▊    | 116/200 [22:32<06:50,  4.88s/it]generating response:  58%|█████▊    | 117/200 [22:36<06:34,  4.76s/it]generating response:  59%|█████▉    | 118/200 [22:43<07:10,  5.25s/it]generating response:  60%|█████▉    | 119/200 [22:51<08:19,  6.17s/it]generating response:  60%|██████    | 120/200 [23:12<14:15, 10.69s/it]generating response:  60%|██████    | 121/200 [23:42<21:25, 16.27s/it]generating response:  61%|██████    | 122/200 [24:11<26:13, 20.17s/it]generating response:  62%|██████▏   | 123/200 [24:26<23:56, 18.66s/it]generating response:  62%|██████▏   | 124/200 [24:40<21:47, 17.20s/it]generating response:  62%|██████▎   | 125/200 [24:44<16:38, 13.32s/it]generating response:  63%|██████▎   | 126/200 [24:51<14:00, 11.35s/it]generating response:  64%|██████▎   | 127/200 [24:53<10:38,  8.75s/it]generating response:  64%|██████▍   | 128/200 [25:06<11:52,  9.89s/it]generating response:  64%|██████▍   | 129/200 [25:15<11:29,  9.72s/it]generating response:  65%|██████▌   | 130/200 [25:41<16:59, 14.56s/it]generating response:  66%|██████▌   | 131/200 [25:48<13:55, 12.11s/it]generating response:  66%|██████▌   | 132/200 [26:02<14:23, 12.70s/it]generating response:  66%|██████▋   | 133/200 [26:18<15:31, 13.90s/it]generating response:  67%|██████▋   | 134/200 [26:30<14:24, 13.10s/it]generating response:  68%|██████▊   | 135/200 [26:32<10:51, 10.02s/it]generating response:  68%|██████▊   | 136/200 [26:44<11:08, 10.44s/it]generating response:  68%|██████▊   | 137/200 [27:07<15:02, 14.33s/it]generating response:  69%|██████▉   | 138/200 [27:12<11:55, 11.53s/it]generating response:  70%|██████▉   | 139/200 [27:24<11:53, 11.70s/it]generating response:  70%|███████   | 140/200 [27:28<09:08,  9.14s/it]generating response:  70%|███████   | 141/200 [27:57<14:55, 15.18s/it]generating response:  71%|███████   | 142/200 [28:26<18:45, 19.41s/it]generating response:  72%|███████▏  | 143/200 [28:50<19:47, 20.84s/it]generating response:  72%|███████▏  | 144/200 [28:52<13:59, 14.98s/it]generating response:  72%|███████▎  | 145/200 [29:21<17:39, 19.27s/it]generating response:  73%|███████▎  | 146/200 [29:33<15:26, 17.15s/it]generating response:  74%|███████▎  | 147/200 [29:46<13:57, 15.80s/it]generating response:  74%|███████▍  | 148/200 [29:58<12:51, 14.84s/it]generating response:  74%|███████▍  | 149/200 [30:00<09:23, 11.04s/it]generating response:  75%|███████▌  | 150/200 [30:07<07:57,  9.56s/it]generating response:  76%|███████▌  | 151/200 [30:12<06:46,  8.30s/it]generating response:  76%|███████▌  | 152/200 [30:18<06:03,  7.57s/it]generating response:  76%|███████▋  | 153/200 [30:19<04:28,  5.71s/it]generating response:  77%|███████▋  | 154/200 [30:24<04:04,  5.31s/it]generating response:  78%|███████▊  | 155/200 [30:52<09:13, 12.29s/it]generating response:  78%|███████▊  | 156/200 [31:05<09:12, 12.56s/it]generating response:  78%|███████▊  | 157/200 [31:19<09:12, 12.84s/it]generating response:  79%|███████▉  | 158/200 [31:28<08:16, 11.83s/it]generating response:  80%|███████▉  | 159/200 [31:53<10:43, 15.70s/it]generating response:  80%|████████  | 160/200 [31:59<08:30, 12.76s/it]generating response:  80%|████████  | 161/200 [32:03<06:32, 10.06s/it]generating response:  81%|████████  | 162/200 [32:20<07:43, 12.20s/it]generating response:  82%|████████▏ | 163/200 [32:25<06:11, 10.05s/it]generating response:  82%|████████▏ | 164/200 [32:45<07:47, 13.00s/it]generating response:  82%|████████▎ | 165/200 [32:51<06:18, 10.81s/it]generating response:  83%|████████▎ | 166/200 [32:57<05:18,  9.37s/it]generating response:  84%|████████▎ | 167/200 [33:16<06:44, 12.27s/it]generating response:  84%|████████▍ | 168/200 [33:27<06:28, 12.15s/it]generating response:  84%|████████▍ | 169/200 [33:39<06:07, 11.86s/it]generating response:  85%|████████▌ | 170/200 [33:55<06:38, 13.29s/it]generating response:  86%|████████▌ | 171/200 [34:00<05:08, 10.62s/it]generating response:  86%|████████▌ | 172/200 [34:13<05:18, 11.36s/it]generating response:  86%|████████▋ | 173/200 [34:29<05:47, 12.86s/it]generating response:  87%|████████▋ | 174/200 [34:50<06:34, 15.16s/it]generating response:  88%|████████▊ | 175/200 [35:06<06:30, 15.60s/it]generating response:  88%|████████▊ | 176/200 [35:31<07:21, 18.39s/it]generating response:  88%|████████▊ | 177/200 [36:00<08:18, 21.66s/it]generating response:  89%|████████▉ | 178/200 [36:30<08:46, 23.94s/it]generating response:  90%|████████▉ | 179/200 [36:59<08:56, 25.55s/it]generating response:  90%|█████████ | 180/200 [37:28<08:53, 26.66s/it]generating response:  90%|█████████ | 181/200 [37:45<07:30, 23.70s/it]generating response:  91%|█████████ | 182/200 [38:01<06:24, 21.37s/it]generating response:  92%|█████████▏| 183/200 [38:30<06:43, 23.76s/it]generating response:  92%|█████████▏| 184/200 [39:00<06:46, 25.42s/it]generating response:  92%|█████████▎| 185/200 [39:13<05:28, 21.88s/it]generating response:  93%|█████████▎| 186/200 [39:14<03:39, 15.66s/it]generating response:  94%|█████████▎| 187/200 [39:27<03:10, 14.69s/it]generating response:  94%|█████████▍| 188/200 [39:56<03:48, 19.06s/it]generating response:  94%|█████████▍| 189/200 [40:12<03:19, 18.15s/it]generating response:  95%|█████████▌| 190/200 [40:16<02:18, 13.90s/it]generating response:  96%|█████████▌| 191/200 [40:33<02:14, 14.95s/it]generating response:  96%|█████████▌| 192/200 [40:51<02:06, 15.77s/it]generating response:  96%|█████████▋| 193/200 [41:12<02:00, 17.17s/it]generating response:  97%|█████████▋| 194/200 [41:36<01:56, 19.34s/it]generating response:  98%|█████████▊| 195/200 [41:48<01:25, 17.05s/it]generating response:  98%|█████████▊| 196/200 [41:53<00:54, 13.62s/it]generating response:  98%|█████████▊| 197/200 [42:17<00:50, 16.68s/it]generating response:  99%|█████████▉| 198/200 [42:46<00:40, 20.47s/it]generating response: 100%|█████████▉| 199/200 [43:06<00:20, 20.33s/it]generating response: 100%|██████████| 200/200 [43:23<00:00, 19.15s/it]generating response: 100%|██████████| 200/200 [43:23<00:00, 13.02s/it]
generation part takes 2617.10s
Full generation completed in 2617.18s
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/4 [00:00<?, ?it/s]denoise batch:  25%|██▌       | 1/4 [00:24<01:14, 24.82s/it]denoise batch:  50%|█████     | 2/4 [00:49<00:49, 24.78s/it]denoise batch:  75%|███████▌  | 3/4 [01:14<00:24, 24.78s/it]denoise batch: 100%|██████████| 4/4 [01:39<00:00, 24.77s/it]denoise batch: 100%|██████████| 4/4 [01:39<00:00, 24.78s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.59it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.70it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.23it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.92it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
csv file saved at: ./temp_qwen
Done
Defender initialized with threshold=-0.003936767578125
processed 200 images, 200 texts in 195.41s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:04,  2.16it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:01<00:04,  1.63it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:04,  1.66it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:02<00:03,  1.68it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  1.72it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:03<00:02,  1.71it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:04<00:01,  1.70it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:04<00:01,  1.66it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:05<00:00,  1.59it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:05<00:00,  1.64it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:05<00:00,  1.67it/s]
generating response:   0%|          | 0/200 [00:00<?, ?it/s]generating response:   0%|          | 1/200 [00:05<19:30,  5.88s/it]generating response:  20%|██        | 41/200 [00:11<00:38,  4.08it/s]generating response:  34%|███▍      | 69/200 [00:36<01:12,  1.80it/s]generating response:  38%|███▊      | 76/200 [00:41<01:13,  1.69it/s]generating response:  52%|█████▎    | 105/200 [00:46<00:37,  2.53it/s]generating response:  60%|██████    | 120/200 [00:58<00:39,  2.05it/s]generating response:  60%|██████    | 121/200 [01:04<00:50,  1.58it/s]generating response:  69%|██████▉   | 138/200 [01:12<00:35,  1.75it/s]generating response:  74%|███████▍  | 149/200 [01:17<00:27,  1.86it/s]generating response:  79%|███████▉  | 158/200 [01:23<00:24,  1.71it/s]generating response:  96%|█████████▌| 191/200 [01:29<00:03,  2.81it/s]generating response: 100%|██████████| 200/200 [01:29<00:00,  2.24it/s]
generation part takes 112.88s
Full generation completed in 308.37s
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
processed 200 images, 200 texts in 0.11s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:04,  1.89it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:01<00:04,  1.77it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:03,  1.86it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:02<00:03,  1.76it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:03<00:03,  1.53it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:03<00:02,  1.61it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:04<00:01,  1.66it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:04<00:01,  1.67it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:05<00:00,  1.65it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:05<00:00,  1.74it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:05<00:00,  1.70it/s]
generating response:   0%|          | 0/200 [00:00<?, ?it/s]generating response:   0%|          | 1/200 [00:05<18:30,  5.58s/it]generating response:   1%|          | 2/200 [00:11<19:53,  6.03s/it]generating response:   2%|▏         | 3/200 [00:18<20:16,  6.17s/it]generating response:   2%|▏         | 4/200 [00:24<20:40,  6.33s/it]generating response:   2%|▎         | 5/200 [00:28<17:53,  5.51s/it]generating response:   3%|▎         | 6/200 [00:33<16:19,  5.05s/it]generating response:   4%|▎         | 7/200 [00:36<14:13,  4.42s/it]generating response:   4%|▍         | 8/200 [00:39<13:06,  4.10s/it]generating response:   4%|▍         | 9/200 [00:44<13:35,  4.27s/it]generating response:   5%|▌         | 10/200 [00:51<16:05,  5.08s/it]generating response:   6%|▌         | 11/200 [00:56<16:39,  5.29s/it]generating response:   6%|▌         | 12/200 [00:58<12:51,  4.10s/it]generating response:   6%|▋         | 13/200 [01:18<28:14,  9.06s/it]generating response:   7%|▋         | 14/200 [01:32<32:25, 10.46s/it]generating response:   8%|▊         | 15/200 [01:36<26:06,  8.47s/it]generating response:   8%|▊         | 16/200 [01:41<23:09,  7.55s/it]generating response:   8%|▊         | 17/200 [01:48<22:04,  7.24s/it]generating response:   9%|▉         | 18/200 [01:54<21:18,  7.02s/it]generating response:  10%|▉         | 19/200 [02:01<20:41,  6.86s/it]generating response:  10%|█         | 20/200 [02:05<17:53,  5.96s/it]generating response:  10%|█         | 21/200 [02:10<17:15,  5.79s/it]generating response:  11%|█         | 22/200 [02:15<16:35,  5.59s/it]generating response:  12%|█▏        | 23/200 [02:20<16:14,  5.51s/it]generating response:  12%|█▏        | 24/200 [02:27<17:04,  5.82s/it]generating response:  12%|█▎        | 25/200 [02:33<16:46,  5.75s/it]generating response:  13%|█▎        | 26/200 [02:42<19:58,  6.89s/it]generating response:  14%|█▎        | 27/200 [02:46<17:41,  6.13s/it]generating response:  14%|█▍        | 28/200 [02:53<17:56,  6.26s/it]generating response:  14%|█▍        | 29/200 [02:59<17:16,  6.06s/it]generating response:  15%|█▌        | 30/200 [03:03<16:06,  5.69s/it]generating response:  16%|█▌        | 31/200 [03:32<35:41, 12.67s/it]generating response:  16%|█▌        | 32/200 [03:54<42:50, 15.30s/it]generating response:  16%|█▋        | 33/200 [04:21<52:26, 18.84s/it]generating response:  17%|█▋        | 34/200 [04:44<55:45, 20.15s/it]generating response:  18%|█▊        | 35/200 [05:06<56:56, 20.71s/it]generating response:  18%|█▊        | 36/200 [05:27<56:26, 20.65s/it]generating response:  18%|█▊        | 37/200 [05:29<40:53, 15.05s/it]generating response:  19%|█▉        | 38/200 [05:34<32:31, 12.05s/it]generating response:  20%|█▉        | 39/200 [06:03<46:04, 17.17s/it]generating response:  20%|██        | 40/200 [06:26<50:17, 18.86s/it]generating response:  20%|██        | 41/200 [06:37<44:19, 16.72s/it]generating response:  21%|██        | 42/200 [06:41<34:01, 12.92s/it]generating response:  22%|██▏       | 43/200 [06:45<26:40, 10.19s/it]generating response:  22%|██▏       | 44/200 [06:49<21:42,  8.35s/it]generating response:  22%|██▎       | 45/200 [07:08<29:59, 11.61s/it]generating response:  23%|██▎       | 46/200 [07:16<26:43, 10.41s/it]generating response:  24%|██▎       | 47/200 [07:37<34:37, 13.58s/it]generating response:  24%|██▍       | 48/200 [08:05<45:34, 17.99s/it]generating response:  24%|██▍       | 49/200 [08:29<49:37, 19.72s/it]generating response:  25%|██▌       | 50/200 [08:44<45:44, 18.30s/it]generating response:  26%|██▌       | 51/200 [09:00<43:51, 17.66s/it]generating response:  26%|██▌       | 52/200 [09:14<40:52, 16.57s/it]generating response:  26%|██▋       | 53/200 [09:21<33:26, 13.65s/it]generating response:  27%|██▋       | 54/200 [09:34<32:24, 13.32s/it]generating response:  28%|██▊       | 55/200 [09:47<32:22, 13.40s/it]generating response:  28%|██▊       | 56/200 [09:52<25:53, 10.79s/it]generating response:  28%|██▊       | 57/200 [09:58<22:22,  9.39s/it]generating response:  29%|██▉       | 58/200 [10:02<18:39,  7.88s/it]generating response:  30%|██▉       | 59/200 [10:08<16:49,  7.16s/it]generating response:  30%|███       | 60/200 [10:20<19:59,  8.57s/it]generating response:  30%|███       | 61/200 [10:32<22:05,  9.54s/it]generating response:  31%|███       | 62/200 [10:37<19:25,  8.45s/it]generating response:  32%|███▏      | 63/200 [10:41<15:54,  6.96s/it]generating response:  32%|███▏      | 64/200 [10:46<14:12,  6.27s/it]generating response:  32%|███▎      | 65/200 [10:51<13:24,  5.96s/it]generating response:  33%|███▎      | 66/200 [10:55<11:48,  5.29s/it]generating response:  34%|███▎      | 67/200 [10:56<09:07,  4.12s/it]generating response:  34%|███▍      | 68/200 [11:03<11:15,  5.12s/it]generating response:  34%|███▍      | 69/200 [11:30<25:09, 11.52s/it]generating response:  35%|███▌      | 70/200 [11:34<20:10,  9.31s/it]generating response:  36%|███▌      | 71/200 [11:54<26:54, 12.51s/it]generating response:  36%|███▌      | 72/200 [12:00<22:36, 10.60s/it]generating response:  36%|███▋      | 73/200 [12:07<19:44,  9.32s/it]generating response:  37%|███▋      | 74/200 [12:12<17:15,  8.22s/it]generating response:  38%|███▊      | 75/200 [12:17<14:57,  7.18s/it]generating response:  38%|███▊      | 76/200 [12:20<12:03,  5.83s/it]generating response:  38%|███▊      | 77/200 [12:23<10:39,  5.20s/it]generating response:  39%|███▉      | 78/200 [12:30<11:17,  5.56s/it]generating response:  40%|███▉      | 79/200 [12:39<13:24,  6.65s/it]generating response:  40%|████      | 80/200 [12:45<12:51,  6.43s/it]generating response:  40%|████      | 81/200 [12:50<11:58,  6.04s/it]generating response:  41%|████      | 82/200 [12:57<12:26,  6.33s/it]generating response:  42%|████▏     | 83/200 [12:58<09:17,  4.76s/it]generating response:  42%|████▏     | 84/200 [13:04<09:59,  5.17s/it]generating response:  42%|████▎     | 85/200 [13:17<14:04,  7.34s/it]generating response:  43%|████▎     | 86/200 [13:26<15:10,  7.98s/it]generating response:  44%|████▎     | 87/200 [13:34<14:56,  7.94s/it]generating response:  44%|████▍     | 88/200 [13:39<13:29,  7.23s/it]generating response:  44%|████▍     | 89/200 [13:48<13:58,  7.56s/it]generating response:  45%|████▌     | 90/200 [13:54<13:18,  7.26s/it]generating response:  46%|████▌     | 91/200 [14:00<12:07,  6.67s/it]generating response:  46%|████▌     | 92/200 [14:05<11:23,  6.33s/it]generating response:  46%|████▋     | 93/200 [14:10<10:24,  5.84s/it]generating response:  47%|████▋     | 94/200 [14:17<11:13,  6.35s/it]generating response:  48%|████▊     | 95/200 [14:24<11:01,  6.30s/it]generating response:  48%|████▊     | 96/200 [14:29<10:32,  6.08s/it]generating response:  48%|████▊     | 97/200 [14:35<10:14,  5.96s/it]generating response:  49%|████▉     | 98/200 [14:41<10:16,  6.05s/it]generating response:  50%|████▉     | 99/200 [14:50<11:42,  6.96s/it]generating response:  50%|█████     | 100/200 [14:54<10:08,  6.08s/it]generating response:  50%|█████     | 101/200 [14:58<08:56,  5.42s/it]generating response:  51%|█████     | 102/200 [15:01<07:50,  4.80s/it]generating response:  52%|█████▏    | 103/200 [15:06<07:34,  4.68s/it]generating response:  52%|█████▏    | 104/200 [15:08<06:14,  3.91s/it]generating response:  52%|█████▎    | 105/200 [15:14<07:14,  4.57s/it]generating response:  53%|█████▎    | 106/200 [15:19<07:13,  4.61s/it]generating response:  54%|█████▎    | 107/200 [15:23<06:45,  4.36s/it]generating response:  54%|█████▍    | 108/200 [15:27<06:48,  4.44s/it]generating response:  55%|█████▍    | 109/200 [15:33<07:24,  4.88s/it]generating response:  55%|█████▌    | 110/200 [15:39<07:41,  5.12s/it]generating response:  56%|█████▌    | 111/200 [15:43<07:17,  4.91s/it]generating response:  56%|█████▌    | 112/200 [15:47<06:45,  4.60s/it]generating response:  56%|█████▋    | 113/200 [15:51<06:11,  4.27s/it]generating response:  57%|█████▋    | 114/200 [15:57<06:57,  4.86s/it]generating response:  57%|█████▊    | 115/200 [16:03<07:32,  5.32s/it]generating response:  58%|█████▊    | 116/200 [16:07<06:51,  4.90s/it]generating response:  58%|█████▊    | 117/200 [16:14<07:24,  5.35s/it]generating response:  59%|█████▉    | 118/200 [16:20<07:37,  5.58s/it]generating response:  60%|█████▉    | 119/200 [16:24<07:06,  5.27s/it]generating response:  60%|██████    | 120/200 [16:38<10:15,  7.70s/it]generating response:  60%|██████    | 121/200 [16:43<09:10,  6.96s/it]generating response:  61%|██████    | 122/200 [16:55<10:58,  8.45s/it]generating response:  62%|██████▏   | 123/200 [17:03<10:50,  8.44s/it]generating response:  62%|██████▏   | 124/200 [17:09<09:41,  7.65s/it]generating response:  62%|██████▎   | 125/200 [17:15<08:50,  7.07s/it]generating response:  63%|██████▎   | 126/200 [17:23<09:01,  7.32s/it]generating response:  64%|██████▎   | 127/200 [17:26<07:19,  6.03s/it]generating response:  64%|██████▍   | 128/200 [17:31<07:08,  5.96s/it]generating response:  64%|██████▍   | 129/200 [17:34<06:01,  5.09s/it]generating response:  65%|██████▌   | 130/200 [17:38<05:29,  4.71s/it]generating response:  66%|██████▌   | 131/200 [17:43<05:25,  4.72s/it]generating response:  66%|██████▌   | 132/200 [17:49<05:41,  5.03s/it]generating response:  66%|██████▋   | 133/200 [17:53<05:26,  4.88s/it]generating response:  67%|██████▋   | 134/200 [17:59<05:32,  5.04s/it]generating response:  68%|██████▊   | 135/200 [18:04<05:30,  5.09s/it]generating response:  68%|██████▊   | 136/200 [18:08<05:10,  4.86s/it]generating response:  68%|██████▊   | 137/200 [18:13<05:05,  4.84s/it]generating response:  69%|██████▉   | 138/200 [18:18<04:58,  4.82s/it]generating response:  70%|██████▉   | 139/200 [18:23<05:09,  5.08s/it]generating response:  70%|███████   | 140/200 [18:28<05:01,  5.03s/it]generating response:  70%|███████   | 141/200 [18:34<05:11,  5.28s/it]generating response:  71%|███████   | 142/200 [18:41<05:38,  5.83s/it]generating response:  72%|███████▏  | 143/200 [18:48<05:47,  6.10s/it]generating response:  72%|███████▏  | 144/200 [18:53<05:14,  5.61s/it]generating response:  72%|███████▎  | 145/200 [18:58<05:00,  5.46s/it]generating response:  73%|███████▎  | 146/200 [19:01<04:27,  4.95s/it]generating response:  74%|███████▎  | 147/200 [19:05<04:02,  4.57s/it]generating response:  74%|███████▍  | 148/200 [19:08<03:38,  4.20s/it]generating response:  74%|███████▍  | 149/200 [19:13<03:35,  4.22s/it]generating response:  75%|███████▌  | 150/200 [19:28<06:10,  7.41s/it]generating response:  76%|███████▌  | 151/200 [19:33<05:37,  6.89s/it]generating response:  76%|███████▌  | 152/200 [19:37<04:39,  5.82s/it]generating response:  76%|███████▋  | 153/200 [19:43<04:44,  6.05s/it]generating response:  77%|███████▋  | 154/200 [19:49<04:33,  5.94s/it]generating response:  78%|███████▊  | 155/200 [19:52<03:45,  5.01s/it]generating response:  78%|███████▊  | 156/200 [19:57<03:42,  5.06s/it]generating response:  78%|███████▊  | 157/200 [20:04<04:09,  5.79s/it]generating response:  79%|███████▉  | 158/200 [20:10<04:06,  5.88s/it]generating response:  80%|███████▉  | 159/200 [20:17<04:12,  6.15s/it]generating response:  80%|████████  | 160/200 [20:22<03:44,  5.62s/it]generating response:  80%|████████  | 161/200 [20:25<03:16,  5.05s/it]generating response:  81%|████████  | 162/200 [20:31<03:22,  5.34s/it]generating response:  82%|████████▏ | 163/200 [20:37<03:21,  5.44s/it]generating response:  82%|████████▏ | 164/200 [20:42<03:12,  5.34s/it]generating response:  82%|████████▎ | 165/200 [20:46<02:53,  4.97s/it]generating response:  83%|████████▎ | 166/200 [20:51<02:48,  4.97s/it]generating response:  84%|████████▎ | 167/200 [20:57<02:55,  5.32s/it]generating response:  84%|████████▍ | 168/200 [21:07<03:30,  6.56s/it]generating response:  84%|████████▍ | 169/200 [21:13<03:16,  6.33s/it]generating response:  85%|████████▌ | 170/200 [21:19<03:10,  6.33s/it]generating response:  86%|████████▌ | 171/200 [21:29<03:31,  7.31s/it]generating response:  86%|████████▌ | 172/200 [21:32<02:49,  6.07s/it]generating response:  86%|████████▋ | 173/200 [21:37<02:34,  5.71s/it]generating response:  87%|████████▋ | 174/200 [21:43<02:36,  6.03s/it]generating response:  88%|████████▊ | 175/200 [21:48<02:22,  5.70s/it]generating response:  88%|████████▊ | 176/200 [21:55<02:22,  5.96s/it]generating response:  88%|████████▊ | 177/200 [22:00<02:09,  5.63s/it]generating response:  89%|████████▉ | 178/200 [22:07<02:13,  6.07s/it]generating response:  90%|████████▉ | 179/200 [22:12<02:02,  5.81s/it]generating response:  90%|█████████ | 180/200 [22:18<01:56,  5.82s/it]generating response:  90%|█████████ | 181/200 [22:27<02:09,  6.82s/it]generating response:  91%|█████████ | 182/200 [22:52<03:42, 12.38s/it]generating response:  92%|█████████▏| 183/200 [23:00<03:07, 11.03s/it]generating response:  92%|█████████▏| 184/200 [23:07<02:34,  9.63s/it]generating response:  92%|█████████▎| 185/200 [23:14<02:13,  8.87s/it]generating response:  93%|█████████▎| 186/200 [23:19<01:50,  7.87s/it]generating response:  94%|█████████▎| 187/200 [23:26<01:38,  7.54s/it]generating response:  94%|█████████▍| 188/200 [23:55<02:48, 14.01s/it]generating response:  94%|█████████▍| 189/200 [23:59<02:01, 11.07s/it]generating response:  95%|█████████▌| 190/200 [24:06<01:37,  9.73s/it]generating response:  96%|█████████▌| 191/200 [24:10<01:13,  8.17s/it]generating response:  96%|█████████▌| 192/200 [24:15<00:57,  7.16s/it]generating response:  96%|█████████▋| 193/200 [24:21<00:47,  6.82s/it]generating response:  97%|█████████▋| 194/200 [24:46<01:13, 12.30s/it]generating response:  98%|█████████▊| 195/200 [24:50<00:47,  9.58s/it]generating response:  98%|█████████▊| 196/200 [24:58<00:36,  9.09s/it]generating response:  98%|█████████▊| 197/200 [25:02<00:23,  7.69s/it]generating response:  99%|█████████▉| 198/200 [25:10<00:15,  7.80s/it]generating response: 100%|█████████▉| 199/200 [25:17<00:07,  7.43s/it]generating response: 100%|██████████| 200/200 [25:21<00:00,  6.63s/it]generating response: 100%|██████████| 200/200 [25:21<00:00,  7.61s/it]
generation part takes 1540.73s
Full generation completed in 1540.90s
-------llava with defence generation complete-------
-------llava without defence generation complete-------
-------qwen with defence generation complete-------
-------qwen without defence generation complete-------
