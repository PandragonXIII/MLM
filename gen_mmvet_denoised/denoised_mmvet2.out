/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:43<02:54, 43.70s/it]denoise batch:  40%|████      | 2/5 [01:27<02:11, 43.79s/it]denoise batch:  60%|██████    | 3/5 [02:11<01:27, 43.78s/it]denoise batch:  80%|████████  | 4/5 [02:55<00:43, 43.77s/it]denoise batch: 100%|██████████| 5/5 [03:04<00:00, 31.50s/it]denoise batch: 100%|██████████| 5/5 [03:04<00:00, 36.97s/it]
/home/xuyue/.local/lib/python3.10/site-packages/transformers/models/llava/configuration_llava.py:100: FutureWarning: The `vocab_size` argument is deprecated and will be removed in v4.42, since it can be inferred from the `text_config`. Passing this argument has no effect
  warnings.warn(
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.62it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.80it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.33it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.01it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
csv file saved at: ./temp_qwen
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 291.43s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:03,  2.38it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.39it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:02,  2.41it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.25it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.20it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.24it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:03<00:01,  2.12it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:00,  2.01it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:04<00:00,  1.90it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  1.92it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.08it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:02<07:31,  2.08s/it]generating response:   1%|          | 2/218 [00:04<07:38,  2.12s/it]generating response:   1%|▏         | 3/218 [00:05<06:23,  1.79s/it]generating response:   2%|▏         | 4/218 [00:06<05:25,  1.52s/it]generating response:   2%|▏         | 5/218 [00:07<04:48,  1.36s/it]generating response:   3%|▎         | 6/218 [00:08<04:07,  1.17s/it]generating response:   3%|▎         | 7/218 [00:11<05:55,  1.68s/it]generating response:   4%|▎         | 8/218 [00:19<12:42,  3.63s/it]generating response:   4%|▍         | 9/218 [00:20<10:26,  3.00s/it]generating response:   5%|▍         | 10/218 [00:26<13:49,  3.99s/it]generating response:   5%|▌         | 11/218 [00:28<11:08,  3.23s/it]generating response:   6%|▌         | 12/218 [00:30<09:47,  2.85s/it]generating response:   6%|▌         | 13/218 [00:31<08:10,  2.39s/it]generating response:   6%|▋         | 14/218 [00:34<08:57,  2.64s/it]generating response:   7%|▋         | 15/218 [00:39<10:56,  3.23s/it]generating response:   7%|▋         | 16/218 [00:41<09:08,  2.72s/it]generating response:   8%|▊         | 17/218 [00:42<07:46,  2.32s/it]generating response:   8%|▊         | 18/218 [00:43<06:45,  2.03s/it]generating response:   9%|▊         | 19/218 [00:45<06:09,  1.86s/it]generating response:   9%|▉         | 20/218 [00:46<05:50,  1.77s/it]generating response:  10%|▉         | 21/218 [00:50<07:16,  2.21s/it]generating response:  10%|█         | 22/218 [00:51<06:52,  2.10s/it]generating response:  11%|█         | 23/218 [00:53<06:08,  1.89s/it]generating response:  11%|█         | 24/218 [00:54<05:38,  1.74s/it]generating response:  11%|█▏        | 25/218 [00:56<05:19,  1.66s/it]generating response:  12%|█▏        | 26/218 [00:57<04:59,  1.56s/it]generating response:  12%|█▏        | 27/218 [00:58<04:11,  1.32s/it]generating response:  13%|█▎        | 28/218 [00:59<03:56,  1.25s/it]generating response:  13%|█▎        | 29/218 [01:01<04:25,  1.41s/it]generating response:  14%|█▍        | 30/218 [01:02<04:29,  1.43s/it]generating response:  14%|█▍        | 31/218 [01:04<04:33,  1.46s/it]generating response:  15%|█▍        | 32/218 [01:05<04:31,  1.46s/it]generating response:  15%|█▌        | 33/218 [01:07<04:39,  1.51s/it]generating response:  16%|█▌        | 34/218 [01:11<07:25,  2.42s/it]generating response:  16%|█▌        | 35/218 [01:15<08:53,  2.91s/it]generating response:  17%|█▋        | 36/218 [01:17<07:27,  2.46s/it]generating response:  17%|█▋        | 37/218 [01:18<06:36,  2.19s/it]generating response:  17%|█▋        | 38/218 [01:20<05:57,  1.98s/it]generating response:  18%|█▊        | 39/218 [01:21<05:17,  1.77s/it]generating response:  18%|█▊        | 40/218 [01:23<05:37,  1.90s/it]generating response:  19%|█▉        | 41/218 [01:27<07:16,  2.46s/it]generating response:  19%|█▉        | 42/218 [01:29<06:17,  2.14s/it]generating response:  20%|█▉        | 43/218 [01:30<05:58,  2.05s/it]generating response:  20%|██        | 44/218 [01:32<05:59,  2.06s/it]generating response:  21%|██        | 45/218 [01:33<05:05,  1.76s/it]generating response:  21%|██        | 46/218 [01:36<05:29,  1.91s/it]generating response:  22%|██▏       | 47/218 [01:37<04:36,  1.62s/it]generating response:  22%|██▏       | 48/218 [01:38<04:43,  1.67s/it]generating response:  22%|██▏       | 49/218 [01:40<04:11,  1.49s/it]generating response:  23%|██▎       | 50/218 [01:41<04:11,  1.50s/it]generating response:  23%|██▎       | 51/218 [01:42<03:56,  1.42s/it]generating response:  24%|██▍       | 52/218 [01:43<03:43,  1.34s/it]generating response:  24%|██▍       | 53/218 [01:44<03:14,  1.18s/it]generating response:  25%|██▍       | 54/218 [01:45<03:02,  1.12s/it]generating response:  25%|██▌       | 55/218 [01:47<03:15,  1.20s/it]generating response:  26%|██▌       | 56/218 [01:48<03:36,  1.34s/it]generating response:  26%|██▌       | 57/218 [01:51<04:30,  1.68s/it]generating response:  27%|██▋       | 58/218 [01:53<04:43,  1.77s/it]generating response:  27%|██▋       | 59/218 [01:54<04:26,  1.68s/it]generating response:  28%|██▊       | 60/218 [01:56<04:14,  1.61s/it]generating response:  28%|██▊       | 61/218 [01:57<03:57,  1.51s/it]generating response:  28%|██▊       | 62/218 [01:59<04:25,  1.70s/it]generating response:  29%|██▉       | 63/218 [02:00<03:56,  1.53s/it]generating response:  29%|██▉       | 64/218 [02:03<04:31,  1.76s/it]generating response:  30%|██▉       | 65/218 [02:04<04:17,  1.69s/it]generating response:  30%|███       | 66/218 [02:06<04:07,  1.63s/it]generating response:  31%|███       | 67/218 [02:07<04:10,  1.66s/it]generating response:  31%|███       | 68/218 [02:08<03:48,  1.53s/it]generating response:  32%|███▏      | 69/218 [02:10<03:38,  1.47s/it]generating response:  32%|███▏      | 70/218 [02:14<05:52,  2.38s/it]generating response:  33%|███▎      | 71/218 [02:16<05:20,  2.18s/it]generating response:  33%|███▎      | 72/218 [02:17<04:33,  1.88s/it]generating response:  33%|███▎      | 73/218 [02:18<04:03,  1.68s/it]generating response:  34%|███▍      | 74/218 [02:20<03:42,  1.55s/it]generating response:  34%|███▍      | 75/218 [02:23<05:07,  2.15s/it]generating response:  35%|███▍      | 76/218 [02:25<04:35,  1.94s/it]generating response:  35%|███▌      | 77/218 [02:26<04:05,  1.74s/it]generating response:  36%|███▌      | 78/218 [02:28<04:13,  1.81s/it]generating response:  36%|███▌      | 79/218 [02:31<04:56,  2.13s/it]generating response:  37%|███▋      | 80/218 [02:32<04:20,  1.89s/it]generating response:  37%|███▋      | 81/218 [02:33<03:53,  1.71s/it]generating response:  38%|███▊      | 82/218 [02:35<03:45,  1.66s/it]generating response:  38%|███▊      | 83/218 [02:39<05:13,  2.32s/it]generating response:  39%|███▊      | 84/218 [02:43<06:13,  2.78s/it]generating response:  39%|███▉      | 85/218 [02:47<06:53,  3.11s/it]generating response:  39%|███▉      | 86/218 [02:48<05:31,  2.51s/it]generating response:  40%|███▉      | 87/218 [02:49<04:33,  2.09s/it]generating response:  40%|████      | 88/218 [02:51<04:21,  2.01s/it]generating response:  41%|████      | 89/218 [02:52<03:57,  1.84s/it]generating response:  41%|████▏     | 90/218 [02:53<03:34,  1.67s/it]generating response:  42%|████▏     | 91/218 [02:55<03:27,  1.64s/it]generating response:  42%|████▏     | 92/218 [02:58<04:09,  1.98s/it]generating response:  43%|████▎     | 93/218 [03:00<04:35,  2.21s/it]generating response:  43%|████▎     | 94/218 [03:03<04:45,  2.30s/it]generating response:  44%|████▎     | 95/218 [03:04<03:57,  1.93s/it]generating response:  44%|████▍     | 96/218 [03:05<03:35,  1.77s/it]generating response:  44%|████▍     | 97/218 [03:07<03:24,  1.69s/it]generating response:  45%|████▍     | 98/218 [03:09<03:37,  1.82s/it]generating response:  45%|████▌     | 99/218 [03:10<03:09,  1.59s/it]generating response:  46%|████▌     | 100/218 [03:12<03:04,  1.56s/it]generating response:  46%|████▋     | 101/218 [03:12<02:37,  1.34s/it]generating response:  47%|████▋     | 102/218 [03:14<02:35,  1.34s/it]generating response:  47%|████▋     | 103/218 [03:16<02:52,  1.50s/it]generating response:  48%|████▊     | 104/218 [03:18<03:13,  1.70s/it]generating response:  48%|████▊     | 105/218 [03:21<04:20,  2.31s/it]generating response:  49%|████▊     | 106/218 [03:23<04:02,  2.16s/it]generating response:  49%|████▉     | 107/218 [03:25<03:43,  2.01s/it]generating response:  50%|████▉     | 108/218 [03:26<03:13,  1.76s/it]generating response:  50%|█████     | 109/218 [03:27<02:55,  1.61s/it]generating response:  50%|█████     | 110/218 [03:28<02:32,  1.41s/it]generating response:  51%|█████     | 111/218 [03:31<03:01,  1.70s/it]generating response:  51%|█████▏    | 112/218 [03:32<02:48,  1.59s/it]generating response:  52%|█████▏    | 113/218 [03:34<02:59,  1.71s/it]generating response:  52%|█████▏    | 114/218 [03:35<02:38,  1.53s/it]generating response:  53%|█████▎    | 115/218 [03:36<02:31,  1.47s/it]generating response:  53%|█████▎    | 116/218 [03:38<02:42,  1.59s/it]generating response:  54%|█████▎    | 117/218 [03:40<02:29,  1.48s/it]generating response:  54%|█████▍    | 118/218 [03:41<02:13,  1.33s/it]generating response:  55%|█████▍    | 119/218 [03:43<02:47,  1.70s/it]generating response:  55%|█████▌    | 120/218 [03:44<02:29,  1.52s/it]generating response:  56%|█████▌    | 121/218 [03:46<02:24,  1.49s/it]generating response:  56%|█████▌    | 122/218 [03:47<02:24,  1.51s/it]generating response:  56%|█████▋    | 123/218 [03:48<02:17,  1.45s/it]generating response:  57%|█████▋    | 124/218 [03:50<02:12,  1.41s/it]generating response:  57%|█████▋    | 125/218 [03:51<02:09,  1.39s/it]generating response:  58%|█████▊    | 126/218 [03:53<02:07,  1.39s/it]generating response:  58%|█████▊    | 127/218 [03:54<02:07,  1.41s/it]generating response:  59%|█████▊    | 128/218 [03:56<02:10,  1.45s/it]generating response:  59%|█████▉    | 129/218 [03:57<02:04,  1.40s/it]generating response:  60%|█████▉    | 130/218 [03:58<01:59,  1.35s/it]generating response:  60%|██████    | 131/218 [03:59<01:58,  1.37s/it]generating response:  61%|██████    | 132/218 [04:01<01:57,  1.37s/it]generating response:  61%|██████    | 133/218 [04:02<01:50,  1.30s/it]generating response:  61%|██████▏   | 134/218 [04:06<03:08,  2.24s/it]generating response:  62%|██████▏   | 135/218 [04:08<02:47,  2.02s/it]generating response:  62%|██████▏   | 136/218 [04:09<02:32,  1.86s/it]generating response:  63%|██████▎   | 137/218 [04:11<02:17,  1.70s/it]generating response:  63%|██████▎   | 138/218 [04:12<02:17,  1.72s/it]generating response:  64%|██████▍   | 139/218 [04:15<02:26,  1.85s/it]generating response:  64%|██████▍   | 140/218 [04:21<04:16,  3.29s/it]generating response:  65%|██████▍   | 141/218 [04:24<03:59,  3.11s/it]generating response:  65%|██████▌   | 142/218 [04:28<04:23,  3.47s/it]generating response:  66%|██████▌   | 143/218 [04:31<03:59,  3.19s/it]generating response:  66%|██████▌   | 144/218 [04:33<03:23,  2.75s/it]generating response:  67%|██████▋   | 145/218 [04:34<02:57,  2.44s/it]generating response:  67%|██████▋   | 146/218 [04:38<03:20,  2.79s/it]generating response:  67%|██████▋   | 147/218 [04:39<02:50,  2.40s/it]generating response:  68%|██████▊   | 148/218 [04:45<03:58,  3.41s/it]generating response:  68%|██████▊   | 149/218 [04:51<04:53,  4.26s/it]generating response:  69%|██████▉   | 150/218 [05:05<08:10,  7.22s/it]generating response:  69%|██████▉   | 151/218 [05:10<07:18,  6.55s/it]generating response:  70%|██████▉   | 152/218 [05:18<07:37,  6.93s/it]generating response:  70%|███████   | 153/218 [05:25<07:34,  6.99s/it]generating response:  71%|███████   | 154/218 [05:34<07:51,  7.37s/it]generating response:  71%|███████   | 155/218 [05:40<07:28,  7.11s/it]generating response:  72%|███████▏  | 156/218 [05:46<07:01,  6.80s/it]generating response:  72%|███████▏  | 157/218 [05:51<06:13,  6.12s/it]generating response:  72%|███████▏  | 158/218 [05:57<06:05,  6.09s/it]generating response:  73%|███████▎  | 159/218 [06:14<09:08,  9.29s/it]generating response:  73%|███████▎  | 160/218 [06:22<08:48,  9.12s/it]generating response:  74%|███████▍  | 161/218 [06:34<09:25,  9.92s/it]generating response:  74%|███████▍  | 162/218 [06:43<09:01,  9.67s/it]generating response:  75%|███████▍  | 163/218 [06:52<08:45,  9.55s/it]generating response:  75%|███████▌  | 164/218 [07:05<09:23, 10.44s/it]generating response:  76%|███████▌  | 165/218 [07:11<08:08,  9.21s/it]generating response:  76%|███████▌  | 166/218 [07:24<09:00, 10.39s/it]generating response:  77%|███████▋  | 167/218 [07:38<09:43, 11.44s/it]generating response:  77%|███████▋  | 168/218 [07:45<08:22, 10.05s/it]generating response:  78%|███████▊  | 169/218 [07:52<07:29,  9.18s/it]generating response:  78%|███████▊  | 170/218 [07:59<06:47,  8.50s/it]generating response:  78%|███████▊  | 171/218 [08:10<07:12,  9.21s/it]generating response:  79%|███████▉  | 172/218 [08:16<06:19,  8.26s/it]generating response:  79%|███████▉  | 173/218 [08:26<06:37,  8.82s/it]generating response:  80%|███████▉  | 174/218 [08:34<06:13,  8.49s/it]generating response:  80%|████████  | 175/218 [08:42<05:59,  8.35s/it]generating response:  81%|████████  | 176/218 [08:50<05:42,  8.14s/it]generating response:  81%|████████  | 177/218 [08:59<05:46,  8.46s/it]generating response:  82%|████████▏ | 178/218 [09:07<05:34,  8.37s/it]generating response:  82%|████████▏ | 179/218 [09:14<05:09,  7.95s/it]generating response:  83%|████████▎ | 180/218 [09:20<04:45,  7.50s/it]generating response:  83%|████████▎ | 181/218 [09:26<04:12,  6.81s/it]generating response:  83%|████████▎ | 182/218 [09:32<03:59,  6.66s/it]generating response:  84%|████████▍ | 183/218 [09:37<03:35,  6.16s/it]generating response:  84%|████████▍ | 184/218 [09:45<03:50,  6.77s/it]generating response:  85%|████████▍ | 185/218 [09:55<04:12,  7.65s/it]generating response:  85%|████████▌ | 186/218 [10:01<03:48,  7.14s/it]generating response:  86%|████████▌ | 187/218 [10:10<03:56,  7.63s/it]generating response:  86%|████████▌ | 188/218 [10:16<03:35,  7.18s/it]generating response:  87%|████████▋ | 189/218 [10:24<03:39,  7.56s/it]generating response:  87%|████████▋ | 190/218 [10:30<03:21,  7.20s/it]generating response:  88%|████████▊ | 191/218 [10:34<02:47,  6.22s/it]generating response:  88%|████████▊ | 192/218 [10:43<03:01,  6.99s/it]generating response:  89%|████████▊ | 193/218 [10:50<02:53,  6.95s/it]generating response:  89%|████████▉ | 194/218 [10:55<02:30,  6.26s/it]generating response:  89%|████████▉ | 195/218 [11:03<02:34,  6.73s/it]generating response:  90%|████████▉ | 196/218 [11:11<02:41,  7.36s/it]generating response:  90%|█████████ | 197/218 [11:20<02:40,  7.64s/it]generating response:  91%|█████████ | 198/218 [11:28<02:37,  7.86s/it]generating response:  91%|█████████▏| 199/218 [11:30<01:54,  6.02s/it]generating response:  92%|█████████▏| 200/218 [11:34<01:38,  5.49s/it]generating response:  92%|█████████▏| 201/218 [11:35<01:11,  4.21s/it]generating response:  93%|█████████▎| 202/218 [11:39<01:06,  4.15s/it]generating response:  93%|█████████▎| 203/218 [11:45<01:11,  4.75s/it]generating response:  94%|█████████▎| 204/218 [11:49<01:02,  4.45s/it]generating response:  94%|█████████▍| 205/218 [11:57<01:12,  5.54s/it]generating response:  94%|█████████▍| 206/218 [12:02<01:04,  5.34s/it]generating response:  95%|█████████▍| 207/218 [12:07<00:59,  5.37s/it]generating response:  95%|█████████▌| 208/218 [12:11<00:47,  4.71s/it]generating response:  96%|█████████▌| 209/218 [12:26<01:10,  7.84s/it]generating response:  96%|█████████▋| 210/218 [12:36<01:07,  8.49s/it]generating response:  97%|█████████▋| 211/218 [12:47<01:05,  9.41s/it]generating response:  97%|█████████▋| 212/218 [13:05<01:11, 11.96s/it]generating response:  98%|█████████▊| 213/218 [13:17<00:59, 11.94s/it]generating response:  98%|█████████▊| 214/218 [13:44<01:06, 16.53s/it]generating response:  99%|█████████▊| 215/218 [13:57<00:45, 15.30s/it]generating response:  99%|█████████▉| 216/218 [14:07<00:27, 13.76s/it]generating response: 100%|█████████▉| 217/218 [14:16<00:12, 12.26s/it]generating response: 100%|██████████| 218/218 [14:28<00:00, 12.27s/it]generating response: 100%|██████████| 218/218 [14:28<00:00,  3.98s/it]
generation part takes 894.77s
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:43<02:54, 43.70s/it]denoise batch:  40%|████      | 2/5 [01:27<02:11, 44.00s/it]denoise batch:  60%|██████    | 3/5 [02:12<01:28, 44.08s/it]denoise batch:  80%|████████  | 4/5 [02:56<00:44, 44.16s/it]denoise batch: 100%|██████████| 5/5 [03:05<00:00, 31.70s/it]denoise batch: 100%|██████████| 5/5 [03:05<00:00, 37.19s/it]
/home/xuyue/.local/lib/python3.10/site-packages/transformers/models/llava/configuration_llava.py:100: FutureWarning: The `vocab_size` argument is deprecated and will be removed in v4.42, since it can be inferred from the `text_config`. Passing this argument has no effect
  warnings.warn(
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.40it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.57it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.15it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.81it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
csv file saved at: ./temp_qwen
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 1475.96s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:03,  2.47it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.43it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:02,  2.44it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.40it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.38it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.37it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:02<00:01,  2.33it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:00,  2.15it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:04<00:00,  2.04it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.06it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.22it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:01<06:58,  1.93s/it]generating response:   1%|          | 2/218 [00:04<07:23,  2.05s/it]generating response:   1%|▏         | 3/218 [00:05<06:15,  1.75s/it]generating response:   2%|▏         | 4/218 [00:06<05:20,  1.50s/it]generating response:   2%|▏         | 5/218 [00:07<04:45,  1.34s/it]generating response:   3%|▎         | 6/218 [00:08<04:04,  1.15s/it]generating response:   3%|▎         | 7/218 [00:11<05:52,  1.67s/it]generating response:   4%|▎         | 8/218 [00:40<36:28, 10.42s/it]generating response:   4%|▍         | 9/218 [00:41<26:35,  7.64s/it]generating response:   5%|▍         | 10/218 [00:47<24:16,  7.00s/it]generating response:   5%|▌         | 11/218 [00:49<18:38,  5.40s/it]generating response:   6%|▌         | 12/218 [00:51<14:59,  4.36s/it]generating response:   6%|▌         | 13/218 [00:52<11:46,  3.45s/it]generating response:   6%|▋         | 14/218 [00:55<11:27,  3.37s/it]generating response:   7%|▋         | 15/218 [01:00<12:40,  3.74s/it]generating response:   7%|▋         | 16/218 [01:01<10:20,  3.07s/it]generating response:   8%|▊         | 17/218 [01:03<08:36,  2.57s/it]generating response:   8%|▊         | 18/218 [01:04<07:20,  2.20s/it]generating response:   9%|▊         | 19/218 [01:06<06:33,  1.98s/it]generating response:   9%|▉         | 20/218 [01:07<06:06,  1.85s/it]generating response:  10%|▉         | 21/218 [01:10<07:26,  2.27s/it]generating response:  10%|█         | 22/218 [01:12<06:58,  2.14s/it]generating response:  11%|█         | 23/218 [01:14<06:12,  1.91s/it]generating response:  11%|█         | 24/218 [01:15<05:40,  1.76s/it]generating response:  11%|█▏        | 25/218 [01:16<05:12,  1.62s/it]generating response:  12%|█▏        | 26/218 [01:18<04:54,  1.53s/it]generating response:  12%|█▏        | 27/218 [01:18<04:10,  1.31s/it]generating response:  13%|█▎        | 28/218 [01:19<03:56,  1.24s/it]generating response:  13%|█▎        | 29/218 [01:21<04:31,  1.43s/it]generating response:  14%|█▍        | 30/218 [01:23<04:30,  1.44s/it]generating response:  14%|█▍        | 31/218 [01:24<04:33,  1.46s/it]generating response:  15%|█▍        | 32/218 [01:26<04:31,  1.46s/it]generating response:  15%|█▌        | 33/218 [01:27<04:38,  1.51s/it]generating response:  16%|█▌        | 34/218 [01:33<08:34,  2.80s/it]generating response:  16%|█▌        | 35/218 [01:38<10:49,  3.55s/it]generating response:  17%|█▋        | 36/218 [01:40<09:00,  2.97s/it]generating response:  17%|█▋        | 37/218 [01:42<07:41,  2.55s/it]generating response:  17%|█▋        | 38/218 [01:43<06:47,  2.26s/it]generating response:  18%|█▊        | 39/218 [01:45<05:52,  1.97s/it]generating response:  18%|█▊        | 40/218 [01:47<06:01,  2.03s/it]generating response:  19%|█▉        | 41/218 [01:50<07:32,  2.56s/it]generating response:  19%|█▉        | 42/218 [01:52<06:28,  2.21s/it]generating response:  20%|█▉        | 43/218 [01:54<06:06,  2.09s/it]generating response:  20%|██        | 44/218 [01:56<06:04,  2.09s/it]generating response:  21%|██        | 45/218 [01:57<05:08,  1.78s/it]generating response:  21%|██        | 46/218 [02:00<06:35,  2.30s/it]generating response:  22%|██▏       | 47/218 [02:01<05:22,  1.89s/it]generating response:  22%|██▏       | 48/218 [02:03<05:15,  1.85s/it]generating response:  22%|██▏       | 49/218 [02:04<04:34,  1.62s/it]generating response:  23%|██▎       | 50/218 [02:06<04:27,  1.59s/it]generating response:  23%|██▎       | 51/218 [02:07<04:07,  1.48s/it]generating response:  24%|██▍       | 52/218 [02:08<03:50,  1.39s/it]generating response:  24%|██▍       | 53/218 [02:09<03:20,  1.21s/it]generating response:  25%|██▍       | 54/218 [02:10<03:06,  1.14s/it]generating response:  25%|██▌       | 55/218 [02:11<03:17,  1.21s/it]generating response:  26%|██▌       | 56/218 [02:13<03:38,  1.35s/it]generating response:  26%|██▌       | 57/218 [02:15<04:31,  1.69s/it]generating response:  27%|██▋       | 58/218 [02:17<04:44,  1.78s/it]generating response:  27%|██▋       | 59/218 [02:19<04:26,  1.68s/it]generating response:  28%|██▊       | 60/218 [02:20<04:14,  1.61s/it]generating response:  28%|██▊       | 61/218 [02:22<04:22,  1.67s/it]generating response:  28%|██▊       | 62/218 [02:24<04:43,  1.81s/it]generating response:  29%|██▉       | 63/218 [02:25<04:08,  1.60s/it]generating response:  29%|██▉       | 64/218 [02:27<04:01,  1.57s/it]generating response:  30%|██▉       | 65/218 [02:28<03:57,  1.55s/it]generating response:  30%|███       | 66/218 [02:30<03:53,  1.54s/it]generating response:  31%|███       | 67/218 [02:31<03:38,  1.44s/it]generating response:  31%|███       | 68/218 [02:32<03:26,  1.38s/it]generating response:  32%|███▏      | 69/218 [02:34<03:25,  1.38s/it]generating response:  32%|███▏      | 70/218 [02:35<03:22,  1.37s/it]generating response:  33%|███▎      | 71/218 [02:37<03:36,  1.47s/it]generating response:  33%|███▎      | 72/218 [02:38<03:21,  1.38s/it]generating response:  33%|███▎      | 73/218 [02:39<03:20,  1.38s/it]generating response:  34%|███▍      | 74/218 [02:40<03:12,  1.34s/it]generating response:  34%|███▍      | 75/218 [02:42<03:24,  1.43s/it]generating response:  35%|███▍      | 76/218 [02:44<03:23,  1.44s/it]generating response:  35%|███▌      | 77/218 [02:45<03:15,  1.39s/it]generating response:  36%|███▌      | 78/218 [02:47<03:32,  1.52s/it]generating response:  36%|███▌      | 79/218 [02:49<03:44,  1.62s/it]generating response:  37%|███▋      | 80/218 [02:50<03:31,  1.53s/it]generating response:  37%|███▋      | 81/218 [02:51<03:19,  1.45s/it]generating response:  38%|███▊      | 82/218 [02:53<03:21,  1.48s/it]generating response:  38%|███▊      | 83/218 [02:57<04:56,  2.20s/it]generating response:  39%|███▊      | 84/218 [03:00<06:01,  2.69s/it]generating response:  39%|███▉      | 85/218 [03:04<06:44,  3.04s/it]generating response:  39%|███▉      | 86/218 [03:05<05:24,  2.46s/it]generating response:  40%|███▉      | 87/218 [03:06<04:29,  2.06s/it]generating response:  40%|████      | 88/218 [03:08<04:18,  1.99s/it]generating response:  41%|████      | 89/218 [03:10<03:55,  1.82s/it]generating response:  41%|████▏     | 90/218 [03:11<03:32,  1.66s/it]generating response:  42%|████▏     | 91/218 [03:13<03:26,  1.63s/it]generating response:  42%|████▏     | 92/218 [03:15<04:08,  1.97s/it]generating response:  43%|████▎     | 93/218 [03:18<04:34,  2.20s/it]generating response:  43%|████▎     | 94/218 [03:21<04:44,  2.30s/it]generating response:  44%|████▎     | 95/218 [03:22<03:57,  1.93s/it]generating response:  44%|████▍     | 96/218 [03:23<03:35,  1.77s/it]generating response:  44%|████▍     | 97/218 [03:25<03:23,  1.69s/it]generating response:  45%|████▍     | 98/218 [03:27<03:45,  1.88s/it]generating response:  45%|████▌     | 99/218 [03:28<03:14,  1.63s/it]generating response:  46%|████▌     | 100/218 [03:29<03:07,  1.59s/it]generating response:  46%|████▋     | 101/218 [03:30<02:39,  1.37s/it]generating response:  47%|████▋     | 102/218 [03:33<03:16,  1.70s/it]generating response:  47%|████▋     | 103/218 [03:35<03:21,  1.75s/it]generating response:  48%|████▊     | 104/218 [03:37<03:31,  1.85s/it]generating response:  48%|████▊     | 105/218 [03:40<04:32,  2.42s/it]generating response:  49%|████▊     | 106/218 [03:42<04:10,  2.24s/it]generating response:  49%|████▉     | 107/218 [03:44<03:48,  2.06s/it]generating response:  50%|████▉     | 108/218 [03:45<03:23,  1.85s/it]generating response:  50%|█████     | 109/218 [03:46<02:55,  1.61s/it]generating response:  50%|█████     | 110/218 [03:47<02:32,  1.41s/it]generating response:  51%|█████     | 111/218 [03:50<03:05,  1.73s/it]generating response:  51%|█████▏    | 112/218 [03:51<02:54,  1.64s/it]generating response:  52%|█████▏    | 113/218 [03:53<03:02,  1.74s/it]generating response:  52%|█████▏    | 114/218 [03:54<02:43,  1.57s/it]generating response:  53%|█████▎    | 115/218 [03:56<02:33,  1.49s/it]generating response:  53%|█████▎    | 116/218 [03:57<02:43,  1.60s/it]generating response:  54%|█████▎    | 117/218 [03:59<02:53,  1.72s/it]generating response:  54%|█████▍    | 118/218 [04:00<02:30,  1.50s/it]generating response:  55%|█████▍    | 119/218 [04:03<02:59,  1.81s/it]generating response:  55%|█████▌    | 120/218 [04:04<02:36,  1.60s/it]generating response:  56%|█████▌    | 121/218 [04:06<02:29,  1.54s/it]generating response:  56%|█████▌    | 122/218 [04:07<02:28,  1.54s/it]generating response:  56%|█████▋    | 123/218 [04:08<02:20,  1.48s/it]generating response:  57%|█████▋    | 124/218 [04:10<02:11,  1.40s/it]generating response:  57%|█████▋    | 125/218 [04:11<02:08,  1.38s/it]generating response:  58%|█████▊    | 126/218 [04:12<02:06,  1.38s/it]generating response:  58%|█████▊    | 127/218 [04:14<02:07,  1.40s/it]generating response:  59%|█████▊    | 128/218 [04:15<01:56,  1.30s/it]generating response:  59%|█████▉    | 129/218 [04:16<01:54,  1.29s/it]generating response:  60%|█████▉    | 130/218 [04:17<01:52,  1.28s/it]generating response:  60%|██████    | 131/218 [04:19<01:56,  1.34s/it]generating response:  61%|██████    | 132/218 [04:20<01:55,  1.34s/it]generating response:  61%|██████    | 133/218 [04:21<01:49,  1.29s/it]generating response:  61%|██████▏   | 134/218 [04:25<03:00,  2.15s/it]generating response:  62%|██████▏   | 135/218 [04:27<02:41,  1.95s/it]generating response:  62%|██████▏   | 136/218 [04:28<02:28,  1.81s/it]generating response:  63%|██████▎   | 137/218 [04:30<02:14,  1.66s/it]generating response:  63%|██████▎   | 138/218 [04:32<02:20,  1.76s/it]generating response:  64%|██████▍   | 139/218 [04:34<02:22,  1.81s/it]generating response:  64%|██████▍   | 140/218 [04:39<03:54,  3.00s/it]generating response:  65%|██████▍   | 141/218 [04:42<03:46,  2.94s/it]generating response:  65%|██████▌   | 142/218 [04:43<03:00,  2.38s/it]generating response:  66%|██████▌   | 143/218 [04:48<03:39,  2.93s/it]generating response:  66%|██████▌   | 144/218 [04:49<03:08,  2.55s/it]generating response:  67%|██████▋   | 145/218 [04:54<03:55,  3.23s/it]generating response:  67%|██████▋   | 146/218 [04:59<04:21,  3.64s/it]generating response:  67%|██████▋   | 147/218 [05:00<03:33,  3.01s/it]generating response:  68%|██████▊   | 148/218 [05:06<04:23,  3.76s/it]generating response:  68%|██████▊   | 149/218 [05:12<05:10,  4.50s/it]generating response:  69%|██████▉   | 150/218 [05:26<08:20,  7.36s/it]generating response:  69%|██████▉   | 151/218 [05:32<07:38,  6.84s/it]generating response:  70%|██████▉   | 152/218 [05:41<08:28,  7.71s/it]generating response:  70%|███████   | 153/218 [05:48<07:58,  7.36s/it]generating response:  71%|███████   | 154/218 [05:58<08:42,  8.16s/it]generating response:  71%|███████   | 155/218 [06:03<07:40,  7.30s/it]generating response:  72%|███████▏  | 156/218 [06:11<07:41,  7.44s/it]generating response:  72%|███████▏  | 157/218 [06:16<06:46,  6.67s/it]generating response:  72%|███████▏  | 158/218 [06:29<08:31,  8.52s/it]generating response:  73%|███████▎  | 159/218 [06:53<12:55, 13.15s/it]generating response:  73%|███████▎  | 160/218 [06:55<09:31,  9.85s/it]generating response:  74%|███████▍  | 161/218 [07:09<10:42, 11.26s/it]generating response:  74%|███████▍  | 162/218 [07:24<11:32, 12.37s/it]generating response:  75%|███████▍  | 163/218 [07:34<10:32, 11.50s/it]generating response:  75%|███████▌  | 164/218 [07:42<09:26, 10.50s/it]generating response:  76%|███████▌  | 165/218 [07:50<08:33,  9.69s/it]generating response:  76%|███████▌  | 166/218 [07:57<07:39,  8.84s/it]generating response:  77%|███████▋  | 167/218 [08:09<08:24,  9.89s/it]generating response:  77%|███████▋  | 168/218 [08:14<07:05,  8.51s/it]generating response:  78%|███████▊  | 169/218 [08:21<06:38,  8.13s/it]generating response:  78%|███████▊  | 170/218 [08:30<06:33,  8.20s/it]generating response:  78%|███████▊  | 171/218 [08:46<08:13, 10.50s/it]generating response:  79%|███████▉  | 172/218 [08:52<07:02,  9.18s/it]generating response:  79%|███████▉  | 173/218 [08:57<05:57,  7.95s/it]generating response:  80%|███████▉  | 174/218 [09:06<06:02,  8.23s/it]generating response:  80%|████████  | 175/218 [09:12<05:34,  7.79s/it]generating response:  81%|████████  | 176/218 [09:23<05:55,  8.47s/it]generating response:  81%|████████  | 177/218 [09:34<06:26,  9.42s/it]generating response:  82%|████████▏ | 178/218 [09:42<06:02,  9.06s/it]generating response:  82%|████████▏ | 179/218 [09:49<05:22,  8.28s/it]generating response:  83%|████████▎ | 180/218 [09:56<04:55,  7.78s/it]generating response:  83%|████████▎ | 181/218 [10:00<04:16,  6.92s/it]generating response:  83%|████████▎ | 182/218 [10:07<04:01,  6.71s/it]generating response:  84%|████████▍ | 183/218 [10:14<04:05,  7.01s/it]generating response:  84%|████████▍ | 184/218 [10:21<03:58,  7.03s/it]generating response:  85%|████████▍ | 185/218 [10:30<04:05,  7.45s/it]generating response:  85%|████████▌ | 186/218 [10:33<03:19,  6.25s/it]generating response:  86%|████████▌ | 187/218 [10:38<02:57,  5.73s/it]generating response:  86%|████████▌ | 188/218 [10:46<03:14,  6.49s/it]generating response:  87%|████████▋ | 189/218 [10:52<03:05,  6.39s/it]generating response:  87%|████████▋ | 190/218 [10:58<02:52,  6.16s/it]generating response:  88%|████████▊ | 191/218 [11:02<02:27,  5.45s/it]generating response:  88%|████████▊ | 192/218 [11:11<02:53,  6.68s/it]generating response:  89%|████████▊ | 193/218 [11:18<02:48,  6.76s/it]generating response:  89%|████████▉ | 194/218 [11:26<02:51,  7.16s/it]generating response:  89%|████████▉ | 195/218 [11:31<02:30,  6.53s/it]generating response:  90%|████████▉ | 196/218 [11:40<02:35,  7.07s/it]generating response:  90%|█████████ | 197/218 [11:48<02:36,  7.43s/it]generating response:  91%|█████████ | 198/218 [11:56<02:33,  7.65s/it]generating response:  91%|█████████▏| 199/218 [12:01<02:12,  6.95s/it]generating response:  92%|█████████▏| 200/218 [12:08<02:02,  6.82s/it]generating response:  92%|█████████▏| 201/218 [12:17<02:06,  7.43s/it]generating response:  93%|█████████▎| 202/218 [12:22<01:50,  6.93s/it]generating response:  93%|█████████▎| 203/218 [12:27<01:34,  6.33s/it]generating response:  94%|█████████▎| 204/218 [12:31<01:17,  5.56s/it]generating response:  94%|█████████▍| 205/218 [12:40<01:25,  6.55s/it]generating response:  94%|█████████▍| 206/218 [12:47<01:18,  6.52s/it]generating response:  95%|█████████▍| 207/218 [12:52<01:08,  6.19s/it]generating response:  95%|█████████▌| 208/218 [12:55<00:52,  5.29s/it]generating response:  96%|█████████▌| 209/218 [13:04<00:57,  6.37s/it]generating response:  96%|█████████▋| 210/218 [13:13<00:56,  7.05s/it]generating response:  97%|█████████▋| 211/218 [13:25<01:00,  8.63s/it]generating response:  97%|█████████▋| 212/218 [13:34<00:51,  8.64s/it]generating response:  98%|█████████▊| 213/218 [13:47<00:50, 10.13s/it]generating response:  98%|█████████▊| 214/218 [14:14<01:00, 15.20s/it]generating response:  99%|█████████▊| 215/218 [14:28<00:44, 14.75s/it]generating response:  99%|█████████▉| 216/218 [14:36<00:25, 12.63s/it]generating response: 100%|█████████▉| 217/218 [14:44<00:11, 11.47s/it]generating response: 100%|██████████| 218/218 [15:01<00:00, 13.07s/it]generating response: 100%|██████████| 218/218 [15:01<00:00,  4.14s/it]
generation part takes 914.76s
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:43<02:55, 43.76s/it]denoise batch:  40%|████      | 2/5 [01:27<02:12, 44.00s/it]denoise batch:  60%|██████    | 3/5 [02:12<01:28, 44.09s/it]denoise batch:  80%|████████  | 4/5 [02:56<00:44, 44.14s/it]denoise batch: 100%|██████████| 5/5 [03:05<00:00, 31.68s/it]denoise batch: 100%|██████████| 5/5 [03:05<00:00, 37.19s/it]
/home/xuyue/.local/lib/python3.10/site-packages/transformers/models/llava/configuration_llava.py:100: FutureWarning: The `vocab_size` argument is deprecated and will be removed in v4.42, since it can be inferred from the `text_config`. Passing this argument has no effect
  warnings.warn(
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.48it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.31it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.95it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.64it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
csv file saved at: ./temp_qwen
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 2680.44s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:03,  2.45it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.40it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:02,  2.39it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.35it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.34it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.33it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:02<00:01,  2.34it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:00,  2.21it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:04<00:00,  2.06it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.08it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.22it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:01<06:59,  1.93s/it]generating response:   1%|          | 2/218 [00:04<07:24,  2.06s/it]generating response:   1%|▏         | 3/218 [00:05<06:15,  1.75s/it]generating response:   2%|▏         | 4/218 [00:06<05:20,  1.50s/it]generating response:   2%|▏         | 5/218 [00:07<04:45,  1.34s/it]generating response:   3%|▎         | 6/218 [00:08<04:04,  1.15s/it]generating response:   3%|▎         | 7/218 [00:11<05:53,  1.67s/it]generating response:   4%|▎         | 8/218 [00:16<09:55,  2.83s/it]generating response:   4%|▍         | 9/218 [00:17<08:25,  2.42s/it]generating response:   5%|▍         | 10/218 [00:23<11:15,  3.25s/it]generating response:   5%|▌         | 11/218 [00:24<09:35,  2.78s/it]generating response:   6%|▌         | 12/218 [00:27<09:41,  2.82s/it]generating response:   6%|▌         | 13/218 [00:29<08:31,  2.49s/it]generating response:   6%|▋         | 14/218 [00:32<09:14,  2.72s/it]generating response:   7%|▋         | 15/218 [00:37<11:21,  3.35s/it]generating response:   7%|▋         | 16/218 [00:39<09:25,  2.80s/it]generating response:   8%|▊         | 17/218 [00:40<07:58,  2.38s/it]generating response:   8%|▊         | 18/218 [00:41<06:54,  2.07s/it]generating response:   9%|▊         | 19/218 [00:43<06:19,  1.91s/it]generating response:   9%|▉         | 20/218 [00:44<05:59,  1.81s/it]generating response:  10%|▉         | 21/218 [00:48<07:23,  2.25s/it]generating response:  10%|█         | 22/218 [00:49<06:48,  2.08s/it]generating response:  11%|█         | 23/218 [00:51<06:06,  1.88s/it]generating response:  11%|█         | 24/218 [00:52<05:30,  1.70s/it]generating response:  11%|█▏        | 25/218 [00:53<05:08,  1.60s/it]generating response:  12%|█▏        | 26/218 [00:54<04:29,  1.40s/it]generating response:  12%|█▏        | 27/218 [00:55<03:54,  1.23s/it]generating response:  13%|█▎        | 28/218 [00:56<03:45,  1.19s/it]generating response:  13%|█▎        | 29/218 [00:58<04:18,  1.37s/it]generating response:  14%|█▍        | 30/218 [01:00<04:25,  1.41s/it]generating response:  14%|█▍        | 31/218 [01:01<04:34,  1.47s/it]generating response:  15%|█▍        | 32/218 [01:03<04:32,  1.47s/it]generating response:  15%|█▌        | 33/218 [01:04<04:40,  1.52s/it]generating response:  16%|█▌        | 34/218 [01:07<05:55,  1.93s/it]generating response:  16%|█▌        | 35/218 [01:13<09:11,  3.02s/it]generating response:  17%|█▋        | 36/218 [01:14<07:37,  2.51s/it]generating response:  17%|█▋        | 37/218 [01:16<06:44,  2.23s/it]generating response:  17%|█▋        | 38/218 [01:17<06:15,  2.09s/it]generating response:  18%|█▊        | 39/218 [01:19<05:31,  1.85s/it]generating response:  18%|█▊        | 40/218 [01:21<05:48,  1.96s/it]generating response:  19%|█▉        | 41/218 [01:25<07:26,  2.52s/it]generating response:  19%|█▉        | 42/218 [01:26<06:24,  2.19s/it]generating response:  20%|█▉        | 43/218 [01:28<06:07,  2.10s/it]generating response:  20%|██        | 44/218 [01:30<06:12,  2.14s/it]generating response:  21%|██        | 45/218 [01:31<05:02,  1.75s/it]generating response:  21%|██        | 46/218 [01:32<04:12,  1.47s/it]generating response:  22%|██▏       | 47/218 [01:33<03:42,  1.30s/it]generating response:  22%|██▏       | 48/218 [01:35<04:06,  1.45s/it]generating response:  22%|██▏       | 49/218 [01:36<03:46,  1.34s/it]generating response:  23%|██▎       | 50/218 [01:37<03:54,  1.39s/it]generating response:  23%|██▎       | 51/218 [01:39<03:44,  1.34s/it]generating response:  24%|██▍       | 52/218 [01:40<03:34,  1.29s/it]generating response:  24%|██▍       | 53/218 [01:40<03:08,  1.14s/it]generating response:  25%|██▍       | 54/218 [01:41<02:58,  1.09s/it]generating response:  25%|██▌       | 55/218 [01:43<03:12,  1.18s/it]generating response:  26%|██▌       | 56/218 [01:44<03:34,  1.32s/it]generating response:  26%|██▌       | 57/218 [01:46<04:00,  1.49s/it]generating response:  27%|██▋       | 58/218 [01:48<04:22,  1.64s/it]generating response:  27%|██▋       | 59/218 [01:50<04:11,  1.58s/it]generating response:  28%|██▊       | 60/218 [01:51<04:03,  1.54s/it]generating response:  28%|██▊       | 61/218 [01:53<04:10,  1.60s/it]generating response:  28%|██▊       | 62/218 [01:55<04:34,  1.76s/it]generating response:  29%|██▉       | 63/218 [01:57<04:17,  1.66s/it]generating response:  29%|██▉       | 64/218 [01:59<05:13,  2.04s/it]generating response:  30%|██▉       | 65/218 [02:01<04:47,  1.88s/it]generating response:  30%|███       | 66/218 [02:02<04:26,  1.75s/it]generating response:  31%|███       | 67/218 [02:04<04:00,  1.59s/it]generating response:  31%|███       | 68/218 [02:05<03:42,  1.48s/it]generating response:  32%|███▏      | 69/218 [02:07<03:55,  1.58s/it]generating response:  32%|███▏      | 70/218 [02:10<04:58,  2.02s/it]generating response:  33%|███▎      | 71/218 [02:11<04:43,  1.93s/it]generating response:  33%|███▎      | 72/218 [02:13<04:07,  1.70s/it]generating response:  33%|███▎      | 73/218 [02:14<03:52,  1.60s/it]generating response:  34%|███▍      | 74/218 [02:15<03:34,  1.49s/it]generating response:  34%|███▍      | 75/218 [02:20<05:48,  2.44s/it]generating response:  35%|███▍      | 76/218 [02:21<05:03,  2.14s/it]generating response:  35%|███▌      | 77/218 [02:23<04:25,  1.88s/it]generating response:  36%|███▌      | 78/218 [02:24<04:23,  1.88s/it]generating response:  36%|███▌      | 79/218 [02:26<04:23,  1.89s/it]generating response:  37%|███▋      | 80/218 [02:28<04:00,  1.74s/it]generating response:  37%|███▋      | 81/218 [02:29<03:39,  1.60s/it]generating response:  38%|███▊      | 82/218 [02:31<03:51,  1.70s/it]generating response:  38%|███▊      | 83/218 [02:35<05:17,  2.35s/it]generating response:  39%|███▊      | 84/218 [02:39<06:18,  2.83s/it]generating response:  39%|███▉      | 85/218 [02:42<06:35,  2.97s/it]generating response:  39%|███▉      | 86/218 [02:43<05:19,  2.42s/it]generating response:  40%|███▉      | 87/218 [02:44<04:25,  2.03s/it]generating response:  40%|████      | 88/218 [02:46<04:17,  1.98s/it]generating response:  41%|████      | 89/218 [02:48<03:52,  1.80s/it]generating response:  41%|████▏     | 90/218 [02:49<03:30,  1.65s/it]generating response:  42%|████▏     | 91/218 [02:51<03:31,  1.67s/it]generating response:  42%|████▏     | 92/218 [02:53<04:15,  2.03s/it]generating response:  43%|████▎     | 93/218 [02:56<04:42,  2.26s/it]generating response:  43%|████▎     | 94/218 [02:59<04:52,  2.36s/it]generating response:  44%|████▎     | 95/218 [03:00<04:02,  1.97s/it]generating response:  44%|████▍     | 96/218 [03:01<03:40,  1.81s/it]generating response:  44%|████▍     | 97/218 [03:03<03:28,  1.72s/it]generating response:  45%|████▍     | 98/218 [03:05<03:42,  1.85s/it]generating response:  45%|████▌     | 99/218 [03:06<03:12,  1.62s/it]generating response:  46%|████▌     | 100/218 [03:07<02:59,  1.52s/it]generating response:  46%|████▋     | 101/218 [03:08<02:34,  1.32s/it]generating response:  47%|████▋     | 102/218 [03:10<02:50,  1.47s/it]generating response:  47%|████▋     | 103/218 [03:12<03:04,  1.60s/it]generating response:  48%|████▊     | 104/218 [03:14<03:21,  1.77s/it]generating response:  48%|████▊     | 105/218 [03:18<04:29,  2.38s/it]generating response:  49%|████▊     | 106/218 [03:20<04:09,  2.22s/it]generating response:  49%|████▉     | 107/218 [03:21<03:43,  2.01s/it]generating response:  50%|████▉     | 108/218 [03:23<03:21,  1.83s/it]generating response:  50%|█████     | 109/218 [03:24<03:07,  1.72s/it]generating response:  50%|█████     | 110/218 [03:25<02:41,  1.49s/it]generating response:  51%|█████     | 111/218 [03:28<03:15,  1.82s/it]generating response:  51%|█████▏    | 112/218 [03:29<03:02,  1.72s/it]generating response:  52%|█████▏    | 113/218 [03:31<03:04,  1.76s/it]generating response:  52%|█████▏    | 114/218 [03:32<02:44,  1.59s/it]generating response:  53%|█████▎    | 115/218 [03:34<02:35,  1.51s/it]generating response:  53%|█████▎    | 116/218 [03:36<02:51,  1.68s/it]generating response:  54%|█████▎    | 117/218 [03:37<02:29,  1.48s/it]generating response:  54%|█████▍    | 118/218 [03:38<02:14,  1.34s/it]generating response:  55%|█████▍    | 119/218 [03:40<02:49,  1.71s/it]generating response:  55%|█████▌    | 120/218 [03:41<02:30,  1.54s/it]generating response:  56%|█████▌    | 121/218 [03:43<02:26,  1.51s/it]generating response:  56%|█████▌    | 122/218 [03:44<02:27,  1.53s/it]generating response:  56%|█████▋    | 123/218 [03:46<02:21,  1.49s/it]generating response:  57%|█████▋    | 124/218 [03:47<02:15,  1.45s/it]generating response:  57%|█████▋    | 125/218 [03:49<02:13,  1.44s/it]generating response:  58%|█████▊    | 126/218 [03:50<02:11,  1.43s/it]generating response:  58%|█████▊    | 127/218 [03:51<02:11,  1.44s/it]generating response:  59%|█████▊    | 128/218 [03:53<01:59,  1.33s/it]generating response:  59%|█████▉    | 129/218 [03:54<01:57,  1.32s/it]generating response:  60%|█████▉    | 130/218 [03:55<01:55,  1.31s/it]generating response:  60%|██████    | 131/218 [03:57<01:57,  1.35s/it]generating response:  61%|██████    | 132/218 [03:58<01:57,  1.36s/it]generating response:  61%|██████    | 133/218 [03:59<01:51,  1.31s/it]generating response:  61%|██████▏   | 134/218 [04:03<02:59,  2.14s/it]generating response:  62%|██████▏   | 135/218 [04:05<02:42,  1.96s/it]generating response:  62%|██████▏   | 136/218 [04:06<02:29,  1.83s/it]generating response:  63%|██████▎   | 137/218 [04:08<02:17,  1.70s/it]generating response:  63%|██████▎   | 138/218 [04:10<02:23,  1.80s/it]generating response:  64%|██████▍   | 139/218 [04:12<02:31,  1.92s/it]generating response:  64%|██████▍   | 140/218 [04:16<03:27,  2.66s/it]generating response:  65%|██████▍   | 141/218 [04:22<04:23,  3.42s/it]generating response:  65%|██████▌   | 142/218 [04:27<05:03,  3.99s/it]generating response:  66%|██████▌   | 143/218 [04:29<04:12,  3.37s/it]generating response:  66%|██████▌   | 144/218 [04:31<03:37,  2.94s/it]generating response:  67%|██████▋   | 145/218 [04:32<03:08,  2.58s/it]generating response:  67%|██████▋   | 146/218 [04:37<03:39,  3.05s/it]generating response:  67%|██████▋   | 147/218 [04:40<03:47,  3.21s/it]generating response:  68%|██████▊   | 148/218 [04:48<05:25,  4.65s/it]generating response:  68%|██████▊   | 149/218 [04:55<05:56,  5.17s/it]generating response:  69%|██████▉   | 150/218 [05:06<08:06,  7.16s/it]generating response:  69%|██████▉   | 151/218 [05:14<08:17,  7.42s/it]generating response:  70%|██████▉   | 152/218 [05:24<09:02,  8.22s/it]generating response:  70%|███████   | 153/218 [05:33<08:53,  8.21s/it]generating response:  71%|███████   | 154/218 [05:37<07:30,  7.04s/it]generating response:  71%|███████   | 155/218 [05:43<07:06,  6.77s/it]generating response:  72%|███████▏  | 156/218 [05:55<08:32,  8.27s/it]generating response:  72%|███████▏  | 157/218 [06:00<07:33,  7.43s/it]generating response:  72%|███████▏  | 158/218 [06:13<08:53,  8.90s/it]generating response:  73%|███████▎  | 159/218 [06:36<12:56, 13.15s/it]generating response:  73%|███████▎  | 160/218 [06:43<10:55, 11.31s/it]generating response:  74%|███████▍  | 161/218 [06:53<10:23, 10.95s/it]generating response:  74%|███████▍  | 162/218 [06:58<08:39,  9.28s/it]generating response:  75%|███████▍  | 163/218 [07:09<08:58,  9.80s/it]generating response:  75%|███████▌  | 164/218 [07:37<13:47, 15.32s/it]generating response:  76%|███████▌  | 165/218 [07:40<10:12, 11.56s/it]generating response:  76%|███████▌  | 166/218 [07:51<09:55, 11.45s/it]generating response:  77%|███████▋  | 167/218 [08:06<10:26, 12.29s/it]generating response:  77%|███████▋  | 168/218 [08:13<09:04, 10.89s/it]generating response:  78%|███████▊  | 169/218 [08:21<08:07,  9.96s/it]generating response:  78%|███████▊  | 170/218 [08:27<06:55,  8.66s/it]generating response:  78%|███████▊  | 171/218 [08:39<07:45,  9.89s/it]generating response:  79%|███████▉  | 172/218 [08:45<06:30,  8.50s/it]generating response:  79%|███████▉  | 173/218 [08:51<05:48,  7.74s/it]generating response:  80%|███████▉  | 174/218 [09:01<06:10,  8.43s/it]generating response:  80%|████████  | 175/218 [09:06<05:20,  7.45s/it]generating response:  81%|████████  | 176/218 [09:12<04:59,  7.14s/it]generating response:  81%|████████  | 177/218 [09:21<05:08,  7.53s/it]generating response:  82%|████████▏ | 178/218 [09:26<04:30,  6.75s/it]generating response:  82%|████████▏ | 179/218 [09:33<04:28,  6.89s/it]generating response:  83%|████████▎ | 180/218 [09:40<04:20,  6.86s/it]generating response:  83%|████████▎ | 181/218 [09:44<03:42,  6.01s/it]generating response:  83%|████████▎ | 182/218 [09:50<03:42,  6.18s/it]generating response:  84%|████████▍ | 183/218 [09:56<03:31,  6.05s/it]generating response:  84%|████████▍ | 184/218 [10:03<03:39,  6.45s/it]generating response:  85%|████████▍ | 185/218 [10:16<04:29,  8.18s/it]generating response:  85%|████████▌ | 186/218 [10:21<03:50,  7.19s/it]generating response:  86%|████████▌ | 187/218 [10:24<03:09,  6.11s/it]generating response:  86%|████████▌ | 188/218 [10:31<03:10,  6.34s/it]generating response:  87%|████████▋ | 189/218 [10:33<02:22,  4.90s/it]generating response:  87%|████████▋ | 190/218 [10:39<02:28,  5.31s/it]generating response:  88%|████████▊ | 191/218 [10:44<02:25,  5.39s/it]generating response:  88%|████████▊ | 192/218 [10:51<02:32,  5.86s/it]generating response:  89%|████████▊ | 193/218 [10:58<02:35,  6.24s/it]generating response:  89%|████████▉ | 194/218 [11:12<03:23,  8.48s/it]generating response:  89%|████████▉ | 195/218 [11:18<02:57,  7.72s/it]generating response:  90%|████████▉ | 196/218 [11:28<03:05,  8.44s/it]generating response:  90%|█████████ | 197/218 [11:38<03:07,  8.92s/it]generating response:  91%|█████████ | 198/218 [11:47<02:56,  8.81s/it]generating response:  91%|█████████▏| 199/218 [11:56<02:48,  8.86s/it]generating response:  92%|█████████▏| 200/218 [12:00<02:16,  7.60s/it]generating response:  92%|█████████▏| 201/218 [12:08<02:10,  7.69s/it]generating response:  93%|█████████▎| 202/218 [12:12<01:45,  6.61s/it]generating response:  93%|█████████▎| 203/218 [12:19<01:38,  6.54s/it]generating response:  94%|█████████▎| 204/218 [12:23<01:20,  5.73s/it]generating response:  94%|█████████▍| 205/218 [12:32<01:27,  6.71s/it]generating response:  94%|█████████▍| 206/218 [12:36<01:13,  6.14s/it]generating response:  95%|█████████▍| 207/218 [12:43<01:07,  6.16s/it]generating response:  95%|█████████▌| 208/218 [12:46<00:53,  5.31s/it]generating response:  96%|█████████▌| 209/218 [12:53<00:51,  5.71s/it]generating response:  96%|█████████▋| 210/218 [13:01<00:53,  6.65s/it]generating response:  97%|█████████▋| 211/218 [13:14<00:58,  8.42s/it]generating response:  97%|█████████▋| 212/218 [13:31<01:05, 10.97s/it]generating response:  98%|█████████▊| 213/218 [13:45<00:59, 11.85s/it]generating response:  98%|█████████▊| 214/218 [13:53<00:43, 10.88s/it]generating response:  99%|█████████▊| 215/218 [14:16<00:43, 14.50s/it]generating response:  99%|█████████▉| 216/218 [14:26<00:26, 13.00s/it]generating response: 100%|█████████▉| 217/218 [14:35<00:11, 11.78s/it]generating response: 100%|██████████| 218/218 [14:44<00:00, 11.06s/it]generating response: 100%|██████████| 218/218 [14:44<00:00,  4.06s/it]
generation part takes 897.75s
Full generation completed in 3578.27s
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
processed 218 images, 218 texts in 0.07s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:04,  1.99it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.21it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:03,  2.33it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.36it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.31it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.17it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:03<00:01,  2.09it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:00,  2.01it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:04<00:00,  1.95it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.02it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:04<00:00,  2.10it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:03<12:07,  3.35s/it]generating response:   1%|          | 2/218 [00:05<08:35,  2.39s/it]generating response:   1%|▏         | 3/218 [00:06<07:29,  2.09s/it]generating response:   2%|▏         | 4/218 [00:07<06:04,  1.70s/it]generating response:   2%|▏         | 5/218 [00:08<05:12,  1.47s/it]generating response:   3%|▎         | 6/218 [00:09<04:21,  1.24s/it]generating response:   3%|▎         | 7/218 [00:12<05:37,  1.60s/it]generating response:   4%|▎         | 8/218 [00:15<07:36,  2.18s/it]generating response:   4%|▍         | 9/218 [00:17<06:51,  1.97s/it]generating response:   5%|▍         | 10/218 [00:26<14:27,  4.17s/it]generating response:   5%|▌         | 11/218 [00:27<11:33,  3.35s/it]generating response:   6%|▌         | 12/218 [00:29<10:18,  3.00s/it]generating response:   6%|▌         | 13/218 [00:31<08:51,  2.59s/it]generating response:   6%|▋         | 14/218 [00:34<09:42,  2.85s/it]generating response:   7%|▋         | 15/218 [00:39<11:26,  3.38s/it]generating response:   7%|▋         | 16/218 [00:41<09:28,  2.82s/it]generating response:   8%|▊         | 17/218 [00:42<08:00,  2.39s/it]generating response:   8%|▊         | 18/218 [00:43<06:54,  2.07s/it]generating response:   9%|▊         | 19/218 [00:45<06:15,  1.89s/it]generating response:   9%|▉         | 20/218 [00:46<05:53,  1.79s/it]generating response:  10%|▉         | 21/218 [00:50<07:17,  2.22s/it]generating response:  10%|█         | 22/218 [00:51<06:52,  2.10s/it]generating response:  11%|█         | 23/218 [00:53<06:29,  2.00s/it]generating response:  11%|█         | 24/218 [00:54<05:43,  1.77s/it]generating response:  11%|█▏        | 25/218 [00:56<05:16,  1.64s/it]generating response:  12%|█▏        | 26/218 [00:57<04:29,  1.40s/it]generating response:  12%|█▏        | 27/218 [00:57<03:50,  1.21s/it]generating response:  13%|█▎        | 28/218 [00:58<03:42,  1.17s/it]generating response:  13%|█▎        | 29/218 [01:00<04:22,  1.39s/it]generating response:  14%|█▍        | 30/218 [01:02<04:27,  1.42s/it]generating response:  14%|█▍        | 31/218 [01:03<04:31,  1.45s/it]generating response:  15%|█▍        | 32/218 [01:05<04:29,  1.45s/it]generating response:  15%|█▌        | 33/218 [01:06<04:37,  1.50s/it]generating response:  16%|█▌        | 34/218 [01:09<05:51,  1.91s/it]generating response:  16%|█▌        | 35/218 [01:15<09:38,  3.16s/it]generating response:  17%|█▋        | 36/218 [01:18<09:07,  3.01s/it]generating response:  17%|█▋        | 37/218 [01:19<07:45,  2.57s/it]generating response:  17%|█▋        | 38/218 [01:23<08:24,  2.81s/it]generating response:  18%|█▊        | 39/218 [01:24<07:00,  2.35s/it]generating response:  18%|█▊        | 40/218 [01:26<06:37,  2.23s/it]generating response:  19%|█▉        | 41/218 [01:30<07:57,  2.70s/it]generating response:  19%|█▉        | 42/218 [01:31<06:45,  2.31s/it]generating response:  20%|█▉        | 43/218 [01:33<06:18,  2.16s/it]generating response:  20%|██        | 44/218 [01:35<06:12,  2.14s/it]generating response:  21%|██        | 45/218 [01:36<05:01,  1.74s/it]generating response:  21%|██        | 46/218 [01:37<04:14,  1.48s/it]generating response:  22%|██▏       | 47/218 [01:38<03:43,  1.31s/it]generating response:  22%|██▏       | 48/218 [01:39<04:01,  1.42s/it]generating response:  22%|██▏       | 49/218 [01:41<03:43,  1.32s/it]generating response:  23%|██▎       | 50/218 [01:42<03:52,  1.38s/it]generating response:  23%|██▎       | 51/218 [01:43<03:43,  1.34s/it]generating response:  24%|██▍       | 52/218 [01:44<03:33,  1.29s/it]generating response:  24%|██▍       | 53/218 [01:45<03:08,  1.14s/it]generating response:  25%|██▍       | 54/218 [01:46<02:58,  1.09s/it]generating response:  25%|██▌       | 55/218 [01:48<03:12,  1.18s/it]generating response:  26%|██▌       | 56/218 [01:50<04:03,  1.50s/it]generating response:  26%|██▌       | 57/218 [01:52<04:49,  1.80s/it]generating response:  27%|██▋       | 58/218 [01:54<04:56,  1.85s/it]generating response:  27%|██▋       | 59/218 [01:56<04:35,  1.73s/it]generating response:  28%|██▊       | 60/218 [01:57<04:12,  1.60s/it]generating response:  28%|██▊       | 61/218 [01:59<04:16,  1.63s/it]generating response:  28%|██▊       | 62/218 [02:01<04:39,  1.79s/it]generating response:  29%|██▉       | 63/218 [02:03<04:36,  1.78s/it]generating response:  29%|██▉       | 64/218 [02:04<04:08,  1.62s/it]generating response:  30%|██▉       | 65/218 [02:05<04:02,  1.58s/it]generating response:  30%|███       | 66/218 [02:07<03:54,  1.54s/it]generating response:  31%|███       | 67/218 [02:08<03:53,  1.55s/it]generating response:  31%|███       | 68/218 [02:10<03:37,  1.45s/it]generating response:  32%|███▏      | 69/218 [02:11<03:50,  1.54s/it]generating response:  32%|███▏      | 70/218 [02:16<06:21,  2.58s/it]generating response:  33%|███▎      | 71/218 [02:18<05:40,  2.32s/it]generating response:  33%|███▎      | 72/218 [02:19<04:48,  1.97s/it]generating response:  33%|███▎      | 73/218 [02:20<04:06,  1.70s/it]generating response:  34%|███▍      | 74/218 [02:22<03:44,  1.56s/it]generating response:  34%|███▍      | 75/218 [02:23<03:46,  1.59s/it]generating response:  35%|███▍      | 76/218 [02:25<03:39,  1.54s/it]generating response:  35%|███▌      | 77/218 [02:26<03:26,  1.46s/it]generating response:  36%|███▌      | 78/218 [02:28<03:40,  1.57s/it]generating response:  36%|███▌      | 79/218 [02:31<04:37,  1.99s/it]generating response:  37%|███▋      | 80/218 [02:32<04:07,  1.80s/it]generating response:  37%|███▋      | 81/218 [02:33<03:44,  1.64s/it]generating response:  38%|███▊      | 82/218 [02:35<03:39,  1.61s/it]generating response:  38%|███▊      | 83/218 [02:39<05:08,  2.29s/it]generating response:  39%|███▊      | 84/218 [02:43<06:09,  2.76s/it]generating response:  39%|███▉      | 85/218 [02:46<06:50,  3.09s/it]generating response:  39%|███▉      | 86/218 [02:48<05:29,  2.50s/it]generating response:  40%|███▉      | 87/218 [02:49<04:33,  2.09s/it]generating response:  40%|████      | 88/218 [02:51<04:21,  2.01s/it]generating response:  41%|████      | 89/218 [02:52<03:40,  1.71s/it]generating response:  41%|████▏     | 90/218 [02:53<03:22,  1.58s/it]generating response:  42%|████▏     | 91/218 [02:54<03:19,  1.57s/it]generating response:  42%|████▏     | 92/218 [02:57<03:42,  1.77s/it]generating response:  43%|████▎     | 93/218 [02:59<04:16,  2.06s/it]generating response:  43%|████▎     | 94/218 [03:02<04:32,  2.20s/it]generating response:  44%|████▎     | 95/218 [03:03<03:48,  1.86s/it]generating response:  44%|████▍     | 96/218 [03:04<03:29,  1.72s/it]generating response:  44%|████▍     | 97/218 [03:06<03:19,  1.65s/it]generating response:  45%|████▍     | 98/218 [03:08<03:42,  1.85s/it]generating response:  45%|████▌     | 99/218 [03:09<03:12,  1.62s/it]generating response:  46%|████▌     | 100/218 [03:11<03:06,  1.58s/it]generating response:  46%|████▋     | 101/218 [03:12<02:38,  1.36s/it]generating response:  47%|████▋     | 102/218 [03:13<02:42,  1.40s/it]generating response:  47%|████▋     | 103/218 [03:15<02:57,  1.54s/it]generating response:  48%|████▊     | 104/218 [03:17<03:20,  1.76s/it]generating response:  48%|████▊     | 105/218 [03:21<04:25,  2.35s/it]generating response:  49%|████▊     | 106/218 [03:23<04:05,  2.19s/it]generating response:  49%|████▉     | 107/218 [03:24<03:34,  1.93s/it]generating response:  50%|████▉     | 108/218 [03:25<03:13,  1.76s/it]generating response:  50%|█████     | 109/218 [03:27<02:58,  1.64s/it]generating response:  50%|█████     | 110/218 [03:28<02:34,  1.43s/it]generating response:  51%|█████     | 111/218 [03:30<02:56,  1.65s/it]generating response:  51%|█████▏    | 112/218 [03:31<02:48,  1.59s/it]generating response:  52%|█████▏    | 113/218 [03:33<02:43,  1.56s/it]generating response:  52%|█████▏    | 114/218 [03:34<02:34,  1.49s/it]generating response:  53%|█████▎    | 115/218 [03:35<02:28,  1.44s/it]generating response:  53%|█████▎    | 116/218 [03:37<02:24,  1.42s/it]generating response:  54%|█████▎    | 117/218 [03:38<02:12,  1.31s/it]generating response:  54%|█████▍    | 118/218 [03:39<02:02,  1.22s/it]generating response:  55%|█████▍    | 119/218 [03:41<02:40,  1.62s/it]generating response:  55%|█████▌    | 120/218 [03:43<02:23,  1.46s/it]generating response:  56%|█████▌    | 121/218 [03:44<02:20,  1.45s/it]generating response:  56%|█████▌    | 122/218 [03:46<02:21,  1.48s/it]generating response:  56%|█████▋    | 123/218 [03:47<02:15,  1.43s/it]generating response:  57%|█████▋    | 124/218 [03:48<02:08,  1.37s/it]generating response:  57%|█████▋    | 125/218 [03:49<02:06,  1.36s/it]generating response:  58%|█████▊    | 126/218 [03:51<02:05,  1.37s/it]generating response:  58%|█████▊    | 127/218 [03:52<02:06,  1.39s/it]generating response:  59%|█████▊    | 128/218 [03:53<02:00,  1.34s/it]generating response:  59%|█████▉    | 129/218 [03:55<01:57,  1.32s/it]generating response:  60%|█████▉    | 130/218 [03:56<01:54,  1.30s/it]generating response:  60%|██████    | 131/218 [03:57<01:57,  1.35s/it]generating response:  61%|██████    | 132/218 [03:59<01:56,  1.36s/it]generating response:  61%|██████    | 133/218 [04:00<01:50,  1.30s/it]generating response:  61%|██████▏   | 134/218 [04:01<01:49,  1.31s/it]generating response:  62%|██████▏   | 135/218 [04:03<01:53,  1.36s/it]generating response:  62%|██████▏   | 136/218 [04:04<01:55,  1.40s/it]generating response:  63%|██████▎   | 137/218 [04:06<01:51,  1.38s/it]generating response:  63%|██████▎   | 138/218 [04:07<01:59,  1.49s/it]generating response:  64%|██████▍   | 139/218 [04:10<02:13,  1.69s/it]generating response:  64%|██████▍   | 140/218 [04:16<03:58,  3.06s/it]generating response:  65%|██████▍   | 141/218 [04:20<04:25,  3.45s/it]generating response:  65%|██████▌   | 142/218 [04:26<05:23,  4.25s/it]generating response:  66%|██████▌   | 143/218 [04:29<04:35,  3.67s/it]generating response:  66%|██████▌   | 144/218 [04:31<03:52,  3.14s/it]generating response:  67%|██████▋   | 145/218 [04:36<04:39,  3.83s/it]generating response:  67%|██████▋   | 146/218 [04:40<04:46,  3.98s/it]generating response:  67%|██████▋   | 147/218 [04:46<05:14,  4.44s/it]generating response:  68%|██████▊   | 148/218 [04:51<05:24,  4.64s/it]generating response:  68%|██████▊   | 149/218 [04:57<05:50,  5.08s/it]generating response:  69%|██████▉   | 150/218 [05:04<06:14,  5.51s/it]generating response:  69%|██████▉   | 151/218 [05:09<06:07,  5.48s/it]generating response:  70%|██████▉   | 152/218 [05:15<06:14,  5.67s/it]generating response:  70%|███████   | 153/218 [05:21<06:11,  5.71s/it]generating response:  71%|███████   | 154/218 [05:28<06:24,  6.01s/it]generating response:  71%|███████   | 155/218 [05:33<06:13,  5.93s/it]generating response:  72%|███████▏  | 156/218 [05:41<06:33,  6.35s/it]generating response:  72%|███████▏  | 157/218 [05:53<08:21,  8.23s/it]generating response:  72%|███████▏  | 158/218 [06:00<07:42,  7.71s/it]generating response:  73%|███████▎  | 159/218 [06:14<09:35,  9.75s/it]generating response:  73%|███████▎  | 160/218 [06:21<08:33,  8.86s/it]generating response:  74%|███████▍  | 161/218 [06:30<08:18,  8.74s/it]generating response:  74%|███████▍  | 162/218 [06:38<08:08,  8.73s/it]generating response:  75%|███████▍  | 163/218 [06:55<10:18, 11.25s/it]generating response:  75%|███████▌  | 164/218 [07:13<11:49, 13.13s/it]generating response:  76%|███████▌  | 165/218 [07:24<10:56, 12.38s/it]generating response:  76%|███████▌  | 166/218 [07:31<09:28, 10.93s/it]generating response:  77%|███████▋  | 167/218 [07:50<11:13, 13.21s/it]generating response:  77%|███████▋  | 168/218 [08:00<10:23, 12.47s/it]generating response:  78%|███████▊  | 169/218 [08:09<09:14, 11.32s/it]generating response:  78%|███████▊  | 170/218 [08:16<07:59,  9.99s/it]generating response:  78%|███████▊  | 171/218 [08:21<06:45,  8.64s/it]generating response:  79%|███████▉  | 172/218 [08:26<05:48,  7.58s/it]generating response:  79%|███████▉  | 173/218 [08:37<06:20,  8.45s/it]generating response:  80%|███████▉  | 174/218 [08:44<05:50,  7.96s/it]generating response:  80%|████████  | 175/218 [08:49<05:09,  7.20s/it]generating response:  81%|████████  | 176/218 [08:59<05:41,  8.13s/it]generating response:  81%|████████  | 177/218 [09:10<06:02,  8.83s/it]generating response:  82%|████████▏ | 178/218 [09:19<05:59,  8.99s/it]generating response:  82%|████████▏ | 179/218 [09:27<05:40,  8.73s/it]generating response:  83%|████████▎ | 180/218 [09:34<05:07,  8.10s/it]generating response:  83%|████████▎ | 181/218 [09:38<04:12,  6.82s/it]generating response:  83%|████████▎ | 182/218 [09:46<04:20,  7.23s/it]generating response:  84%|████████▍ | 183/218 [09:53<04:06,  7.05s/it]generating response:  84%|████████▍ | 184/218 [10:00<04:02,  7.12s/it]generating response:  85%|████████▍ | 185/218 [10:10<04:26,  8.08s/it]generating response:  85%|████████▌ | 186/218 [10:15<03:49,  7.18s/it]generating response:  86%|████████▌ | 187/218 [10:23<03:42,  7.18s/it]generating response:  86%|████████▌ | 188/218 [10:31<03:45,  7.52s/it]generating response:  87%|████████▋ | 189/218 [10:37<03:28,  7.20s/it]generating response:  87%|████████▋ | 190/218 [10:46<03:33,  7.62s/it]generating response:  88%|████████▊ | 191/218 [10:50<02:54,  6.47s/it]generating response:  88%|████████▊ | 192/218 [10:58<02:59,  6.91s/it]generating response:  89%|████████▊ | 193/218 [11:07<03:13,  7.73s/it]generating response:  89%|████████▉ | 194/218 [11:17<03:16,  8.19s/it]generating response:  89%|████████▉ | 195/218 [11:23<02:58,  7.76s/it]generating response:  90%|████████▉ | 196/218 [11:33<03:03,  8.34s/it]generating response:  90%|█████████ | 197/218 [11:43<03:05,  8.82s/it]generating response:  91%|█████████ | 198/218 [11:52<02:56,  8.81s/it]generating response:  91%|█████████▏| 199/218 [11:58<02:34,  8.11s/it]generating response:  92%|█████████▏| 200/218 [12:05<02:16,  7.57s/it]generating response:  92%|█████████▏| 201/218 [12:10<02:00,  7.08s/it]generating response:  93%|█████████▎| 202/218 [12:17<01:52,  7.01s/it]generating response:  93%|█████████▎| 203/218 [12:24<01:42,  6.81s/it]generating response:  94%|█████████▎| 204/218 [12:28<01:24,  6.04s/it]generating response:  94%|█████████▍| 205/218 [12:36<01:26,  6.65s/it]generating response:  94%|█████████▍| 206/218 [12:42<01:16,  6.34s/it]generating response:  95%|█████████▍| 207/218 [12:49<01:11,  6.51s/it]generating response:  95%|█████████▌| 208/218 [12:52<00:57,  5.73s/it]generating response:  96%|█████████▌| 209/218 [13:11<01:25,  9.51s/it]generating response:  96%|█████████▋| 210/218 [13:21<01:16,  9.61s/it]generating response:  97%|█████████▋| 211/218 [13:34<01:16, 10.89s/it]generating response:  97%|█████████▋| 212/218 [13:47<01:08, 11.41s/it]generating response:  98%|█████████▊| 213/218 [14:00<01:00, 12.01s/it]generating response:  98%|█████████▊| 214/218 [14:24<01:01, 15.44s/it]generating response:  99%|█████████▊| 215/218 [14:39<00:45, 15.18s/it]generating response:  99%|█████████▉| 216/218 [14:49<00:27, 13.77s/it]generating response: 100%|█████████▉| 217/218 [14:59<00:12, 12.77s/it]generating response: 100%|██████████| 218/218 [15:10<00:00, 12.05s/it]generating response: 100%|██████████| 218/218 [15:10<00:00,  4.18s/it]
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
generation part takes 932.67s
processed 218 images, 218 texts in 932.81s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:04,  2.15it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.15it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:03,  2.15it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.14it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.14it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.14it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:03<00:01,  2.14it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:01,  1.82it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:04<00:00,  1.65it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:05<00:00,  1.67it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:05<00:00,  1.89it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:02<09:10,  2.54s/it]generating response:   1%|          | 2/218 [00:04<07:52,  2.19s/it]generating response:   1%|▏         | 3/218 [00:06<07:27,  2.08s/it]generating response:   2%|▏         | 4/218 [00:07<06:13,  1.75s/it]generating response:   2%|▏         | 5/218 [00:08<05:31,  1.56s/it]generating response:   3%|▎         | 6/218 [00:09<04:41,  1.33s/it]generating response:   3%|▎         | 7/218 [00:12<06:12,  1.77s/it]generating response:   4%|▎         | 8/218 [00:17<09:42,  2.77s/it]generating response:   4%|▍         | 9/218 [00:19<08:30,  2.44s/it]generating response:   5%|▍         | 10/218 [00:26<13:36,  3.93s/it]generating response:   5%|▌         | 11/218 [00:28<11:26,  3.32s/it]generating response:   6%|▌         | 12/218 [00:30<10:32,  3.07s/it]generating response:   6%|▌         | 13/218 [00:32<09:14,  2.71s/it]generating response:   6%|▋         | 14/218 [00:36<10:27,  3.08s/it]generating response:   7%|▋         | 15/218 [00:41<12:34,  3.72s/it]generating response:   7%|▋         | 16/218 [00:43<10:27,  3.11s/it]generating response:   8%|▊         | 17/218 [00:45<08:53,  2.65s/it]generating response:   8%|▊         | 18/218 [00:46<07:41,  2.31s/it]generating response:   9%|▊         | 19/218 [00:48<07:00,  2.11s/it]generating response:   9%|▉         | 20/218 [00:49<06:36,  2.00s/it]generating response:  10%|▉         | 21/218 [00:53<08:16,  2.52s/it]generating response:  10%|█         | 22/218 [00:55<07:50,  2.40s/it]generating response:  11%|█         | 23/218 [00:57<07:23,  2.27s/it]generating response:  11%|█         | 24/218 [00:59<06:33,  2.03s/it]generating response:  11%|█▏        | 25/218 [01:00<06:01,  1.87s/it]generating response:  12%|█▏        | 26/218 [01:01<05:07,  1.60s/it]generating response:  12%|█▏        | 27/218 [01:02<04:22,  1.38s/it]generating response:  13%|█▎        | 28/218 [01:03<04:12,  1.33s/it]generating response:  13%|█▎        | 29/218 [01:05<04:57,  1.57s/it]generating response:  14%|█▍        | 30/218 [01:07<05:03,  1.61s/it]generating response:  14%|█▍        | 31/218 [01:09<05:07,  1.64s/it]generating response:  15%|█▍        | 32/218 [01:10<05:01,  1.62s/it]generating response:  15%|█▌        | 33/218 [01:12<05:12,  1.69s/it]generating response:  16%|█▌        | 34/218 [01:19<09:41,  3.16s/it]generating response:  16%|█▌        | 35/218 [01:25<12:14,  4.02s/it]generating response:  17%|█▋        | 36/218 [01:28<11:16,  3.72s/it]generating response:  17%|█▋        | 37/218 [01:30<09:26,  3.13s/it]generating response:  17%|█▋        | 38/218 [01:33<09:58,  3.33s/it]generating response:  18%|█▊        | 39/218 [01:35<08:15,  2.77s/it]generating response:  18%|█▊        | 40/218 [01:37<07:42,  2.60s/it]generating response:  19%|█▉        | 41/218 [01:41<08:26,  2.86s/it]generating response:  19%|█▉        | 42/218 [01:42<07:16,  2.48s/it]generating response:  20%|█▉        | 43/218 [01:44<06:52,  2.36s/it]generating response:  20%|██        | 44/218 [01:47<06:50,  2.36s/it]generating response:  21%|██        | 45/218 [01:48<05:32,  1.92s/it]generating response:  21%|██        | 46/218 [01:49<04:51,  1.69s/it]generating response:  22%|██▏       | 47/218 [01:50<04:15,  1.50s/it]generating response:  22%|██▏       | 48/218 [01:52<04:34,  1.61s/it]generating response:  22%|██▏       | 49/218 [01:53<04:14,  1.50s/it]generating response:  23%|██▎       | 50/218 [01:55<04:23,  1.57s/it]generating response:  23%|██▎       | 51/218 [01:56<04:12,  1.51s/it]generating response:  24%|██▍       | 52/218 [01:57<04:02,  1.46s/it]generating response:  24%|██▍       | 53/218 [01:58<03:32,  1.29s/it]generating response:  25%|██▍       | 54/218 [01:59<03:21,  1.23s/it]generating response:  25%|██▌       | 55/218 [02:01<03:37,  1.33s/it]generating response:  26%|██▌       | 56/218 [02:03<04:35,  1.70s/it]generating response:  26%|██▌       | 57/218 [02:06<05:27,  2.04s/it]generating response:  27%|██▋       | 58/218 [02:08<05:36,  2.10s/it]generating response:  27%|██▋       | 59/218 [02:10<05:12,  1.96s/it]generating response:  28%|██▊       | 60/218 [02:12<04:46,  1.81s/it]generating response:  28%|██▊       | 61/218 [02:14<04:51,  1.85s/it]generating response:  28%|██▊       | 62/218 [02:16<05:16,  2.03s/it]generating response:  29%|██▉       | 63/218 [02:18<05:13,  2.02s/it]generating response:  29%|██▉       | 64/218 [02:19<04:41,  1.83s/it]generating response:  30%|██▉       | 65/218 [02:21<04:34,  1.80s/it]generating response:  30%|███       | 66/218 [02:23<04:26,  1.75s/it]generating response:  31%|███       | 67/218 [02:25<04:43,  1.87s/it]generating response:  31%|███       | 68/218 [02:26<04:18,  1.73s/it]generating response:  32%|███▏      | 69/218 [02:28<04:29,  1.81s/it]generating response:  32%|███▏      | 70/218 [02:30<04:18,  1.75s/it]generating response:  33%|███▎      | 71/218 [02:32<04:24,  1.80s/it]generating response:  33%|███▎      | 72/218 [02:33<04:02,  1.66s/it]generating response:  33%|███▎      | 73/218 [02:34<03:41,  1.52s/it]generating response:  34%|███▍      | 74/218 [02:36<03:33,  1.48s/it]generating response:  34%|███▍      | 75/218 [02:38<03:48,  1.60s/it]generating response:  35%|███▍      | 76/218 [02:39<03:49,  1.61s/it]generating response:  35%|███▌      | 77/218 [02:41<03:40,  1.56s/it]generating response:  36%|███▌      | 78/218 [02:43<03:59,  1.71s/it]generating response:  36%|███▌      | 79/218 [02:46<05:09,  2.23s/it]generating response:  37%|███▋      | 80/218 [02:48<04:37,  2.01s/it]generating response:  37%|███▋      | 81/218 [02:49<04:12,  1.84s/it]generating response:  38%|███▊      | 82/218 [02:51<04:06,  1.81s/it]generating response:  38%|███▊      | 83/218 [02:55<05:48,  2.58s/it]generating response:  39%|███▊      | 84/218 [03:00<06:57,  3.12s/it]generating response:  39%|███▉      | 85/218 [03:04<07:45,  3.50s/it]generating response:  39%|███▉      | 86/218 [03:05<06:12,  2.82s/it]generating response:  40%|███▉      | 87/218 [03:07<05:10,  2.37s/it]generating response:  40%|████      | 88/218 [03:09<04:56,  2.28s/it]generating response:  41%|████      | 89/218 [03:10<04:10,  1.94s/it]generating response:  41%|████▏     | 90/218 [03:11<03:49,  1.79s/it]generating response:  42%|████▏     | 91/218 [03:13<03:46,  1.78s/it]generating response:  42%|████▏     | 92/218 [03:16<04:42,  2.25s/it]generating response:  43%|████▎     | 93/218 [03:19<05:12,  2.50s/it]generating response:  43%|████▎     | 94/218 [03:22<05:23,  2.61s/it]generating response:  44%|████▎     | 95/218 [03:24<04:29,  2.19s/it]generating response:  44%|████▍     | 96/218 [03:25<04:04,  2.00s/it]generating response:  44%|████▍     | 97/218 [03:27<03:51,  1.91s/it]generating response:  45%|████▍     | 98/218 [03:29<04:07,  2.06s/it]generating response:  45%|████▌     | 99/218 [03:30<03:34,  1.80s/it]generating response:  46%|████▌     | 100/218 [03:32<03:28,  1.77s/it]generating response:  46%|████▋     | 101/218 [03:33<02:58,  1.52s/it]generating response:  47%|████▋     | 102/218 [03:35<03:02,  1.57s/it]generating response:  47%|████▋     | 103/218 [03:37<03:20,  1.74s/it]generating response:  48%|████▊     | 104/218 [03:40<03:50,  2.02s/it]generating response:  48%|████▊     | 105/218 [03:44<05:03,  2.69s/it]generating response:  49%|████▊     | 106/218 [03:46<04:40,  2.50s/it]generating response:  49%|████▉     | 107/218 [03:47<04:04,  2.20s/it]generating response:  50%|████▉     | 108/218 [03:49<03:40,  2.01s/it]generating response:  50%|█████     | 109/218 [03:50<03:21,  1.85s/it]generating response:  50%|█████     | 110/218 [03:51<02:54,  1.62s/it]generating response:  51%|█████     | 111/218 [03:54<03:26,  1.93s/it]generating response:  51%|█████▏    | 112/218 [03:56<03:16,  1.85s/it]generating response:  52%|█████▏    | 113/218 [03:57<03:09,  1.80s/it]generating response:  52%|█████▏    | 114/218 [03:59<02:58,  1.71s/it]generating response:  53%|█████▎    | 115/218 [04:00<02:49,  1.65s/it]generating response:  53%|█████▎    | 116/218 [04:02<02:45,  1.63s/it]generating response:  54%|█████▎    | 117/218 [04:03<02:31,  1.50s/it]generating response:  54%|█████▍    | 118/218 [04:04<02:19,  1.39s/it]generating response:  55%|█████▍    | 119/218 [04:07<03:02,  1.84s/it]generating response:  55%|█████▌    | 120/218 [04:09<02:43,  1.67s/it]generating response:  56%|█████▌    | 121/218 [04:10<02:40,  1.65s/it]generating response:  56%|█████▌    | 122/218 [04:12<02:41,  1.68s/it]generating response:  56%|█████▋    | 123/218 [04:13<02:33,  1.62s/it]generating response:  57%|█████▋    | 124/218 [04:15<02:26,  1.55s/it]generating response:  57%|█████▋    | 125/218 [04:16<02:23,  1.54s/it]generating response:  58%|█████▊    | 126/218 [04:18<02:22,  1.55s/it]generating response:  58%|█████▊    | 127/218 [04:19<02:23,  1.58s/it]generating response:  59%|█████▊    | 128/218 [04:21<02:17,  1.52s/it]generating response:  59%|█████▉    | 129/218 [04:22<02:13,  1.50s/it]generating response:  60%|█████▉    | 130/218 [04:24<02:09,  1.47s/it]generating response:  60%|██████    | 131/218 [04:25<02:12,  1.53s/it]generating response:  61%|██████    | 132/218 [04:27<02:11,  1.53s/it]generating response:  61%|██████    | 133/218 [04:28<02:03,  1.46s/it]generating response:  61%|██████▏   | 134/218 [04:33<03:38,  2.61s/it]generating response:  62%|██████▏   | 135/218 [04:35<03:13,  2.33s/it]generating response:  62%|██████▏   | 136/218 [04:37<02:56,  2.15s/it]generating response:  63%|██████▎   | 137/218 [04:38<02:37,  1.95s/it]generating response:  63%|██████▎   | 138/218 [04:40<02:37,  1.97s/it]generating response:  64%|██████▍   | 139/218 [04:43<02:46,  2.11s/it]generating response:  64%|██████▍   | 140/218 [04:47<03:22,  2.59s/it]generating response:  65%|██████▍   | 141/218 [04:51<04:12,  3.27s/it]generating response:  65%|██████▌   | 142/218 [04:57<04:56,  3.90s/it]generating response:  66%|██████▌   | 143/218 [04:59<04:23,  3.52s/it]generating response:  66%|██████▌   | 144/218 [05:02<03:49,  3.11s/it]generating response:  67%|██████▋   | 145/218 [05:09<05:11,  4.27s/it]generating response:  67%|██████▋   | 146/218 [05:14<05:28,  4.56s/it]generating response:  67%|██████▋   | 147/218 [05:20<06:00,  5.08s/it]generating response:  68%|██████▊   | 148/218 [05:26<06:03,  5.19s/it]generating response:  68%|██████▊   | 149/218 [05:32<06:34,  5.71s/it]generating response:  69%|██████▉   | 150/218 [05:44<08:29,  7.49s/it]generating response:  69%|██████▉   | 151/218 [05:51<08:07,  7.28s/it]generating response:  70%|██████▉   | 152/218 [05:59<08:19,  7.57s/it]generating response:  70%|███████   | 153/218 [06:06<07:52,  7.26s/it]generating response:  71%|███████   | 154/218 [06:15<08:30,  7.97s/it]generating response:  71%|███████   | 155/218 [06:21<07:48,  7.44s/it]generating response:  72%|███████▏  | 156/218 [06:27<07:04,  6.85s/it]generating response:  72%|███████▏  | 157/218 [06:33<06:50,  6.73s/it]generating response:  72%|███████▏  | 158/218 [06:40<06:39,  6.66s/it]generating response:  73%|███████▎  | 159/218 [07:00<10:36, 10.78s/it]generating response:  73%|███████▎  | 160/218 [07:03<07:59,  8.28s/it]generating response:  74%|███████▍  | 161/218 [07:10<07:40,  8.08s/it]generating response:  74%|███████▍  | 162/218 [07:20<08:03,  8.63s/it]generating response:  75%|███████▍  | 163/218 [07:36<09:50, 10.74s/it]generating response:  75%|███████▌  | 164/218 [07:53<11:29, 12.76s/it]generating response:  76%|███████▌  | 165/218 [08:06<11:09, 12.63s/it]generating response:  76%|███████▌  | 166/218 [08:16<10:15, 11.83s/it]generating response:  77%|███████▋  | 167/218 [08:32<11:14, 13.22s/it]generating response:  77%|███████▋  | 168/218 [08:43<10:21, 12.44s/it]generating response:  78%|███████▊  | 169/218 [08:53<09:30, 11.64s/it]generating response:  78%|███████▊  | 170/218 [09:03<08:58, 11.22s/it]generating response:  78%|███████▊  | 171/218 [09:08<07:23,  9.44s/it]generating response:  79%|███████▉  | 172/218 [09:14<06:23,  8.33s/it]generating response:  79%|███████▉  | 173/218 [09:20<05:52,  7.82s/it]generating response:  80%|███████▉  | 174/218 [09:31<06:13,  8.49s/it]generating response:  80%|████████  | 175/218 [09:38<05:52,  8.19s/it]generating response:  81%|████████  | 176/218 [09:49<06:13,  8.89s/it]generating response:  81%|████████  | 177/218 [09:59<06:22,  9.33s/it]generating response:  82%|████████▏ | 178/218 [10:04<05:21,  8.04s/it]generating response:  82%|████████▏ | 179/218 [10:10<04:50,  7.45s/it]generating response:  83%|████████▎ | 180/218 [10:17<04:39,  7.35s/it]generating response:  83%|████████▎ | 181/218 [10:22<04:03,  6.57s/it]generating response:  83%|████████▎ | 182/218 [10:30<04:16,  7.14s/it]generating response:  84%|████████▍ | 183/218 [10:37<04:01,  6.89s/it]generating response:  84%|████████▍ | 184/218 [10:43<03:47,  6.68s/it]generating response:  85%|████████▍ | 185/218 [10:55<04:31,  8.23s/it]generating response:  85%|████████▌ | 186/218 [11:00<03:50,  7.22s/it]generating response:  86%|████████▌ | 187/218 [11:09<04:04,  7.90s/it]generating response:  86%|████████▌ | 188/218 [11:15<03:35,  7.19s/it]generating response:  87%|████████▋ | 189/218 [11:26<04:03,  8.40s/it]generating response:  87%|████████▋ | 190/218 [11:41<04:56, 10.60s/it]generating response:  88%|████████▊ | 191/218 [11:46<03:55,  8.71s/it]generating response:  88%|████████▊ | 192/218 [11:53<03:38,  8.40s/it]generating response:  89%|████████▊ | 193/218 [12:04<03:49,  9.16s/it]generating response:  89%|████████▉ | 194/218 [12:11<03:20,  8.34s/it]generating response:  89%|████████▉ | 195/218 [12:21<03:26,  8.98s/it]generating response:  90%|████████▉ | 196/218 [12:31<03:21,  9.16s/it]generating response:  90%|█████████ | 197/218 [12:42<03:22,  9.66s/it]generating response:  91%|█████████ | 198/218 [12:53<03:23, 10.18s/it]generating response:  91%|█████████▏| 199/218 [13:02<03:03,  9.66s/it]generating response:  92%|█████████▏| 200/218 [13:08<02:35,  8.65s/it]generating response:  92%|█████████▏| 201/218 [13:15<02:18,  8.17s/it]generating response:  93%|█████████▎| 202/218 [13:22<02:03,  7.75s/it]generating response:  93%|█████████▎| 203/218 [13:28<01:48,  7.20s/it]generating response:  94%|█████████▎| 204/218 [13:32<01:28,  6.33s/it]generating response:  94%|█████████▍| 205/218 [13:40<01:29,  6.92s/it]generating response:  94%|█████████▍| 206/218 [13:44<01:11,  5.96s/it]generating response:  95%|█████████▍| 207/218 [13:50<01:06,  6.01s/it]generating response:  95%|█████████▌| 208/218 [13:54<00:53,  5.39s/it]generating response:  96%|█████████▌| 209/218 [14:04<01:00,  6.75s/it]generating response:  96%|█████████▋| 210/218 [14:14<01:01,  7.68s/it]generating response:  97%|█████████▋| 211/218 [14:29<01:09,  9.95s/it]generating response:  97%|█████████▋| 212/218 [14:39<00:58,  9.83s/it]generating response:  98%|█████████▊| 213/218 [14:54<00:57, 11.50s/it]generating response:  98%|█████████▊| 214/218 [15:18<01:00, 15.23s/it]generating response:  99%|█████████▊| 215/218 [15:32<00:45, 15.04s/it]generating response:  99%|█████████▉| 216/218 [15:42<00:27, 13.50s/it]generating response: 100%|█████████▉| 217/218 [15:54<00:12, 12.93s/it]generating response: 100%|██████████| 218/218 [16:07<00:00, 12.82s/it]generating response: 100%|██████████| 218/218 [16:07<00:00,  4.44s/it]
Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
generation part takes 984.44s
processed 218 images, 218 texts in 1917.34s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:00<00:04,  2.09it/s]Loading checkpoint shards:  20%|██        | 2/10 [00:00<00:03,  2.09it/s]Loading checkpoint shards:  30%|███       | 3/10 [00:01<00:03,  2.12it/s]Loading checkpoint shards:  40%|████      | 4/10 [00:01<00:02,  2.11it/s]Loading checkpoint shards:  50%|█████     | 5/10 [00:02<00:02,  2.13it/s]Loading checkpoint shards:  60%|██████    | 6/10 [00:02<00:01,  2.13it/s]Loading checkpoint shards:  70%|███████   | 7/10 [00:03<00:01,  2.08it/s]Loading checkpoint shards:  80%|████████  | 8/10 [00:03<00:01,  1.92it/s]Loading checkpoint shards:  90%|█████████ | 9/10 [00:04<00:00,  1.81it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:05<00:00,  1.84it/s]Loading checkpoint shards: 100%|██████████| 10/10 [00:05<00:00,  1.97it/s]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:02<09:19,  2.58s/it]generating response:   1%|          | 2/218 [00:04<07:55,  2.20s/it]generating response:   1%|▏         | 3/218 [00:07<09:39,  2.69s/it]generating response:   2%|▏         | 4/218 [00:09<07:35,  2.13s/it]generating response:   2%|▏         | 5/218 [00:10<06:21,  1.79s/it]generating response:   3%|▎         | 6/218 [00:11<05:14,  1.48s/it]generating response:   3%|▎         | 7/218 [00:13<06:34,  1.87s/it]generating response:   4%|▎         | 8/218 [00:20<11:45,  3.36s/it]generating response:   4%|▍         | 9/218 [00:22<09:54,  2.84s/it]generating response:   5%|▍         | 10/218 [00:29<14:51,  4.28s/it]generating response:   5%|▌         | 11/218 [00:31<12:01,  3.49s/it]generating response:   6%|▌         | 12/218 [00:33<10:37,  3.10s/it]generating response:   6%|▌         | 13/218 [00:35<09:18,  2.72s/it]generating response:   6%|▋         | 14/218 [00:39<10:29,  3.09s/it]generating response:   7%|▋         | 15/218 [00:44<12:36,  3.73s/it]generating response:   7%|▋         | 16/218 [00:46<10:29,  3.12s/it]generating response:   8%|▊         | 17/218 [00:47<08:52,  2.65s/it]generating response:   8%|▊         | 18/218 [00:49<07:42,  2.31s/it]generating response:   9%|▊         | 19/218 [00:50<07:00,  2.11s/it]generating response:   9%|▉         | 20/218 [00:52<06:36,  2.00s/it]generating response:  10%|▉         | 21/218 [00:56<08:14,  2.51s/it]generating response:  10%|█         | 22/218 [00:58<07:48,  2.39s/it]generating response:  11%|█         | 23/218 [01:00<07:20,  2.26s/it]generating response:  11%|█         | 24/218 [01:01<06:39,  2.06s/it]generating response:  11%|█▏        | 25/218 [01:03<06:05,  1.89s/it]generating response:  12%|█▏        | 26/218 [01:04<05:10,  1.62s/it]generating response:  12%|█▏        | 27/218 [01:05<04:23,  1.38s/it]generating response:  13%|█▎        | 28/218 [01:06<04:13,  1.34s/it]generating response:  13%|█▎        | 29/218 [01:08<04:56,  1.57s/it]generating response:  14%|█▍        | 30/218 [01:10<05:03,  1.61s/it]generating response:  14%|█▍        | 31/218 [01:12<05:08,  1.65s/it]generating response:  15%|█▍        | 32/218 [01:13<05:04,  1.64s/it]generating response:  15%|█▌        | 33/218 [01:15<05:14,  1.70s/it]generating response:  16%|█▌        | 34/218 [01:22<09:42,  3.17s/it]generating response:  16%|█▌        | 35/218 [01:28<12:17,  4.03s/it]generating response:  17%|█▋        | 36/218 [01:31<11:17,  3.72s/it]generating response:  17%|█▋        | 37/218 [01:32<09:27,  3.14s/it]generating response:  17%|█▋        | 38/218 [01:36<09:59,  3.33s/it]generating response:  18%|█▊        | 39/218 [01:38<08:15,  2.77s/it]generating response:  18%|█▊        | 40/218 [01:40<07:43,  2.61s/it]generating response:  19%|█▉        | 41/218 [01:44<09:09,  3.10s/it]generating response:  19%|█▉        | 42/218 [01:46<07:46,  2.65s/it]generating response:  20%|█▉        | 43/218 [01:48<07:12,  2.47s/it]generating response:  20%|██        | 44/218 [01:50<07:04,  2.44s/it]generating response:  21%|██        | 45/218 [01:51<05:43,  1.99s/it]generating response:  21%|██        | 46/218 [01:52<04:49,  1.68s/it]generating response:  22%|██▏       | 47/218 [01:53<04:14,  1.49s/it]generating response:  22%|██▏       | 48/218 [01:55<04:34,  1.61s/it]generating response:  22%|██▏       | 49/218 [01:56<04:13,  1.50s/it]generating response:  23%|██▎       | 50/218 [01:58<04:22,  1.57s/it]generating response:  23%|██▎       | 51/218 [01:59<04:13,  1.52s/it]generating response:  24%|██▍       | 52/218 [02:01<04:01,  1.46s/it]generating response:  24%|██▍       | 53/218 [02:02<03:33,  1.29s/it]generating response:  25%|██▍       | 54/218 [02:03<03:21,  1.23s/it]generating response:  25%|██▌       | 55/218 [02:04<03:37,  1.34s/it]generating response:  26%|██▌       | 56/218 [02:07<04:35,  1.70s/it]generating response:  26%|██▌       | 57/218 [02:10<05:27,  2.03s/it]generating response:  27%|██▋       | 58/218 [02:12<05:35,  2.10s/it]generating response:  27%|██▋       | 59/218 [02:14<05:11,  1.96s/it]generating response:  28%|██▊       | 60/218 [02:15<04:45,  1.81s/it]generating response:  28%|██▊       | 61/218 [02:17<04:50,  1.85s/it]generating response:  28%|██▊       | 62/218 [02:19<05:16,  2.03s/it]generating response:  29%|██▉       | 63/218 [02:21<05:13,  2.02s/it]generating response:  29%|██▉       | 64/218 [02:23<04:42,  1.83s/it]generating response:  30%|██▉       | 65/218 [02:24<04:35,  1.80s/it]generating response:  30%|███       | 66/218 [02:26<04:29,  1.77s/it]generating response:  31%|███       | 67/218 [02:28<04:28,  1.78s/it]generating response:  31%|███       | 68/218 [02:29<04:09,  1.66s/it]generating response:  32%|███▏      | 69/218 [02:31<04:22,  1.76s/it]generating response:  32%|███▏      | 70/218 [02:33<04:12,  1.71s/it]generating response:  33%|███▎      | 71/218 [02:35<04:21,  1.78s/it]generating response:  33%|███▎      | 72/218 [02:36<03:59,  1.64s/it]generating response:  33%|███▎      | 73/218 [02:37<03:38,  1.50s/it]generating response:  34%|███▍      | 74/218 [02:39<03:31,  1.47s/it]generating response:  34%|███▍      | 75/218 [02:41<03:47,  1.59s/it]generating response:  35%|███▍      | 76/218 [02:42<03:48,  1.61s/it]generating response:  35%|███▌      | 77/218 [02:44<03:39,  1.56s/it]generating response:  36%|███▌      | 78/218 [02:46<03:59,  1.71s/it]generating response:  36%|███▌      | 79/218 [02:49<04:44,  2.05s/it]generating response:  37%|███▋      | 80/218 [02:50<04:20,  1.89s/it]generating response:  37%|███▋      | 81/218 [02:52<04:00,  1.75s/it]generating response:  38%|███▊      | 82/218 [02:53<03:58,  1.75s/it]generating response:  38%|███▊      | 83/218 [02:58<05:44,  2.55s/it]generating response:  39%|███▊      | 84/218 [03:02<06:54,  3.09s/it]generating response:  39%|███▉      | 85/218 [03:07<07:42,  3.48s/it]generating response:  39%|███▉      | 86/218 [03:08<06:11,  2.82s/it]generating response:  40%|███▉      | 87/218 [03:09<05:10,  2.37s/it]generating response:  40%|████      | 88/218 [03:11<04:56,  2.28s/it]generating response:  41%|████      | 89/218 [03:12<04:09,  1.93s/it]generating response:  41%|████▏     | 90/218 [03:14<03:49,  1.79s/it]generating response:  42%|████▏     | 91/218 [03:16<03:46,  1.78s/it]generating response:  42%|████▏     | 92/218 [03:18<04:12,  2.00s/it]generating response:  43%|████▎     | 93/218 [03:21<04:51,  2.33s/it]generating response:  43%|████▎     | 94/218 [03:24<05:08,  2.49s/it]generating response:  44%|████▎     | 95/218 [03:25<04:18,  2.10s/it]generating response:  44%|████▍     | 96/218 [03:27<03:57,  1.95s/it]generating response:  44%|████▍     | 97/218 [03:28<03:46,  1.87s/it]generating response:  45%|████▍     | 98/218 [03:31<04:12,  2.10s/it]generating response:  45%|████▌     | 99/218 [03:32<03:38,  1.83s/it]generating response:  46%|████▌     | 100/218 [03:34<03:31,  1.79s/it]generating response:  46%|████▋     | 101/218 [03:35<02:59,  1.53s/it]generating response:  47%|████▋     | 102/218 [03:37<03:03,  1.58s/it]generating response:  47%|████▋     | 103/218 [03:39<03:21,  1.75s/it]generating response:  48%|████▊     | 104/218 [03:41<03:38,  1.91s/it]generating response:  48%|████▊     | 105/218 [03:45<04:55,  2.62s/it]generating response:  49%|████▊     | 106/218 [03:47<04:34,  2.45s/it]generating response:  49%|████▉     | 107/218 [03:49<04:00,  2.16s/it]generating response:  50%|████▉     | 108/218 [03:50<03:37,  1.98s/it]generating response:  50%|█████     | 109/218 [03:52<03:21,  1.85s/it]generating response:  50%|█████     | 110/218 [03:53<02:54,  1.61s/it]generating response:  51%|█████     | 111/218 [03:56<03:34,  2.01s/it]generating response:  51%|█████▏    | 112/218 [03:58<03:21,  1.90s/it]generating response:  52%|█████▏    | 113/218 [03:59<03:12,  1.83s/it]generating response:  52%|█████▏    | 114/218 [04:01<03:00,  1.74s/it]generating response:  53%|█████▎    | 115/218 [04:02<02:51,  1.67s/it]generating response:  53%|█████▎    | 116/218 [04:04<02:46,  1.64s/it]generating response:  54%|█████▎    | 117/218 [04:05<02:31,  1.50s/it]generating response:  54%|█████▍    | 118/218 [04:06<02:19,  1.39s/it]generating response:  55%|█████▍    | 119/218 [04:09<03:01,  1.83s/it]generating response:  55%|█████▌    | 120/218 [04:10<02:43,  1.67s/it]generating response:  56%|█████▌    | 121/218 [04:12<02:39,  1.65s/it]generating response:  56%|█████▌    | 122/218 [04:14<02:40,  1.68s/it]generating response:  56%|█████▋    | 123/218 [04:15<02:34,  1.62s/it]generating response:  57%|█████▋    | 124/218 [04:17<02:26,  1.55s/it]generating response:  57%|█████▋    | 125/218 [04:18<02:23,  1.54s/it]generating response:  58%|█████▊    | 126/218 [04:20<02:23,  1.56s/it]generating response:  58%|█████▊    | 127/218 [04:21<02:23,  1.57s/it]generating response:  59%|█████▊    | 128/218 [04:23<02:12,  1.47s/it]generating response:  59%|█████▉    | 129/218 [04:24<02:09,  1.46s/it]generating response:  60%|█████▉    | 130/218 [04:25<02:07,  1.45s/it]generating response:  60%|██████    | 131/218 [04:27<02:09,  1.49s/it]generating response:  61%|██████    | 132/218 [04:29<02:09,  1.50s/it]generating response:  61%|██████    | 133/218 [04:30<02:02,  1.44s/it]generating response:  61%|██████▏   | 134/218 [04:31<02:02,  1.46s/it]generating response:  62%|██████▏   | 135/218 [04:33<02:07,  1.53s/it]generating response:  62%|██████▏   | 136/218 [04:35<02:09,  1.58s/it]generating response:  63%|██████▎   | 137/218 [04:36<02:05,  1.55s/it]generating response:  63%|██████▎   | 138/218 [04:38<02:14,  1.69s/it]generating response:  64%|██████▍   | 139/218 [04:41<02:32,  1.94s/it]generating response:  64%|██████▍   | 140/218 [04:44<03:12,  2.47s/it]generating response:  65%|██████▍   | 141/218 [04:49<04:04,  3.18s/it]generating response:  65%|██████▌   | 142/218 [04:56<05:25,  4.28s/it]generating response:  66%|██████▌   | 143/218 [04:59<04:43,  3.78s/it]generating response:  66%|██████▌   | 144/218 [05:01<04:03,  3.30s/it]generating response:  67%|██████▋   | 145/218 [05:09<05:46,  4.74s/it]generating response:  67%|██████▋   | 146/218 [05:14<05:53,  4.91s/it]generating response:  67%|██████▋   | 147/218 [05:21<06:36,  5.59s/it]generating response:  68%|██████▊   | 148/218 [05:27<06:24,  5.49s/it]generating response:  68%|██████▊   | 149/218 [05:34<06:49,  5.93s/it]generating response:  69%|██████▉   | 150/218 [05:42<07:33,  6.66s/it]generating response:  69%|██████▉   | 151/218 [05:49<07:41,  6.89s/it]generating response:  70%|██████▉   | 152/218 [05:56<07:19,  6.65s/it]generating response:  70%|███████   | 153/218 [06:02<07:10,  6.63s/it]generating response:  71%|███████   | 154/218 [06:10<07:22,  6.91s/it]generating response:  71%|███████   | 155/218 [06:17<07:13,  6.88s/it]generating response:  72%|███████▏  | 156/218 [06:22<06:32,  6.32s/it]generating response:  72%|███████▏  | 157/218 [06:28<06:21,  6.25s/it]generating response:  72%|███████▏  | 158/218 [06:34<06:24,  6.41s/it]generating response:  73%|███████▎  | 159/218 [06:56<10:43, 10.91s/it]generating response:  73%|███████▎  | 160/218 [06:58<08:04,  8.36s/it]generating response:  74%|███████▍  | 161/218 [07:11<09:19,  9.81s/it]generating response:  74%|███████▍  | 162/218 [07:27<10:40, 11.43s/it]generating response:  75%|███████▍  | 163/218 [07:41<11:24, 12.45s/it]generating response:  75%|███████▌  | 164/218 [07:44<08:30,  9.45s/it]generating response:  76%|███████▌  | 165/218 [07:57<09:10, 10.38s/it]generating response:  76%|███████▌  | 166/218 [08:03<07:58,  9.20s/it]generating response:  77%|███████▋  | 167/218 [08:17<09:04, 10.68s/it]generating response:  77%|███████▋  | 168/218 [08:26<08:30, 10.21s/it]generating response:  78%|███████▊  | 169/218 [08:38<08:43, 10.68s/it]generating response:  78%|███████▊  | 170/218 [08:46<07:53,  9.87s/it]generating response:  78%|███████▊  | 171/218 [08:52<06:47,  8.66s/it]generating response:  79%|███████▉  | 172/218 [08:57<05:49,  7.60s/it]generating response:  79%|███████▉  | 173/218 [09:04<05:36,  7.49s/it]generating response:  80%|███████▉  | 174/218 [09:11<05:21,  7.32s/it]generating response:  80%|████████  | 175/218 [09:17<05:02,  7.03s/it]generating response:  81%|████████  | 176/218 [09:24<04:53,  6.99s/it]generating response:  81%|████████  | 177/218 [09:33<05:12,  7.62s/it]generating response:  82%|████████▏ | 178/218 [09:40<04:48,  7.21s/it]generating response:  82%|████████▏ | 179/218 [09:47<04:43,  7.27s/it]generating response:  83%|████████▎ | 180/218 [09:54<04:37,  7.29s/it]generating response:  83%|████████▎ | 181/218 [10:03<04:43,  7.67s/it]generating response:  83%|████████▎ | 182/218 [10:10<04:24,  7.34s/it]generating response:  84%|████████▍ | 183/218 [10:17<04:20,  7.44s/it]generating response:  84%|████████▍ | 184/218 [10:25<04:19,  7.63s/it]generating response:  85%|████████▍ | 185/218 [10:35<04:27,  8.12s/it]generating response:  85%|████████▌ | 186/218 [10:41<04:00,  7.52s/it]generating response:  86%|████████▌ | 187/218 [10:47<03:37,  7.02s/it]generating response:  86%|████████▌ | 188/218 [10:52<03:16,  6.56s/it]generating response:  87%|████████▋ | 189/218 [10:58<03:06,  6.43s/it]generating response:  87%|████████▋ | 190/218 [11:11<03:53,  8.34s/it]generating response:  88%|████████▊ | 191/218 [11:15<03:08,  6.97s/it]generating response:  88%|████████▊ | 192/218 [11:21<02:53,  6.69s/it]generating response:  89%|████████▊ | 193/218 [11:28<02:54,  6.97s/it]generating response:  89%|████████▉ | 194/218 [11:41<03:31,  8.82s/it]generating response:  89%|████████▉ | 195/218 [11:49<03:11,  8.31s/it]generating response:  90%|████████▉ | 196/218 [11:57<03:06,  8.46s/it]generating response:  90%|█████████ | 197/218 [12:05<02:49,  8.08s/it]generating response:  91%|█████████ | 198/218 [12:13<02:40,  8.02s/it]generating response:  91%|█████████▏| 199/218 [12:18<02:19,  7.32s/it]generating response:  92%|█████████▏| 200/218 [12:24<02:02,  6.82s/it]generating response:  92%|█████████▏| 201/218 [12:28<01:44,  6.13s/it]generating response:  93%|█████████▎| 202/218 [12:34<01:35,  5.97s/it]generating response:  93%|█████████▎| 203/218 [12:39<01:25,  5.71s/it]generating response:  94%|█████████▎| 204/218 [12:43<01:11,  5.12s/it]generating response:  94%|█████████▍| 205/218 [12:50<01:14,  5.77s/it]generating response:  94%|█████████▍| 206/218 [12:54<01:02,  5.20s/it]generating response:  95%|█████████▍| 207/218 [13:00<01:00,  5.47s/it]generating response:  95%|█████████▌| 208/218 [13:03<00:47,  4.80s/it]generating response:  96%|█████████▌| 209/218 [13:14<00:58,  6.45s/it]generating response:  96%|█████████▋| 210/218 [13:24<01:01,  7.71s/it]generating response:  97%|█████████▋| 211/218 [13:39<01:07,  9.70s/it]generating response:  97%|█████████▋| 212/218 [13:47<00:56,  9.42s/it]generating response:  98%|█████████▊| 213/218 [13:59<00:50, 10.08s/it]generating response:  98%|█████████▊| 214/218 [14:21<00:54, 13.57s/it]generating response:  99%|█████████▊| 215/218 [14:35<00:41, 13.91s/it]generating response:  99%|█████████▉| 216/218 [14:45<00:25, 12.50s/it]generating response: 100%|█████████▉| 217/218 [14:54<00:11, 11.63s/it]generating response: 100%|██████████| 218/218 [15:05<00:00, 11.24s/it]generating response: 100%|██████████| 218/218 [15:05<00:00,  4.15s/it]
generation part takes 923.26s
Full generation completed in 2840.65s
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:43<02:55, 43.87s/it]denoise batch:  40%|████      | 2/5 [01:27<02:11, 43.82s/it]denoise batch:  60%|██████    | 3/5 [02:11<01:27, 43.89s/it]denoise batch:  80%|████████  | 4/5 [02:55<00:43, 43.98s/it]denoise batch: 100%|██████████| 5/5 [03:05<00:00, 31.62s/it]denoise batch: 100%|██████████| 5/5 [03:05<00:00, 37.09s/it]
/home/xuyue/.local/lib/python3.10/site-packages/transformers/models/llava/configuration_llava.py:100: FutureWarning: The `vocab_size` argument is deprecated and will be removed in v4.42, since it can be inferred from the `text_config`. Passing this argument has no effect
  warnings.warn(
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.54it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.69it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.24it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.92it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Traceback (most recent call last):
  File "/home/xuyue/QXYtemp/MLM/./main.py", line 78, in <module>
    image_num, images = defence(args=args, a=a)
  File "/home/xuyue/QXYtemp/MLM/model_tools.py", line 117, in defence
    sim_matrix = get_similarity_list(a, save_internal=True)
  File "/home/xuyue/QXYtemp/MLM/model_tools.py", line 216, in get_similarity_list
    img_embed = img_embed_list[i*args.denoise_checkpoint_num+j]
IndexError: list index out of range
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/home/xuyue/.local/lib/python3.10/site-packages/transformers/models/llava/configuration_llava.py:100: FutureWarning: The `vocab_size` argument is deprecated and will be removed in v4.42, since it can be inferred from the `text_config`. Passing this argument has no effect
  warnings.warn(
processed 218 images, 218 texts in 0.11s
using llava for generation
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.02s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.07it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.14it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.11it/s]
Traceback (most recent call last):
  File "/home/xuyue/QXYtemp/MLM/./main.py", line 102, in <module>
    responses = get_response(args.model, texts, images, a=a)
  File "/home/xuyue/QXYtemp/MLM/model_tools.py", line 306, in get_response
    model.to(a.device) # type: ignore
  File "/home/xuyue/.local/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2724, in to
    return super().to(*args, **kwargs)
  File "/home/xuyue/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1173, in to
    return self._apply(convert)
  File "/home/xuyue/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 779, in _apply
    module._apply(fn)
  File "/home/xuyue/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 779, in _apply
    module._apply(fn)
  File "/home/xuyue/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 779, in _apply
    module._apply(fn)
  [Previous line repeated 3 more times]
  File "/home/xuyue/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 804, in _apply
    param_applied = fn(param)
  File "/home/xuyue/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1159, in convert
    return t.to(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB. GPU  has a total capacity of 44.35 GiB of which 59.31 MiB is free. Process 826391 has 7.01 GiB memory in use. Process 828520 has 27.74 GiB memory in use. Including non-PyTorch memory, this process has 9.51 GiB memory in use. Of the allocated memory 9.24 GiB is allocated by PyTorch, and 15.86 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
-------qwen with defence generation complete-------
-------qwen without defence generation complete-------
-------llava with defence generation complete-------
-------llava without defence generation complete-------
