processing images... denoise batch:   0%|          | 0/5 [00:00<?, ?it/s]denoise batch:  20%|██        | 1/5 [00:24<01:38, 24.72s/it]denoise batch:  40%|████      | 2/5 [00:49<01:13, 24.63s/it]denoise batch:  60%|██████    | 3/5 [01:13<00:49, 24.65s/it]denoise batch:  80%|████████  | 4/5 [01:38<00:24, 24.67s/it]denoise batch: 100%|██████████| 5/5 [01:47<00:00, 18.96s/it]denoise batch: 100%|██████████| 5/5 [01:47<00:00, 21.50s/it]
Done
computing cossim... /home/xuyue/miniconda3/envs/llava1.6/lib/python3.10/site-packages/transformers/models/llava/configuration_llava.py:103: FutureWarning: The `vocab_size` argument is deprecated and will be removed in v4.42, since it can be inferred from the `text_config`. Passing this argument has no effect
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.92it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  4.39it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.25it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.71it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp_llava1.6_images218
Done
Defender initialized with threshold=-0.003936767578125
processed 218 images, 218 texts in 234.87s
using llava1.6 for generation
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:03,  1.57s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.44s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.31s/it]
generating response:   0%|          | 0/218 [00:00<?, ?it/s]generating response:   0%|          | 1/218 [00:03<10:52,  3.01s/it]generating response:   1%|          | 2/218 [00:04<08:21,  2.32s/it]generating response:   1%|▏         | 3/218 [00:06<07:57,  2.22s/it]generating response:   2%|▏         | 4/218 [00:08<06:54,  1.94s/it]generating response:   2%|▏         | 5/218 [00:10<06:29,  1.83s/it]generating response:   3%|▎         | 6/218 [00:13<08:04,  2.28s/it]generating response:   3%|▎         | 7/218 [00:15<08:26,  2.40s/it]generating response:   4%|▎         | 8/218 [00:51<45:46, 13.08s/it]generating response:   4%|▍         | 9/218 [00:54<34:41,  9.96s/it]generating response:   6%|▋         | 14/218 [00:58<12:02,  3.54s/it]generating response:   7%|▋         | 15/218 [01:02<12:10,  3.60s/it]generating response:   7%|▋         | 16/218 [01:04<11:30,  3.42s/it]generating response:   8%|▊         | 17/218 [01:08<11:43,  3.50s/it]generating response:   8%|▊         | 18/218 [01:11<11:22,  3.41s/it]generating response:   9%|▊         | 19/218 [01:15<11:12,  3.38s/it]generating response:   9%|▉         | 20/218 [01:19<11:43,  3.55s/it]generating response:  10%|█         | 22/218 [01:22<08:51,  2.71s/it]generating response:  11%|█         | 24/218 [01:25<07:17,  2.26s/it]generating response:  11%|█▏        | 25/218 [01:28<07:36,  2.37s/it]generating response:  12%|█▏        | 26/218 [01:32<09:23,  2.94s/it]generating response:  13%|█▎        | 28/218 [01:36<07:52,  2.49s/it]generating response:  14%|█▍        | 31/218 [01:38<05:21,  1.72s/it]generating response:  15%|█▌        | 33/218 [01:45<06:39,  2.16s/it]generating response:  16%|█▌        | 35/218 [01:52<07:44,  2.54s/it]generating response:  17%|█▋        | 37/218 [01:56<07:08,  2.37s/it]generating response:  18%|█▊        | 39/218 [01:58<06:03,  2.03s/it]generating response:  18%|█▊        | 40/218 [02:09<10:32,  3.55s/it]generating response:  19%|█▉        | 41/218 [02:11<09:55,  3.37s/it]generating response:  19%|█▉        | 42/218 [02:15<10:02,  3.42s/it]generating response:  20%|█▉        | 43/218 [02:19<10:06,  3.47s/it]generating response:  20%|██        | 44/218 [02:21<09:21,  3.23s/it]generating response:  22%|██▏       | 47/218 [02:25<06:30,  2.29s/it]generating response:  22%|██▏       | 48/218 [02:29<07:22,  2.60s/it]generating response:  22%|██▏       | 49/218 [02:32<07:36,  2.70s/it]generating response:  23%|██▎       | 50/218 [02:37<08:53,  3.17s/it]generating response:  23%|██▎       | 51/218 [02:40<08:45,  3.15s/it]generating response:  24%|██▍       | 53/218 [02:43<06:42,  2.44s/it]generating response:  25%|██▍       | 54/218 [02:48<08:05,  2.96s/it]generating response:  25%|██▌       | 55/218 [02:51<08:25,  3.10s/it]generating response:  26%|██▌       | 56/218 [02:58<11:11,  4.15s/it]generating response:  26%|██▌       | 57/218 [03:03<11:17,  4.21s/it]generating response:  27%|██▋       | 58/218 [03:16<18:04,  6.78s/it]generating response:  27%|██▋       | 59/218 [03:19<15:13,  5.74s/it]generating response:  28%|██▊       | 60/218 [03:23<13:32,  5.14s/it]generating response:  28%|██▊       | 61/218 [03:25<11:10,  4.27s/it]generating response:  28%|██▊       | 62/218 [03:27<09:25,  3.63s/it]generating response:  30%|██▉       | 65/218 [03:31<05:44,  2.25s/it]generating response:  30%|███       | 66/218 [03:34<06:16,  2.48s/it]generating response:  31%|███       | 67/218 [03:36<05:58,  2.38s/it]generating response:  31%|███       | 68/218 [03:39<06:28,  2.59s/it]generating response:  32%|███▏      | 69/218 [03:42<06:30,  2.62s/it]generating response:  32%|███▏      | 70/218 [03:45<07:05,  2.87s/it]generating response:  33%|███▎      | 71/218 [03:57<12:40,  5.17s/it]generating response:  33%|███▎      | 72/218 [04:03<13:15,  5.45s/it]generating response:  34%|███▍      | 74/218 [04:05<08:30,  3.55s/it]generating response:  35%|███▍      | 76/218 [04:08<06:40,  2.82s/it]generating response:  35%|███▌      | 77/218 [04:14<08:08,  3.46s/it]generating response:  36%|███▌      | 79/218 [04:17<06:20,  2.74s/it]generating response:  37%|███▋      | 81/218 [04:26<07:38,  3.35s/it]generating response:  38%|███▊      | 83/218 [04:37<08:54,  3.96s/it]generating response:  39%|███▊      | 84/218 [04:47<11:33,  5.18s/it]generating response:  40%|████      | 88/218 [04:50<06:13,  2.88s/it]generating response:  41%|████▏     | 90/218 [04:54<05:37,  2.63s/it]generating response:  42%|████▏     | 91/218 [04:58<05:56,  2.80s/it]generating response:  42%|████▏     | 92/218 [05:01<05:54,  2.81s/it]generating response:  43%|████▎     | 93/218 [05:05<06:36,  3.17s/it]generating response:  43%|████▎     | 94/218 [05:11<07:39,  3.71s/it]generating response:  44%|████▎     | 95/218 [05:13<07:01,  3.43s/it]generating response:  44%|████▍     | 96/218 [05:16<06:49,  3.36s/it]generating response:  44%|████▍     | 97/218 [05:57<27:21, 13.57s/it]generating response:  45%|████▍     | 98/218 [06:05<23:43, 11.86s/it]generating response:  45%|████▌     | 99/218 [06:07<18:09,  9.15s/it]generating response:  46%|████▌     | 100/218 [06:10<14:32,  7.39s/it]generating response:  46%|████▋     | 101/218 [06:16<13:36,  6.98s/it]generating response:  47%|████▋     | 103/218 [06:19<08:24,  4.39s/it]generating response:  48%|████▊     | 104/218 [06:22<07:52,  4.14s/it]generating response:  48%|████▊     | 105/218 [06:25<07:05,  3.76s/it]generating response:  49%|████▊     | 106/218 [06:27<06:06,  3.27s/it]generating response:  50%|████▉     | 108/218 [06:29<04:23,  2.40s/it]generating response:  51%|█████     | 111/218 [06:31<02:49,  1.59s/it]generating response:  53%|█████▎    | 115/218 [06:35<02:15,  1.32s/it]generating response:  55%|█████▍    | 119/218 [06:39<01:50,  1.11s/it]generating response:  55%|█████▌    | 120/218 [06:41<02:00,  1.23s/it]generating response:  56%|█████▌    | 121/218 [06:44<02:25,  1.51s/it]generating response:  56%|█████▌    | 122/218 [06:45<02:22,  1.48s/it]generating response:  56%|█████▋    | 123/218 [06:48<02:49,  1.79s/it]generating response:  57%|█████▋    | 125/218 [06:50<02:20,  1.51s/it]generating response:  58%|█████▊    | 127/218 [06:53<02:13,  1.47s/it]generating response:  59%|█████▊    | 128/218 [06:56<02:33,  1.70s/it]generating response:  60%|█████▉    | 130/218 [06:59<02:37,  1.79s/it]generating response:  60%|██████    | 131/218 [07:03<03:05,  2.13s/it]generating response:  61%|██████    | 132/218 [07:05<03:02,  2.12s/it]generating response:  61%|██████    | 133/218 [07:08<03:26,  2.43s/it]generating response:  62%|██████▏   | 135/218 [07:13<03:20,  2.41s/it]generating response:  62%|██████▏   | 136/218 [07:15<03:06,  2.28s/it]generating response:  63%|██████▎   | 137/218 [07:18<03:19,  2.46s/it]generating response:  68%|██████▊   | 149/218 [07:37<02:01,  1.76s/it]generating response:  69%|██████▉   | 150/218 [08:00<04:05,  3.61s/it]generating response:  69%|██████▉   | 151/218 [08:20<06:04,  5.44s/it]generating response:  70%|███████   | 153/218 [08:35<06:27,  5.97s/it]generating response:  71%|███████   | 154/218 [08:47<07:15,  6.80s/it]generating response:  72%|███████▏  | 156/218 [08:59<06:46,  6.56s/it]generating response:  72%|███████▏  | 157/218 [09:14<08:06,  7.98s/it]generating response:  73%|███████▎  | 159/218 [09:43<10:01, 10.19s/it]generating response:  73%|███████▎  | 160/218 [09:57<10:32, 10.91s/it]generating response:  74%|███████▍  | 162/218 [10:17<09:54, 10.61s/it]generating response:  76%|███████▌  | 166/218 [10:37<06:44,  7.77s/it]generating response:  77%|███████▋  | 167/218 [11:12<10:08, 11.93s/it]generating response:  79%|███████▉  | 172/218 [11:22<05:12,  6.79s/it]generating response:  80%|████████  | 175/218 [11:31<03:59,  5.58s/it]generating response:  83%|████████▎ | 180/218 [11:42<02:39,  4.21s/it]generating response:  83%|████████▎ | 182/218 [11:56<02:47,  4.66s/it]generating response:  84%|████████▍ | 183/218 [12:07<03:11,  5.48s/it]generating response:  86%|████████▌ | 188/218 [12:18<01:58,  3.96s/it]generating response:  87%|████████▋ | 189/218 [13:00<04:05,  8.48s/it]generating response:  87%|████████▋ | 190/218 [13:22<04:50, 10.37s/it]generating response:  88%|████████▊ | 191/218 [13:32<04:39, 10.36s/it]generating response:  88%|████████▊ | 192/218 [13:54<05:25, 12.50s/it]generating response:  89%|████████▊ | 193/218 [14:09<05:25, 13.04s/it]generating response:  89%|████████▉ | 194/218 [14:33<06:18, 15.76s/it]generating response:  89%|████████▉ | 195/218 [14:48<05:56, 15.52s/it]generating response:  90%|████████▉ | 196/218 [15:01<05:29, 14.98s/it]generating response:  90%|█████████ | 197/218 [15:17<05:17, 15.13s/it]generating response:  91%|█████████ | 198/218 [15:41<05:53, 17.68s/it]generating response:  93%|█████████▎| 202/218 [15:52<02:14,  8.39s/it]generating response:  93%|█████████▎| 203/218 [15:59<02:03,  8.24s/it]generating response:  94%|█████████▎| 204/218 [16:09<02:01,  8.65s/it]generating response:  95%|█████████▍| 207/218 [16:15<01:00,  5.52s/it]generating response:  95%|█████████▌| 208/218 [16:25<01:02,  6.22s/it]generating response:  96%|█████████▌| 209/218 [17:00<01:49, 12.21s/it]generating response:  96%|█████████▋| 210/218 [17:34<02:16, 17.11s/it]generating response:  97%|█████████▋| 211/218 [18:14<02:40, 22.93s/it]generating response:  97%|█████████▋| 212/218 [18:56<02:47, 27.88s/it]generating response:  98%|█████████▊| 213/218 [19:18<02:11, 26.25s/it]generating response:  99%|█████████▊| 215/218 [20:01<01:12, 24.10s/it]generating response: 100%|█████████▉| 217/218 [20:44<00:23, 23.04s/it]generating response: 100%|██████████| 218/218 [21:18<00:00, 25.49s/it]generating response: 100%|██████████| 218/218 [21:18<00:00,  5.86s/it]
generation part takes 1287.67s
Full generation completed in 1522.59s
