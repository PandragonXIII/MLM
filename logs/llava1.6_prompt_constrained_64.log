processing images... denoise batch:   0%|          | 0/1 [00:00<?, ?it/s]denoise batch: 100%|██████████| 1/1 [00:01<00:00,  1.66s/it]denoise batch: 100%|██████████| 1/1 [00:01<00:00,  1.66s/it]
Done
computing cossim... /home/xuyue/miniconda3/envs/llava1.6/lib/python3.10/site-packages/transformers/models/llava/configuration_llava.py:103: FutureWarning: The `vocab_size` argument is deprecated and will be removed in v4.42, since it can be inferred from the `text_config`. Passing this argument has no effect
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  5.22it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  6.03it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.39it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.18it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp_llava1.6_prompt_constrained_64
Done
Defender initialized with threshold=-0.003936767578125
processed 1 images, 160 texts in 13.05s
using llava1.6 for generation
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:06<00:12,  6.01s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:11<00:05,  5.75s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:16<00:00,  5.23s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:16<00:00,  5.40s/it]
generating response:   0%|          | 0/160 [00:00<?, ?it/s]generating response:   1%|          | 1/160 [00:27<1:12:36, 27.40s/it]generating response:   2%|▏         | 3/160 [00:42<33:00, 12.62s/it]  generating response:   4%|▍         | 6/160 [01:02<22:59,  8.95s/it]generating response:   7%|▋         | 11/160 [01:12<12:12,  4.91s/it]generating response:  11%|█▏        | 18/160 [01:16<05:53,  2.49s/it]generating response:  12%|█▎        | 20/160 [01:35<08:56,  3.83s/it]generating response:  14%|█▍        | 23/160 [01:55<10:31,  4.61s/it]generating response:  17%|█▋        | 27/160 [02:21<11:41,  5.28s/it]generating response:  18%|█▊        | 28/160 [02:24<10:59,  4.99s/it]generating response:  18%|█▊        | 29/160 [02:39<13:45,  6.30s/it]generating response:  19%|█▉        | 30/160 [03:11<23:01, 10.62s/it]generating response:  19%|█▉        | 31/160 [03:13<19:06,  8.88s/it]generating response:  21%|██▏       | 34/160 [03:15<10:54,  5.19s/it]generating response:  22%|██▏       | 35/160 [03:17<09:54,  4.76s/it]generating response:  26%|██▋       | 42/160 [03:33<06:09,  3.13s/it]generating response:  27%|██▋       | 43/160 [03:41<07:15,  3.72s/it]generating response:  29%|██▉       | 46/160 [04:12<11:07,  5.85s/it]generating response:  29%|██▉       | 47/160 [04:14<10:03,  5.34s/it]generating response:  30%|███       | 48/160 [04:33<14:05,  7.54s/it]generating response:  31%|███▏      | 50/160 [04:37<10:47,  5.89s/it]generating response:  32%|███▏      | 51/160 [05:10<19:43, 10.85s/it]generating response:  35%|███▌      | 56/160 [05:36<13:10,  7.60s/it]generating response:  39%|███▉      | 62/160 [06:09<10:41,  6.55s/it]generating response:  40%|████      | 64/160 [06:30<11:45,  7.35s/it]generating response:  44%|████▍     | 71/160 [06:50<07:39,  5.16s/it]generating response:  46%|████▌     | 73/160 [07:23<10:10,  7.02s/it]generating response:  47%|████▋     | 75/160 [07:34<09:35,  6.77s/it]generating response:  52%|█████▏    | 83/160 [08:06<06:49,  5.32s/it]generating response:  52%|█████▎    | 84/160 [08:12<06:47,  5.36s/it]generating response:  55%|█████▌    | 88/160 [08:41<07:11,  5.99s/it]generating response:  57%|█████▋    | 91/160 [08:51<06:05,  5.29s/it]generating response:  59%|█████▉    | 94/160 [09:22<07:17,  6.63s/it]generating response:  59%|█████▉    | 95/160 [09:40<08:40,  8.00s/it]generating response:  61%|██████    | 97/160 [10:13<10:33, 10.06s/it]generating response:  63%|██████▎   | 101/160 [10:46<09:07,  9.29s/it]generating response:  65%|██████▌   | 104/160 [11:19<09:08,  9.79s/it]generating response:  67%|██████▋   | 107/160 [11:40<07:57,  9.01s/it]generating response:  69%|██████▉   | 110/160 [11:43<05:28,  6.57s/it]generating response:  73%|███████▎  | 117/160 [12:16<04:01,  5.62s/it]generating response:  81%|████████  | 129/160 [12:45<01:59,  3.87s/it]generating response:  82%|████████▏ | 131/160 [12:48<01:42,  3.54s/it]generating response:  84%|████████▍ | 134/160 [12:53<01:22,  3.17s/it]generating response:  84%|████████▍ | 135/160 [13:25<02:23,  5.74s/it]generating response:  88%|████████▊ | 140/160 [13:57<01:58,  5.94s/it]generating response:  89%|████████▉ | 143/160 [14:29<02:01,  7.17s/it]generating response:  90%|█████████ | 144/160 [14:45<02:08,  8.04s/it]generating response:  92%|█████████▎| 148/160 [15:18<01:37,  8.09s/it]generating response:  99%|█████████▉| 158/160 [15:46<00:10,  5.06s/it]generating response:  99%|█████████▉| 159/160 [15:47<00:04,  4.79s/it]generating response: 100%|██████████| 160/160 [15:47<00:00,  5.92s/it]
generation part takes 970.91s
Full generation completed in 983.97s
