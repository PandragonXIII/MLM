processing images... denoise batch:   0%|          | 0/1 [00:00<?, ?it/s]denoise batch: 100%|██████████| 1/1 [00:23<00:00, 23.71s/it]denoise batch: 100%|██████████| 1/1 [00:23<00:00, 23.71s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  3.88it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  4.82it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.25it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.99it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp_llava_1
Done
Defender initialized with threshold=-0.0018310546875
processed 4 images, 160 texts in 32.68s
using llava for generation
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:03,  1.69s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:01,  1.66s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:08<00:00,  3.45s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:08<00:00,  2.97s/it]
generating response:   0%|          | 0/640 [00:00<?, ?it/s]generating response:   0%|          | 1/640 [00:22<4:00:29, 22.58s/it]generating response:   0%|          | 3/640 [00:47<2:40:07, 15.08s/it]generating response:   1%|          | 7/640 [01:08<1:29:28,  8.48s/it]generating response:   2%|▏         | 10/640 [01:23<1:13:19,  6.98s/it]generating response:   2%|▏         | 11/640 [01:30<1:13:06,  6.97s/it]generating response:   3%|▎         | 19/640 [01:52<43:30,  4.20s/it]  generating response:   7%|▋         | 43/640 [01:57<12:27,  1.25s/it]generating response:   8%|▊         | 51/640 [02:04<11:28,  1.17s/it]generating response:   9%|▊         | 55/640 [02:20<15:35,  1.60s/it]generating response:  10%|█         | 65/640 [02:21<10:12,  1.06s/it]generating response:  12%|█▏        | 79/640 [02:28<07:47,  1.20it/s]generating response:  14%|█▍        | 91/640 [02:44<09:00,  1.02it/s]generating response:  15%|█▌        | 99/640 [02:53<09:21,  1.04s/it]generating response:  17%|█▋        | 111/640 [02:58<07:09,  1.23it/s]generating response:  18%|█▊        | 114/640 [03:09<09:53,  1.13s/it]generating response:  19%|█▉        | 123/640 [03:13<07:56,  1.09it/s]generating response:  20%|█▉        | 127/640 [03:20<09:01,  1.06s/it]generating response:  21%|██        | 135/640 [03:22<06:44,  1.25it/s]generating response:  23%|██▎       | 147/640 [03:27<05:17,  1.55it/s]generating response:  24%|██▎       | 151/640 [03:48<11:08,  1.37s/it]generating response:  25%|██▍       | 159/640 [04:07<13:46,  1.72s/it]generating response:  25%|██▌       | 163/640 [04:14<13:24,  1.69s/it]generating response:  26%|██▌       | 167/640 [04:30<17:12,  2.18s/it]generating response:  28%|██▊       | 182/640 [04:38<09:58,  1.31s/it]generating response:  30%|██▉       | 189/640 [04:50<10:45,  1.43s/it]generating response:  30%|███       | 195/640 [04:54<09:11,  1.24s/it]generating response:  32%|███▏      | 202/640 [05:23<15:13,  2.09s/it]generating response:  34%|███▎      | 215/640 [05:36<11:21,  1.60s/it]generating response:  35%|███▍      | 222/640 [06:02<14:46,  2.12s/it]generating response:  39%|███▊      | 247/640 [06:20<08:46,  1.34s/it]generating response:  39%|███▉      | 251/640 [06:24<08:22,  1.29s/it]generating response:  42%|████▏     | 269/640 [06:26<04:54,  1.26it/s]generating response:  42%|████▏     | 270/640 [06:28<05:12,  1.18it/s]generating response:  42%|████▏     | 271/640 [06:31<05:40,  1.08it/s]generating response:  43%|████▎     | 273/640 [06:42<08:53,  1.45s/it]generating response:  44%|████▍     | 283/640 [06:54<07:58,  1.34s/it]generating response:  45%|████▌     | 290/640 [06:58<06:34,  1.13s/it]generating response:  45%|████▌     | 291/640 [07:03<07:48,  1.34s/it]generating response:  46%|████▌     | 295/640 [07:13<09:31,  1.66s/it]generating response:  47%|████▋     | 299/640 [07:23<10:23,  1.83s/it]generating response:  48%|████▊     | 307/640 [07:39<10:45,  1.94s/it]generating response:  51%|█████     | 325/640 [07:54<06:46,  1.29s/it]generating response:  52%|█████▏    | 331/640 [08:06<07:22,  1.43s/it]generating response:  52%|█████▏    | 334/640 [08:12<07:46,  1.53s/it]generating response:  55%|█████▍    | 351/640 [08:24<05:16,  1.09s/it]generating response:  57%|█████▋    | 363/640 [08:46<06:12,  1.35s/it]generating response:  57%|█████▋    | 367/640 [09:10<09:03,  1.99s/it]generating response:  58%|█████▊    | 373/640 [09:19<08:25,  1.89s/it]generating response:  59%|█████▊    | 375/640 [09:28<09:24,  2.13s/it]generating response:  59%|█████▉    | 379/640 [09:30<07:44,  1.78s/it]generating response:  62%|██████▏   | 395/640 [09:41<04:44,  1.16s/it]generating response:  62%|██████▏   | 399/640 [09:43<04:15,  1.06s/it]generating response:  63%|██████▎   | 401/640 [09:46<04:29,  1.13s/it]generating response:  63%|██████▎   | 406/640 [09:51<04:10,  1.07s/it]generating response:  64%|██████▎   | 407/640 [09:55<05:06,  1.31s/it]generating response:  64%|██████▍   | 411/640 [10:00<04:53,  1.28s/it]generating response:  65%|██████▍   | 415/640 [10:29<11:18,  3.01s/it]generating response:  65%|██████▌   | 417/640 [10:49<16:00,  4.31s/it]generating response:  66%|██████▌   | 421/640 [11:05<15:18,  4.20s/it]generating response:  67%|██████▋   | 427/640 [11:18<11:52,  3.35s/it]generating response:  69%|██████▊   | 439/640 [11:27<06:28,  1.93s/it]generating response:  70%|██████▉   | 445/640 [11:33<05:25,  1.67s/it]generating response:  70%|███████   | 449/640 [11:37<04:54,  1.54s/it]generating response:  72%|███████▏  | 459/640 [11:43<03:23,  1.13s/it]generating response:  73%|███████▎  | 467/640 [12:07<04:57,  1.72s/it]generating response:  74%|███████▎  | 471/640 [12:32<07:21,  2.61s/it]generating response:  74%|███████▍  | 475/640 [12:47<07:50,  2.85s/it]generating response:  79%|███████▉  | 507/640 [12:52<02:03,  1.08it/s]generating response:  83%|████████▎ | 531/640 [13:14<01:41,  1.07it/s]generating response:  84%|████████▎ | 535/640 [13:34<02:18,  1.32s/it]generating response:  84%|████████▍ | 539/640 [14:01<03:15,  1.94s/it]generating response:  86%|████████▌ | 551/640 [14:17<02:33,  1.73s/it]generating response:  87%|████████▋ | 554/640 [14:21<02:27,  1.71s/it]generating response:  87%|████████▋ | 557/640 [14:44<03:27,  2.50s/it]generating response:  87%|████████▋ | 558/640 [15:06<04:59,  3.66s/it]generating response:  89%|████████▉ | 571/640 [15:32<03:12,  2.78s/it]generating response:  90%|████████▉ | 575/640 [15:40<02:51,  2.64s/it]generating response:  91%|█████████ | 581/640 [15:47<02:10,  2.21s/it]generating response:  91%|█████████ | 583/640 [15:53<02:09,  2.28s/it]generating response:  92%|█████████▏| 591/640 [16:22<02:19,  2.84s/it]generating response:  93%|█████████▎| 595/640 [16:29<01:55,  2.58s/it]generating response:  93%|█████████▎| 597/640 [16:37<02:01,  2.82s/it]generating response:  97%|█████████▋| 622/640 [16:49<00:20,  1.15s/it]generating response:  99%|█████████▊| 631/640 [17:08<00:12,  1.40s/it]generating response:  99%|█████████▉| 635/640 [17:11<00:06,  1.31s/it]generating response: 100%|█████████▉| 639/640 [17:27<00:01,  1.77s/it]generating response: 100%|██████████| 640/640 [17:27<00:00,  1.64s/it]
generation part takes 1065.79s
Full generation completed in 1098.49s
