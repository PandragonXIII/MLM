processing images... denoise batch:   0%|          | 0/1 [00:00<?, ?it/s]denoise batch: 100%|██████████| 1/1 [00:24<00:00, 24.01s/it]denoise batch: 100%|██████████| 1/1 [00:24<00:00, 24.01s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  3.67it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  4.75it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.93it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.74it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp_blip_1
Done
Defender initialized with threshold=-0.0018310546875
processed 4 images, 160 texts in 32.48s
using blip for generation
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:08,  2.87s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:05<00:04,  2.45s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.66s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.72s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
generating response:   0%|          | 0/640 [00:00<?, ?it/s]generating response:   0%|          | 1/640 [00:01<12:59,  1.22s/it]generating response:   0%|          | 3/640 [00:02<07:16,  1.46it/s]generating response:   1%|          | 7/640 [00:27<47:00,  4.46s/it]generating response:   2%|▏         | 10/640 [00:28<29:35,  2.82s/it]generating response:   2%|▏         | 11/640 [00:30<26:43,  2.55s/it]generating response:   3%|▎         | 19/640 [00:30<09:43,  1.07it/s]generating response:   7%|▋         | 43/640 [00:33<03:16,  3.04it/s]generating response:   8%|▊         | 51/640 [00:47<06:49,  1.44it/s]generating response:   9%|▊         | 55/640 [00:47<05:50,  1.67it/s]generating response:  10%|█         | 65/640 [00:48<03:55,  2.44it/s]generating response:  12%|█▏        | 79/640 [01:14<09:33,  1.02s/it]generating response:  14%|█▍        | 91/640 [01:15<06:28,  1.41it/s]generating response:  15%|█▌        | 99/640 [01:16<05:00,  1.80it/s]generating response:  17%|█▋        | 111/640 [01:25<05:32,  1.59it/s]generating response:  18%|█▊        | 114/640 [01:26<05:07,  1.71it/s]generating response:  19%|█▉        | 123/640 [01:26<03:36,  2.38it/s]generating response:  20%|█▉        | 127/640 [01:45<09:38,  1.13s/it]generating response:  21%|██        | 135/640 [01:46<06:44,  1.25it/s]generating response:  23%|██▎       | 147/640 [01:51<05:20,  1.54it/s]generating response:  24%|██▎       | 151/640 [02:17<13:11,  1.62s/it]generating response:  25%|██▍       | 159/640 [02:18<09:05,  1.13s/it]generating response:  25%|██▌       | 163/640 [02:22<08:53,  1.12s/it]generating response:  26%|██▌       | 167/640 [02:23<07:10,  1.10it/s]generating response:  28%|██▊       | 182/640 [02:24<03:27,  2.21it/s]generating response:  30%|██▉       | 189/640 [02:24<02:37,  2.87it/s]generating response:  30%|██▉       | 189/640 [02:34<02:37,  2.87it/s]generating response:  30%|███       | 195/640 [02:41<07:09,  1.04it/s]generating response:  32%|███▏      | 202/640 [02:42<05:12,  1.40it/s]generating response:  34%|███▎      | 215/640 [02:43<02:59,  2.37it/s]generating response:  35%|███▍      | 222/640 [02:43<02:21,  2.95it/s]generating response:  39%|███▊      | 247/640 [02:44<01:05,  6.02it/s]generating response:  39%|███▊      | 247/640 [02:54<01:05,  6.02it/s]generating response:  39%|███▉      | 251/640 [03:00<03:57,  1.64it/s]generating response:  42%|████▏     | 269/640 [03:01<02:16,  2.71it/s]generating response:  42%|████▎     | 272/640 [03:02<02:16,  2.70it/s]generating response:  43%|████▎     | 274/640 [03:03<02:21,  2.58it/s]generating response:  43%|████▎     | 274/640 [03:14<02:21,  2.58it/s]generating response:  44%|████▍     | 283/640 [03:30<07:25,  1.25s/it]generating response:  45%|████▌     | 290/640 [03:30<05:24,  1.08it/s]generating response:  46%|████▌     | 292/640 [03:31<05:03,  1.15it/s]generating response:  46%|████▌     | 295/640 [03:32<04:33,  1.26it/s]generating response:  47%|████▋     | 299/640 [03:33<03:38,  1.56it/s]generating response:  48%|████▊     | 307/640 [03:34<02:19,  2.38it/s]generating response:  51%|█████     | 325/640 [03:49<03:29,  1.50it/s]generating response:  52%|█████▏    | 331/640 [03:51<03:07,  1.65it/s]generating response:  52%|█████▏    | 334/640 [03:57<03:58,  1.28it/s]generating response:  55%|█████▍    | 351/640 [03:58<01:57,  2.46it/s]generating response:  57%|█████▋    | 363/640 [04:04<01:58,  2.35it/s]generating response:  57%|█████▋    | 367/640 [04:09<02:30,  1.81it/s]generating response:  58%|█████▊    | 373/640 [04:10<02:00,  2.22it/s]generating response:  59%|█████▊    | 375/640 [04:10<01:57,  2.26it/s]generating response:  59%|█████▉    | 379/640 [04:11<01:41,  2.58it/s]generating response:  62%|██████▏   | 395/640 [04:12<00:49,  4.92it/s]generating response:  62%|██████▏   | 399/640 [04:13<00:47,  5.02it/s]generating response:  63%|██████▎   | 401/640 [04:14<00:57,  4.17it/s]generating response:  63%|██████▎   | 406/640 [04:15<00:48,  4.81it/s]generating response:  64%|██████▎   | 407/640 [04:15<00:57,  4.03it/s]generating response:  64%|██████▍   | 411/640 [04:22<02:24,  1.59it/s]generating response:  65%|██████▍   | 415/640 [04:23<01:56,  1.93it/s]generating response:  65%|██████▌   | 417/640 [04:49<10:08,  2.73s/it]generating response:  66%|██████▌   | 421/640 [04:49<06:45,  1.85s/it]generating response:  67%|██████▋   | 427/640 [04:51<04:08,  1.17s/it]generating response:  69%|██████▊   | 439/640 [04:51<01:51,  1.80it/s]generating response:  70%|██████▉   | 445/640 [04:52<01:23,  2.34it/s]generating response:  70%|███████   | 449/640 [04:52<01:08,  2.78it/s]generating response:  72%|███████▏  | 459/640 [04:53<00:43,  4.12it/s]generating response:  73%|███████▎  | 467/640 [04:54<00:33,  5.14it/s]generating response:  74%|███████▎  | 471/640 [04:54<00:32,  5.16it/s]generating response:  74%|███████▍  | 475/640 [04:55<00:31,  5.17it/s]generating response:  79%|███████▉  | 507/640 [04:58<00:15,  8.48it/s]generating response:  83%|████████▎ | 531/640 [04:59<00:09, 11.86it/s]generating response:  84%|████████▎ | 535/640 [05:04<00:20,  5.17it/s]generating response:  84%|████████▍ | 539/640 [05:05<00:19,  5.08it/s]generating response:  86%|████████▌ | 551/640 [05:29<01:10,  1.26it/s]generating response:  87%|████████▋ | 554/640 [05:29<01:02,  1.37it/s]generating response:  87%|████████▋ | 557/640 [05:50<02:07,  1.54s/it]generating response:  87%|████████▋ | 558/640 [06:08<03:28,  2.55s/it]generating response:  89%|████████▉ | 571/640 [06:09<01:26,  1.25s/it]generating response:  90%|████████▉ | 575/640 [06:10<01:09,  1.07s/it]generating response:  91%|█████████ | 581/640 [06:11<00:46,  1.27it/s]generating response:  91%|█████████ | 583/640 [06:11<00:41,  1.38it/s]generating response:  92%|█████████▏| 591/640 [06:12<00:23,  2.11it/s]generating response:  93%|█████████▎| 595/640 [06:13<00:18,  2.48it/s]generating response:  93%|█████████▎| 597/640 [06:13<00:16,  2.60it/s]generating response:  97%|█████████▋| 622/640 [06:14<00:02,  7.63it/s]generating response:  99%|█████████▊| 631/640 [06:15<00:01,  8.53it/s]generating response:  99%|█████████▉| 635/640 [06:16<00:00,  7.81it/s]generating response:  99%|█████████▉| 635/640 [06:34<00:00,  7.81it/s]generating response: 100%|█████████▉| 639/640 [06:42<00:01,  1.24s/it]generating response: 100%|██████████| 640/640 [06:42<00:00,  1.59it/s]
generation part takes 425.91s
Full generation completed in 458.41s
