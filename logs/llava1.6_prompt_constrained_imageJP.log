processing images... denoise batch:   0%|          | 0/1 [00:00<?, ?it/s]denoise batch: 100%|██████████| 1/1 [00:00<00:00,  1.07it/s]denoise batch: 100%|██████████| 1/1 [00:00<00:00,  1.07it/s]
Done
computing cossim... /home/xuyue/miniconda3/envs/llava1.6/lib/python3.10/site-packages/transformers/models/llava/configuration_llava.py:103: FutureWarning: The `vocab_size` argument is deprecated and will be removed in v4.42, since it can be inferred from the `text_config`. Passing this argument has no effect
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.98it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.75it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.08it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.89it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
csv file saved at: ./temp_llava1.6_prompt_constrained_imageJP
Done
Defender initialized with threshold=-0.003936767578125
processed 1 images, 160 texts in 12.36s
using llava1.6 for generation
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.04it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.11it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.14it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.13it/s]
generating response:   0%|          | 0/160 [00:00<?, ?it/s]generating response:  18%|█▊        | 29/160 [00:14<01:04,  2.02it/s]generating response:  21%|██▏       | 34/160 [00:16<00:59,  2.12it/s]generating response:  29%|██▉       | 47/160 [00:18<00:39,  2.89it/s]generating response:  32%|███▏      | 51/160 [00:51<02:51,  1.58s/it]generating response:  35%|███▌      | 56/160 [01:18<04:12,  2.43s/it]generating response:  45%|████▌     | 72/160 [01:21<01:54,  1.30s/it]generating response:  46%|████▌     | 73/160 [01:53<03:49,  2.64s/it]generating response:  57%|█████▋    | 91/160 [02:23<02:25,  2.11s/it]generating response:  59%|█████▉    | 94/160 [02:48<03:04,  2.79s/it]generating response:  59%|█████▉    | 95/160 [02:50<02:58,  2.75s/it]generating response:  62%|██████▏   | 99/160 [03:05<03:02,  3.00s/it]generating response:  63%|██████▎   | 101/160 [03:38<04:45,  4.83s/it]generating response:  72%|███████▏  | 115/160 [03:52<01:58,  2.63s/it]generating response:  88%|████████▊ | 140/160 [04:23<00:36,  1.81s/it]generating response:  99%|█████████▉| 158/160 [04:50<00:03,  1.68s/it]generating response:  99%|█████████▉| 159/160 [04:51<00:01,  1.67s/it]generating response: 100%|██████████| 160/160 [04:51<00:00,  1.82s/it]
generation part takes 300.57s
Full generation completed in 312.94s
