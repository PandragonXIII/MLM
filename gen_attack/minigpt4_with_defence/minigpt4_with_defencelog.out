/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/1 [00:00<?, ?it/s]denoise batch: 100%|██████████| 1/1 [00:04<00:00,  4.29s/it]denoise batch: 100%|██████████| 1/1 [00:04<00:00,  4.29s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.72it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.88it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.41it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.09it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 8 images, 160 texts in 25.31s
using minigpt4 for generation
Loading MiniGPT-4 models...Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.44s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.56s/it]
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading Q-Former
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/1280 [00:00<?, ?it/s]generating response:   0%|          | 1/1280 [01:03<22:34:54, 63.56s/it]generating response:   0%|          | 2/1280 [02:06<22:31:55, 63.47s/it]generating response:   0%|          | 3/1280 [03:09<22:26:00, 63.24s/it]generating response:   0%|          | 4/1280 [04:13<22:29:45, 63.47s/it]generating response:   0%|          | 5/1280 [05:16<22:22:41, 63.19s/it]generating response:   0%|          | 6/1280 [06:20<22:25:27, 63.37s/it]generating response:   1%|          | 7/1280 [07:24<22:27:48, 63.53s/it]generating response:   1%|          | 9/1280 [08:26<16:56:15, 47.97s/it]generating response:   1%|          | 10/1280 [09:28<18:10:46, 51.53s/it]generating response:   1%|          | 11/1280 [10:30<19:08:15, 54.29s/it]generating response:   1%|          | 12/1280 [11:32<19:52:03, 56.41s/it]generating response:   1%|▏         | 17/1280 [12:34<9:33:38, 27.25s/it] generating response:   1%|▏         | 18/1280 [13:38<11:35:13, 33.05s/it]generating response:   1%|▏         | 19/1280 [14:42<13:34:48, 38.77s/it]generating response:   2%|▏         | 20/1280 [15:45<15:22:56, 43.95s/it]generating response:   2%|▏         | 22/1280 [16:49<13:46:24, 39.42s/it]generating response:   2%|▏         | 23/1280 [17:52<15:29:33, 44.37s/it]generating response:   2%|▏         | 25/1280 [18:56<13:51:57, 39.77s/it]generating response:   2%|▏         | 26/1280 [19:59<15:34:01, 44.69s/it]generating response:   2%|▏         | 27/1280 [21:04<17:09:27, 49.30s/it]generating response:   2%|▏         | 28/1280 [22:08<18:28:37, 53.13s/it]generating response:   3%|▎         | 33/1280 [23:11<9:23:06, 27.09s/it] generating response:   3%|▎         | 34/1280 [24:12<11:13:41, 32.44s/it]generating response:   3%|▎         | 35/1280 [25:14<13:04:26, 37.80s/it]generating response:   3%|▎         | 36/1280 [26:16<14:43:57, 42.63s/it]generating response:   3%|▎         | 41/1280 [27:19<8:32:57, 24.84s/it] generating response:   3%|▎         | 42/1280 [28:23<10:28:19, 30.45s/it]generating response:   3%|▎         | 43/1280 [29:26<12:24:33, 36.11s/it]generating response:   3%|▎         | 44/1280 [30:30<14:16:06, 41.56s/it]generating response:   4%|▍         | 49/1280 [31:34<8:27:25, 24.73s/it] generating response:   4%|▍         | 50/1280 [32:37<10:20:33, 30.27s/it]generating response:   4%|▍         | 52/1280 [33:40<10:25:42, 30.57s/it]generating response:   4%|▍         | 57/1280 [34:42<7:15:16, 21.35s/it] generating response:   5%|▍         | 58/1280 [35:43<8:56:52, 26.36s/it]generating response:   5%|▍         | 59/1280 [36:45<10:46:29, 31.77s/it]generating response:   5%|▍         | 60/1280 [37:48<12:40:02, 37.38s/it]generating response:   5%|▌         | 65/1280 [38:52<7:57:41, 23.59s/it] generating response:   5%|▌         | 66/1280 [39:54<9:46:18, 28.98s/it]generating response:   5%|▌         | 67/1280 [40:58<11:42:34, 34.75s/it]generating response:   5%|▌         | 68/1280 [42:01<13:31:35, 40.18s/it]generating response:   6%|▌         | 73/1280 [43:04<8:06:00, 24.16s/it] generating response:   6%|▌         | 74/1280 [44:08<10:00:33, 29.88s/it]generating response:   6%|▌         | 75/1280 [45:15<12:04:05, 36.05s/it]generating response:   6%|▌         | 76/1280 [46:18<13:50:41, 41.40s/it]generating response:   6%|▋         | 81/1280 [47:21<8:12:15, 24.63s/it] generating response:   6%|▋         | 82/1280 [48:24<10:00:54, 30.10s/it]generating response:   6%|▋         | 83/1280 [49:27<11:52:04, 35.69s/it]generating response:   7%|▋         | 84/1280 [50:31<13:39:04, 41.09s/it]generating response:   7%|▋         | 87/1280 [51:34<10:36:03, 31.99s/it]generating response:   7%|▋         | 89/1280 [52:37<10:32:28, 31.86s/it]generating response:   7%|▋         | 90/1280 [53:41<12:23:22, 37.48s/it]generating response:   7%|▋         | 91/1280 [54:44<14:08:11, 42.80s/it]generating response:   7%|▋         | 92/1280 [55:48<15:38:48, 47.41s/it]generating response:   8%|▊         | 97/1280 [56:51<8:34:05, 26.07s/it] generating response:   8%|▊         | 98/1280 [57:55<10:22:46, 31.61s/it]generating response:   8%|▊         | 99/1280 [58:59<12:15:04, 37.35s/it]generating response:   8%|▊         | 100/1280 [1:00:02<13:58:13, 42.62s/it]generating response:   8%|▊         | 105/1280 [1:01:06<8:09:52, 25.01s/it] generating response:   8%|▊         | 106/1280 [1:02:11<10:02:11, 30.78s/it]generating response:   8%|▊         | 107/1280 [1:03:15<11:53:46, 36.51s/it]generating response:   8%|▊         | 108/1280 [1:04:20<13:40:08, 41.99s/it]generating response:   9%|▉         | 113/1280 [1:05:24<8:05:32, 24.96s/it] generating response:   9%|▉         | 114/1280 [1:06:27<9:50:51, 30.40s/it]generating response:   9%|▉         | 115/1280 [1:07:30<11:38:03, 35.95s/it]generating response:   9%|▉         | 116/1280 [1:08:33<13:20:14, 41.25s/it]generating response:   9%|▉         | 121/1280 [1:09:36<7:55:23, 24.61s/it] generating response:  10%|▉         | 122/1280 [1:10:39<9:40:18, 30.07s/it]generating response:  10%|▉         | 124/1280 [1:11:43<9:50:14, 30.64s/it]generating response:  10%|█         | 129/1280 [1:12:46<6:50:46, 21.41s/it]generating response:  10%|█         | 130/1280 [1:13:50<8:34:31, 26.85s/it]generating response:  10%|█         | 131/1280 [1:14:58<10:35:55, 33.21s/it]generating response:  10%|█         | 132/1280 [1:16:02<12:21:22, 38.75s/it]generating response:  10%|█         | 133/1280 [1:17:05<13:54:31, 43.65s/it]generating response:  11%|█         | 137/1280 [1:18:08<9:05:40, 28.64s/it] generating response:  11%|█         | 138/1280 [1:19:12<10:51:21, 34.22s/it]generating response:  11%|█         | 139/1280 [1:20:15<12:35:52, 39.75s/it]generating response:  11%|█         | 140/1280 [1:21:19<14:10:11, 44.75s/it]generating response:  11%|█         | 143/1280 [1:22:22<10:33:28, 33.43s/it]generating response:  11%|█▏        | 145/1280 [1:23:25<10:22:30, 32.91s/it]generating response:  11%|█▏        | 146/1280 [1:24:30<12:10:38, 38.66s/it]generating response:  11%|█▏        | 147/1280 [1:25:34<13:49:29, 43.93s/it]generating response:  12%|█▏        | 148/1280 [1:26:38<15:16:10, 48.56s/it]generating response:  12%|█▏        | 153/1280 [1:27:40<8:10:44, 26.13s/it] generating response:  12%|█▏        | 154/1280 [1:28:43<9:54:37, 31.69s/it]generating response:  12%|█▏        | 155/1280 [1:29:46<11:37:07, 37.18s/it]generating response:  12%|█▏        | 156/1280 [1:30:49<13:13:56, 42.38s/it]generating response:  12%|█▏        | 159/1280 [1:31:51<10:05:42, 32.42s/it]generating response:  13%|█▎        | 161/1280 [1:32:54<10:00:02, 32.17s/it]generating response:  13%|█▎        | 162/1280 [1:33:58<11:44:56, 37.83s/it]generating response:  13%|█▎        | 163/1280 [1:35:02<13:22:47, 43.12s/it]generating response:  13%|█▎        | 169/1280 [1:36:06<6:56:24, 22.49s/it] generating response:  13%|█▎        | 170/1280 [1:37:10<8:36:16, 27.91s/it]generating response:  13%|█▎        | 171/1280 [1:38:13<10:19:57, 33.54s/it]generating response:  13%|█▎        | 172/1280 [1:39:18<12:04:27, 39.23s/it]generating response:  14%|█▍        | 177/1280 [1:40:21<7:24:04, 24.16s/it] generating response:  14%|█▍        | 178/1280 [1:41:25<9:06:12, 29.74s/it]generating response:  14%|█▍        | 179/1280 [1:42:29<10:48:36, 35.35s/it]generating response:  14%|█▍        | 180/1280 [1:43:32<12:26:43, 40.73s/it]generating response:  14%|█▍        | 183/1280 [1:44:36<9:45:36, 32.03s/it] generating response:  14%|█▍        | 185/1280 [1:45:40<9:41:44, 31.88s/it]generating response:  15%|█▍        | 186/1280 [1:46:43<11:22:42, 37.44s/it]generating response:  15%|█▍        | 187/1280 [1:47:48<13:03:43, 43.02s/it]generating response:  15%|█▍        | 188/1280 [1:48:52<14:27:14, 47.65s/it]generating response:  15%|█▌        | 193/1280 [1:49:55<7:53:31, 26.14s/it] generating response:  15%|█▌        | 194/1280 [1:50:58<9:33:49, 31.70s/it]generating response:  15%|█▌        | 195/1280 [1:52:02<11:13:50, 37.26s/it]generating response:  15%|█▌        | 196/1280 [1:53:06<12:50:03, 42.62s/it]generating response:  16%|█▌        | 201/1280 [1:54:08<7:27:11, 24.87s/it] generating response:  16%|█▌        | 202/1280 [1:55:12<9:07:41, 30.48s/it]generating response:  16%|█▌        | 203/1280 [1:56:16<10:48:25, 36.12s/it]generating response:  16%|█▌        | 204/1280 [1:57:18<12:21:06, 41.33s/it]generating response:  16%|█▋        | 209/1280 [1:58:21<7:18:08, 24.55s/it] generating response:  16%|█▋        | 210/1280 [1:59:24<8:56:15, 30.07s/it]generating response:  16%|█▋        | 211/1280 [2:00:27<10:35:25, 35.67s/it]generating response:  17%|█▋        | 212/1280 [2:01:31<12:11:14, 41.08s/it]generating response:  17%|█▋        | 215/1280 [2:02:33<9:24:56, 31.83s/it] generating response:  17%|█▋        | 217/1280 [2:03:36<9:23:03, 31.78s/it]generating response:  17%|█▋        | 218/1280 [2:04:40<11:02:53, 37.45s/it]generating response:  17%|█▋        | 219/1280 [2:05:43<12:34:31, 42.67s/it]generating response:  17%|█▋        | 220/1280 [2:06:47<13:57:28, 47.40s/it]generating response:  17%|█▋        | 223/1280 [2:07:51<10:11:04, 34.69s/it]generating response:  18%|█▊        | 225/1280 [2:08:54<9:51:46, 33.66s/it] generating response:  18%|█▊        | 226/1280 [2:09:58<11:28:24, 39.19s/it]generating response:  18%|█▊        | 227/1280 [2:11:00<12:53:46, 44.09s/it]generating response:  18%|█▊        | 228/1280 [2:12:02<14:03:44, 48.12s/it]generating response:  18%|█▊        | 230/1280 [2:13:04<12:03:36, 41.35s/it]generating response:  18%|█▊        | 231/1280 [2:14:06<13:20:42, 45.80s/it]generating response:  18%|█▊        | 233/1280 [2:15:09<11:44:44, 40.39s/it]generating response:  18%|█▊        | 234/1280 [2:16:13<13:11:39, 45.41s/it]generating response:  18%|█▊        | 235/1280 [2:17:16<14:23:41, 49.59s/it]generating response:  18%|█▊        | 236/1280 [2:18:21<15:29:42, 53.43s/it]generating response:  19%|█▊        | 238/1280 [2:19:25<12:51:12, 44.41s/it]generating response:  19%|█▊        | 239/1280 [2:20:28<14:06:48, 48.81s/it]generating response:  19%|█▉        | 241/1280 [2:21:31<12:06:12, 41.94s/it]generating response:  19%|█▉        | 242/1280 [2:22:34<13:25:45, 46.58s/it]generating response:  19%|█▉        | 243/1280 [2:23:37<14:32:37, 50.49s/it]generating response:  19%|█▉        | 244/1280 [2:24:40<15:27:19, 53.71s/it]generating response:  19%|█▉        | 247/1280 [2:25:44<10:32:00, 36.71s/it]generating response:  19%|█▉        | 249/1280 [2:26:47<10:02:17, 35.05s/it]generating response:  20%|█▉        | 250/1280 [2:27:52<11:40:31, 40.81s/it]generating response:  20%|█▉        | 251/1280 [2:28:55<13:00:15, 45.50s/it]generating response:  20%|█▉        | 252/1280 [2:29:59<14:14:52, 49.90s/it]generating response:  20%|██        | 257/1280 [2:31:03<7:34:22, 26.65s/it] generating response:  20%|██        | 258/1280 [2:32:07<9:10:02, 32.29s/it]generating response:  20%|██        | 259/1280 [2:33:11<10:47:00, 38.02s/it]generating response:  20%|██        | 260/1280 [2:34:16<12:18:23, 43.43s/it]generating response:  21%|██        | 263/1280 [2:35:19<9:20:41, 33.08s/it] generating response:  21%|██        | 264/1280 [2:36:23<10:54:34, 38.66s/it]generating response:  21%|██        | 265/1280 [2:37:27<12:20:33, 43.78s/it]generating response:  21%|██        | 266/1280 [2:38:31<13:38:19, 48.42s/it]generating response:  21%|██        | 267/1280 [2:39:35<14:42:32, 52.27s/it]generating response:  21%|██        | 268/1280 [2:40:39<15:32:18, 55.28s/it]generating response:  21%|██        | 269/1280 [2:41:43<16:09:55, 57.56s/it]generating response:  21%|██        | 270/1280 [2:42:46<16:34:50, 59.10s/it]generating response:  21%|██        | 271/1280 [2:43:49<16:53:58, 60.30s/it]generating response:  21%|██▏       | 273/1280 [2:44:53<13:17:36, 47.52s/it]generating response:  21%|██▏       | 274/1280 [2:45:56<14:21:41, 51.39s/it]generating response:  21%|██▏       | 275/1280 [2:46:59<15:08:24, 54.23s/it]generating response:  22%|██▏       | 276/1280 [2:48:02<15:49:43, 56.76s/it]generating response:  22%|██▏       | 279/1280 [2:49:06<10:29:00, 37.70s/it]generating response:  22%|██▏       | 281/1280 [2:50:09<9:54:48, 35.72s/it] generating response:  22%|██▏       | 282/1280 [2:51:13<11:23:15, 41.08s/it]generating response:  22%|██▏       | 283/1280 [2:52:17<12:45:53, 46.09s/it]generating response:  22%|██▏       | 284/1280 [2:53:20<13:53:33, 50.21s/it]generating response:  23%|██▎       | 289/1280 [2:54:23<7:18:42, 26.56s/it] generating response:  23%|██▎       | 290/1280 [2:55:26<8:48:06, 32.01s/it]generating response:  23%|██▎       | 291/1280 [2:56:30<10:23:34, 37.83s/it]generating response:  23%|██▎       | 292/1280 [2:57:33<11:46:21, 42.90s/it]generating response:  23%|██▎       | 297/1280 [2:58:35<6:47:02, 24.84s/it] generating response:  23%|██▎       | 298/1280 [2:59:39<8:18:24, 30.45s/it]generating response:  23%|██▎       | 299/1280 [3:00:42<9:50:12, 36.10s/it]generating response:  23%|██▎       | 300/1280 [3:01:45<11:15:46, 41.37s/it]generating response:  24%|██▍       | 305/1280 [3:02:48<6:39:24, 24.58s/it] generating response:  24%|██▍       | 306/1280 [3:03:52<8:10:28, 30.21s/it]generating response:  24%|██▍       | 307/1280 [3:04:55<9:40:26, 35.79s/it]generating response:  24%|██▍       | 308/1280 [3:05:59<11:09:09, 41.31s/it]generating response:  25%|██▍       | 314/1280 [3:07:02<5:55:09, 22.06s/it] generating response:  25%|██▍       | 315/1280 [3:08:04<7:18:16, 27.25s/it]generating response:  25%|██▍       | 316/1280 [3:09:08<8:47:42, 32.84s/it]generating response:  25%|██▌       | 321/1280 [3:10:10<5:54:05, 22.15s/it]generating response:  25%|██▌       | 322/1280 [3:11:13<7:17:42, 27.41s/it]generating response:  25%|██▌       | 323/1280 [3:12:15<8:44:21, 32.88s/it]generating response:  25%|██▌       | 324/1280 [3:13:17<10:09:50, 38.27s/it]generating response:  26%|██▌       | 329/1280 [3:14:21<6:16:35, 23.76s/it] generating response:  26%|██▌       | 330/1280 [3:15:23<7:42:01, 29.18s/it]generating response:  26%|██▌       | 331/1280 [3:16:27<9:11:45, 34.88s/it]generating response:  26%|██▌       | 332/1280 [3:17:30<10:38:17, 40.40s/it]generating response:  26%|██▌       | 333/1280 [3:18:34<11:55:27, 45.33s/it]generating response:  26%|██▋       | 337/1280 [3:19:38<7:38:43, 29.19s/it] generating response:  26%|██▋       | 338/1280 [3:20:41<9:05:27, 34.74s/it]generating response:  26%|██▋       | 339/1280 [3:21:44<10:28:47, 40.09s/it]generating response:  27%|██▋       | 340/1280 [3:22:48<11:49:10, 45.27s/it]generating response:  27%|██▋       | 343/1280 [3:23:52<8:47:24, 33.77s/it] generating response:  27%|██▋       | 345/1280 [3:24:54<8:32:53, 32.91s/it]generating response:  27%|██▋       | 346/1280 [3:25:57<10:00:01, 38.55s/it]generating response:  27%|██▋       | 347/1280 [3:27:01<11:18:36, 43.64s/it]generating response:  27%|██▋       | 348/1280 [3:28:04<12:29:42, 48.26s/it]generating response:  27%|██▋       | 349/1280 [3:29:08<13:27:02, 52.01s/it]generating response:  28%|██▊       | 353/1280 [3:30:11<7:56:40, 30.85s/it] generating response:  28%|██▊       | 354/1280 [3:31:14<9:21:29, 36.38s/it]generating response:  28%|██▊       | 355/1280 [3:32:17<10:42:50, 41.70s/it]generating response:  28%|██▊       | 356/1280 [3:33:20<11:55:04, 46.43s/it]generating response:  28%|██▊       | 361/1280 [3:34:24<6:36:06, 25.86s/it] generating response:  28%|██▊       | 362/1280 [3:35:28<8:02:05, 31.51s/it]generating response:  28%|██▊       | 363/1280 [3:36:32<9:28:18, 37.18s/it]generating response:  28%|██▊       | 364/1280 [3:37:36<10:48:11, 42.46s/it]generating response:  29%|██▊       | 367/1280 [3:38:40<8:18:22, 32.75s/it] generating response:  29%|██▉       | 369/1280 [3:39:48<8:22:58, 33.13s/it]generating response:  29%|██▉       | 370/1280 [3:40:53<9:47:55, 38.76s/it]generating response:  29%|██▉       | 371/1280 [3:41:59<11:11:21, 44.31s/it]generating response:  29%|██▉       | 372/1280 [3:43:03<12:18:45, 48.82s/it]generating response:  29%|██▉       | 375/1280 [3:44:06<8:51:29, 35.24s/it] generating response:  29%|██▉       | 377/1280 [3:45:10<8:34:09, 34.16s/it]generating response:  30%|██▉       | 378/1280 [3:46:14<9:56:30, 39.68s/it]generating response:  30%|██▉       | 379/1280 [3:47:18<11:11:31, 44.72s/it]generating response:  30%|██▉       | 380/1280 [3:48:22<12:18:13, 49.21s/it]generating response:  30%|██▉       | 381/1280 [3:49:26<13:12:16, 52.88s/it]generating response:  30%|██▉       | 382/1280 [3:50:31<13:58:09, 56.00s/it]generating response:  30%|██▉       | 383/1280 [3:51:36<14:32:24, 58.35s/it]generating response:  30%|███       | 385/1280 [3:52:40<11:40:31, 46.96s/it]generating response:  30%|███       | 386/1280 [3:53:45<12:43:45, 51.26s/it]generating response:  31%|███       | 393/1280 [3:54:48<5:18:00, 21.51s/it] generating response:  31%|███       | 394/1280 [3:55:51<6:33:34, 26.65s/it]generating response:  31%|███       | 395/1280 [3:56:53<7:53:56, 32.13s/it]generating response:  31%|███▏      | 401/1280 [3:57:56<4:51:29, 19.90s/it]generating response:  31%|███▏      | 402/1280 [3:58:59<6:06:07, 25.02s/it]generating response:  31%|███▏      | 403/1280 [4:00:03<7:27:01, 30.58s/it]generating response:  32%|███▏      | 404/1280 [4:01:08<8:52:07, 36.45s/it]generating response:  32%|███▏      | 406/1280 [4:02:11<8:28:55, 34.94s/it]generating response:  32%|███▏      | 407/1280 [4:03:16<9:51:36, 40.66s/it]generating response:  32%|███▏      | 409/1280 [4:04:19<9:02:56, 37.40s/it]generating response:  32%|███▏      | 410/1280 [4:05:22<10:16:41, 42.53s/it]generating response:  32%|███▏      | 411/1280 [4:06:26<11:26:33, 47.40s/it]generating response:  32%|███▏      | 412/1280 [4:07:30<12:22:42, 51.34s/it]generating response:  33%|███▎      | 418/1280 [4:08:34<5:43:29, 23.91s/it] generating response:  33%|███▎      | 419/1280 [4:09:38<7:02:09, 29.42s/it]generating response:  33%|███▎      | 420/1280 [4:10:41<8:21:52, 35.01s/it]generating response:  33%|███▎      | 425/1280 [4:11:45<5:27:20, 22.97s/it]generating response:  33%|███▎      | 426/1280 [4:12:48<6:43:40, 28.36s/it]generating response:  33%|███▎      | 427/1280 [4:13:52<8:04:58, 34.11s/it]generating response:  33%|███▎      | 428/1280 [4:14:57<9:26:38, 39.90s/it]generating response:  34%|███▍      | 432/1280 [4:16:01<6:28:10, 27.47s/it]generating response:  34%|███▍      | 433/1280 [4:17:03<7:44:32, 32.91s/it]generating response:  34%|███▍      | 434/1280 [4:18:06<9:01:02, 38.37s/it]generating response:  34%|███▍      | 435/1280 [4:19:09<10:10:59, 43.38s/it]generating response:  34%|███▍      | 436/1280 [4:20:11<11:11:36, 47.75s/it]generating response:  34%|███▍      | 441/1280 [4:21:14<6:02:47, 25.94s/it] generating response:  35%|███▍      | 442/1280 [4:22:17<7:21:09, 31.59s/it]generating response:  35%|███▍      | 443/1280 [4:23:21<8:38:44, 37.19s/it]generating response:  35%|███▍      | 444/1280 [4:24:24<9:51:19, 42.44s/it]generating response:  35%|███▍      | 446/1280 [4:25:27<8:55:13, 38.51s/it]generating response:  35%|███▍      | 447/1280 [4:26:30<10:04:32, 43.54s/it]generating response:  35%|███▌      | 450/1280 [4:27:32<7:32:34, 32.72s/it] generating response:  35%|███▌      | 451/1280 [4:28:35<8:49:20, 38.31s/it]generating response:  35%|███▌      | 452/1280 [4:29:38<9:58:42, 43.38s/it]generating response:  36%|███▌      | 457/1280 [4:30:42<5:44:22, 25.11s/it]generating response:  36%|███▌      | 458/1280 [4:31:45<7:00:28, 30.69s/it]generating response:  36%|███▌      | 459/1280 [4:32:49<8:18:15, 36.41s/it]generating response:  36%|███▌      | 460/1280 [4:33:53<9:33:19, 41.95s/it]generating response:  36%|███▋      | 465/1280 [4:34:59<5:40:25, 25.06s/it]generating response:  36%|███▋      | 466/1280 [4:36:01<6:51:39, 30.34s/it]generating response:  36%|███▋      | 467/1280 [4:37:04<8:07:33, 35.98s/it]generating response:  37%|███▋      | 473/1280 [4:38:09<4:42:27, 21.00s/it]generating response:  37%|███▋      | 474/1280 [4:39:11<5:51:17, 26.15s/it]generating response:  37%|███▋      | 475/1280 [4:40:14<7:04:27, 31.64s/it]generating response:  37%|███▋      | 476/1280 [4:41:18<8:19:52, 37.30s/it]generating response:  38%|███▊      | 482/1280 [4:42:20<4:40:47, 21.11s/it]generating response:  38%|███▊      | 483/1280 [4:43:23<5:50:04, 26.35s/it]generating response:  38%|███▊      | 484/1280 [4:44:26<7:04:09, 31.97s/it]generating response:  38%|███▊      | 489/1280 [4:45:31<4:50:49, 22.06s/it]generating response:  38%|███▊      | 490/1280 [4:46:35<6:02:48, 27.55s/it]generating response:  38%|███▊      | 491/1280 [4:47:40<7:18:21, 33.34s/it]generating response:  38%|███▊      | 492/1280 [4:48:46<8:34:45, 39.19s/it]generating response:  39%|███▊      | 495/1280 [4:49:50<6:51:34, 31.46s/it]generating response:  39%|███▉      | 497/1280 [4:50:53<6:50:56, 31.49s/it]generating response:  39%|███▉      | 498/1280 [4:51:57<8:04:12, 37.15s/it]generating response:  39%|███▉      | 499/1280 [4:53:02<9:14:14, 42.58s/it]generating response:  39%|███▉      | 500/1280 [4:54:06<10:14:36, 47.28s/it]generating response:  39%|███▉      | 505/1280 [4:55:08<5:35:39, 25.99s/it] generating response:  40%|███▉      | 506/1280 [4:56:11<6:45:53, 31.46s/it]generating response:  40%|███▉      | 507/1280 [4:57:13<7:54:25, 36.82s/it]generating response:  40%|███▉      | 508/1280 [4:58:15<8:58:15, 41.83s/it]generating response:  40%|███▉      | 509/1280 [4:59:18<9:57:58, 46.54s/it]generating response:  40%|███▉      | 510/1280 [5:00:21<10:48:20, 50.52s/it]generating response:  40%|███▉      | 511/1280 [5:01:23<11:26:14, 53.54s/it]generating response:  40%|████      | 514/1280 [5:02:27<7:48:23, 36.69s/it] generating response:  40%|████      | 515/1280 [5:03:30<8:54:41, 41.94s/it]generating response:  40%|████      | 516/1280 [5:04:34<9:56:41, 46.86s/it]generating response:  41%|████      | 521/1280 [5:05:37<5:27:04, 25.86s/it]generating response:  41%|████      | 522/1280 [5:06:41<6:37:55, 31.50s/it]generating response:  41%|████      | 523/1280 [5:07:45<7:49:16, 37.20s/it]generating response:  41%|████      | 524/1280 [5:08:48<8:54:59, 42.46s/it]generating response:  41%|████      | 526/1280 [5:09:52<8:03:58, 38.51s/it]generating response:  41%|████▏     | 528/1280 [5:10:55<7:33:54, 36.22s/it]generating response:  41%|████▏     | 529/1280 [5:11:58<8:37:53, 41.38s/it]generating response:  41%|████▏     | 530/1280 [5:13:01<9:37:14, 46.18s/it]generating response:  41%|████▏     | 531/1280 [5:14:06<10:32:12, 50.64s/it]generating response:  42%|████▏     | 532/1280 [5:15:09<11:11:38, 53.87s/it]generating response:  42%|████▏     | 536/1280 [5:16:13<6:29:50, 31.44s/it] generating response:  42%|████▏     | 537/1280 [5:17:16<7:37:17, 36.93s/it]generating response:  42%|████▏     | 538/1280 [5:18:19<8:40:51, 42.12s/it]generating response:  42%|████▏     | 539/1280 [5:19:22<9:37:08, 46.73s/it]generating response:  42%|████▏     | 540/1280 [5:20:28<10:32:35, 51.29s/it]generating response:  42%|████▏     | 541/1280 [5:21:31<11:10:19, 54.42s/it]generating response:  42%|████▏     | 542/1280 [5:22:35<11:39:58, 56.91s/it]generating response:  42%|████▏     | 543/1280 [5:23:38<12:01:26, 58.73s/it]generating response:  43%|████▎     | 545/1280 [5:24:40<9:28:23, 46.40s/it] generating response:  43%|████▎     | 546/1280 [5:25:42<10:13:20, 50.14s/it]generating response:  43%|████▎     | 547/1280 [5:26:44<10:49:32, 53.17s/it]generating response:  43%|████▎     | 548/1280 [5:27:46<11:16:20, 55.44s/it]generating response:  43%|████▎     | 553/1280 [5:28:49<5:31:54, 27.39s/it] generating response:  43%|████▎     | 554/1280 [5:29:51<6:38:14, 32.91s/it]generating response:  43%|████▎     | 555/1280 [5:30:55<7:44:44, 38.46s/it]generating response:  43%|████▎     | 556/1280 [5:31:57<8:45:27, 43.55s/it]generating response:  44%|████▍     | 561/1280 [5:33:00<4:59:24, 24.98s/it]generating response:  44%|████▍     | 562/1280 [5:34:03<6:04:54, 30.49s/it]generating response:  44%|████▍     | 563/1280 [5:35:07<7:13:27, 36.27s/it]generating response:  44%|████▍     | 564/1280 [5:36:08<8:12:29, 41.27s/it]generating response:  44%|████▍     | 565/1280 [5:37:12<9:09:55, 46.15s/it]generating response:  44%|████▍     | 567/1280 [5:38:14<8:00:30, 40.44s/it]generating response:  44%|████▍     | 569/1280 [5:39:18<7:21:53, 37.29s/it]generating response:  45%|████▍     | 570/1280 [5:40:20<8:21:53, 42.41s/it]generating response:  45%|████▍     | 571/1280 [5:41:23<9:14:24, 46.92s/it]generating response:  45%|████▍     | 572/1280 [5:42:26<9:59:37, 50.82s/it]generating response:  45%|████▌     | 577/1280 [5:43:27<5:09:31, 26.42s/it]generating response:  45%|████▌     | 578/1280 [5:44:28<6:10:20, 31.65s/it]generating response:  45%|████▌     | 579/1280 [5:45:29<7:12:21, 37.01s/it]generating response:  45%|████▌     | 580/1280 [5:46:31<8:10:46, 42.07s/it]generating response:  46%|████▌     | 583/1280 [5:47:32<6:10:48, 31.92s/it]generating response:  46%|████▌     | 585/1280 [5:48:34<6:06:51, 31.67s/it]generating response:  46%|████▌     | 586/1280 [5:49:38<7:12:44, 37.41s/it]generating response:  46%|████▌     | 587/1280 [5:50:41<8:13:42, 42.74s/it]generating response:  46%|████▌     | 588/1280 [5:51:43<9:02:13, 47.01s/it]generating response:  46%|████▌     | 589/1280 [5:52:46<9:47:22, 51.00s/it]generating response:  46%|████▋     | 593/1280 [5:53:50<5:49:18, 30.51s/it]generating response:  46%|████▋     | 594/1280 [5:54:53<6:53:03, 36.13s/it]generating response:  46%|████▋     | 595/1280 [5:55:57<7:56:51, 41.77s/it]generating response:  47%|████▋     | 596/1280 [5:57:01<8:51:20, 46.61s/it]generating response:  47%|████▋     | 599/1280 [5:58:05<6:29:04, 34.28s/it]generating response:  47%|████▋     | 601/1280 [5:59:09<6:19:30, 33.54s/it]generating response:  47%|████▋     | 602/1280 [6:00:11<7:19:40, 38.91s/it]generating response:  47%|████▋     | 603/1280 [6:01:15<8:17:59, 44.14s/it]generating response:  47%|████▋     | 604/1280 [6:02:19<9:07:00, 48.55s/it]generating response:  48%|████▊     | 609/1280 [6:03:22<4:54:22, 26.32s/it]generating response:  48%|████▊     | 610/1280 [6:04:24<5:53:21, 31.64s/it]generating response:  48%|████▊     | 611/1280 [6:05:28<6:55:40, 37.28s/it]generating response:  48%|████▊     | 612/1280 [6:06:29<7:49:23, 42.16s/it]generating response:  48%|████▊     | 613/1280 [6:07:30<8:36:24, 46.45s/it]generating response:  48%|████▊     | 617/1280 [6:08:34<5:24:21, 29.35s/it]generating response:  48%|████▊     | 618/1280 [6:09:38<6:26:59, 35.07s/it]generating response:  48%|████▊     | 619/1280 [6:10:41<7:26:21, 40.52s/it]generating response:  48%|████▊     | 620/1280 [6:11:45<8:21:12, 45.56s/it]generating response:  49%|████▉     | 625/1280 [6:12:47<4:38:10, 25.48s/it]generating response:  49%|████▉     | 626/1280 [6:13:49<5:36:35, 30.88s/it]generating response:  49%|████▉     | 627/1280 [6:14:52<6:36:43, 36.45s/it]generating response:  49%|████▉     | 628/1280 [6:15:56<7:35:21, 41.90s/it]generating response:  49%|████▉     | 633/1280 [6:17:00<4:27:34, 24.81s/it]generating response:  50%|████▉     | 634/1280 [6:18:03<5:26:05, 30.29s/it]generating response:  50%|████▉     | 635/1280 [6:19:07<6:27:02, 36.00s/it]generating response:  50%|████▉     | 636/1280 [6:20:11<7:25:10, 41.48s/it]generating response:  50%|█████     | 642/1280 [6:21:14<3:54:22, 22.04s/it]generating response:  50%|█████     | 643/1280 [6:22:17<4:50:50, 27.40s/it]generating response:  50%|█████     | 644/1280 [6:23:22<5:52:32, 33.26s/it]generating response:  51%|█████     | 649/1280 [6:24:27<3:57:43, 22.60s/it]generating response:  51%|█████     | 650/1280 [6:25:30<4:53:21, 27.94s/it]generating response:  51%|█████     | 651/1280 [6:26:35<5:52:52, 33.66s/it]generating response:  51%|█████     | 652/1280 [6:27:39<6:50:27, 39.22s/it]generating response:  51%|█████▏    | 657/1280 [6:28:43<4:11:44, 24.24s/it]generating response:  51%|█████▏    | 658/1280 [6:29:47<5:08:46, 29.79s/it]generating response:  51%|█████▏    | 659/1280 [6:30:51<6:08:17, 35.58s/it]generating response:  52%|█████▏    | 660/1280 [6:31:56<7:04:38, 41.09s/it]generating response:  52%|█████▏    | 663/1280 [6:33:00<5:30:58, 32.19s/it]generating response:  52%|█████▏    | 665/1280 [6:34:04<5:29:12, 32.12s/it]generating response:  52%|█████▏    | 666/1280 [6:35:08<6:27:48, 37.90s/it]generating response:  52%|█████▏    | 667/1280 [6:36:12<7:20:58, 43.16s/it]generating response:  52%|█████▏    | 668/1280 [6:37:16<8:06:04, 47.66s/it]generating response:  52%|█████▏    | 671/1280 [6:38:20<5:53:37, 34.84s/it]generating response:  53%|█████▎    | 673/1280 [6:39:25<5:44:08, 34.02s/it]generating response:  53%|█████▎    | 674/1280 [6:40:29<6:40:40, 39.67s/it]generating response:  53%|█████▎    | 681/1280 [6:41:34<3:18:32, 19.89s/it]generating response:  53%|█████▎    | 682/1280 [6:42:38<4:09:56, 25.08s/it]generating response:  53%|█████▎    | 683/1280 [6:43:42<5:05:47, 30.73s/it]generating response:  53%|█████▎    | 684/1280 [6:44:47<6:02:34, 36.50s/it]generating response:  54%|█████▍    | 689/1280 [6:45:51<3:51:33, 23.51s/it]generating response:  54%|█████▍    | 690/1280 [6:46:55<4:45:36, 29.05s/it]generating response:  54%|█████▍    | 691/1280 [6:48:00<5:40:57, 34.73s/it]generating response:  54%|█████▍    | 692/1280 [6:49:03<6:33:57, 40.20s/it]generating response:  54%|█████▍    | 697/1280 [6:50:07<3:57:41, 24.46s/it]generating response:  55%|█████▍    | 698/1280 [6:51:12<4:51:53, 30.09s/it]generating response:  55%|█████▍    | 699/1280 [6:52:16<5:46:59, 35.83s/it]generating response:  55%|█████▍    | 700/1280 [6:53:21<6:41:06, 41.49s/it]generating response:  55%|█████▍    | 703/1280 [6:54:25<5:11:29, 32.39s/it]generating response:  55%|█████▌    | 706/1280 [6:55:30<4:29:16, 28.15s/it]generating response:  55%|█████▌    | 707/1280 [6:56:35<5:24:06, 33.94s/it]generating response:  55%|█████▌    | 708/1280 [6:57:39<6:15:50, 39.42s/it]generating response:  56%|█████▌    | 713/1280 [6:58:43<3:50:01, 24.34s/it]generating response:  56%|█████▌    | 714/1280 [6:59:47<4:41:19, 29.82s/it]generating response:  56%|█████▌    | 716/1280 [7:00:51<4:46:53, 30.52s/it]generating response:  56%|█████▋    | 721/1280 [7:01:55<3:20:49, 21.56s/it]generating response:  56%|█████▋    | 722/1280 [7:02:58<4:09:08, 26.79s/it]generating response:  56%|█████▋    | 723/1280 [7:04:01<4:59:30, 32.26s/it]generating response:  57%|█████▋    | 724/1280 [7:05:04<5:50:00, 37.77s/it]generating response:  57%|█████▋    | 725/1280 [7:06:07<6:36:49, 42.90s/it]generating response:  57%|█████▋    | 727/1280 [7:07:09<5:55:53, 38.61s/it]generating response:  57%|█████▋    | 729/1280 [7:08:12<5:31:29, 36.10s/it]generating response:  57%|█████▋    | 730/1280 [7:09:14<6:17:56, 41.23s/it]generating response:  57%|█████▋    | 731/1280 [7:10:16<6:59:44, 45.87s/it]generating response:  57%|█████▋    | 732/1280 [7:11:20<7:37:04, 50.05s/it]generating response:  58%|█████▊    | 737/1280 [7:12:23<3:59:30, 26.47s/it]generating response:  58%|█████▊    | 738/1280 [7:13:26<4:50:12, 32.13s/it]generating response:  58%|█████▊    | 739/1280 [7:14:30<5:40:25, 37.76s/it]generating response:  58%|█████▊    | 740/1280 [7:15:34<6:27:01, 43.00s/it]generating response:  58%|█████▊    | 745/1280 [7:16:36<3:42:09, 24.91s/it]generating response:  58%|█████▊    | 746/1280 [7:17:39<4:31:14, 30.48s/it]generating response:  58%|█████▊    | 747/1280 [7:18:42<5:20:11, 36.04s/it]generating response:  58%|█████▊    | 748/1280 [7:19:45<6:06:48, 41.37s/it]generating response:  59%|█████▊    | 749/1280 [7:20:49<6:48:47, 46.19s/it]generating response:  59%|█████▊    | 750/1280 [7:21:52<7:24:44, 50.35s/it]generating response:  59%|█████▊    | 751/1280 [7:22:56<7:52:50, 53.63s/it]generating response:  59%|█████▉    | 753/1280 [7:24:00<6:31:03, 44.52s/it]generating response:  59%|█████▉    | 754/1280 [7:25:03<7:08:46, 48.91s/it]generating response:  59%|█████▉    | 755/1280 [7:26:06<7:38:32, 52.40s/it]generating response:  59%|█████▉    | 756/1280 [7:27:09<8:02:10, 55.21s/it]generating response:  59%|█████▉    | 757/1280 [7:28:12<8:20:21, 57.40s/it]generating response:  59%|█████▉    | 758/1280 [7:29:16<8:34:24, 59.13s/it]generating response:  59%|█████▉    | 759/1280 [7:30:19<8:43:57, 60.34s/it]generating response:  59%|█████▉    | 761/1280 [7:31:23<6:50:29, 47.46s/it]generating response:  60%|█████▉    | 762/1280 [7:32:25<7:21:03, 51.09s/it]generating response:  60%|█████▉    | 764/1280 [7:33:30<6:13:03, 43.38s/it]generating response:  60%|██████    | 769/1280 [7:34:31<3:31:51, 24.88s/it]generating response:  60%|██████    | 770/1280 [7:35:33<4:17:04, 30.24s/it]generating response:  60%|██████    | 771/1280 [7:36:36<5:04:32, 35.90s/it]generating response:  60%|██████    | 772/1280 [7:37:37<5:45:59, 40.86s/it]generating response:  60%|██████    | 774/1280 [7:38:39<5:15:21, 37.40s/it]generating response:  61%|██████    | 777/1280 [7:39:42<4:13:30, 30.24s/it]generating response:  61%|██████    | 778/1280 [7:40:45<5:00:03, 35.86s/it]generating response:  61%|██████    | 779/1280 [7:41:48<5:44:15, 41.23s/it]generating response:  61%|██████    | 780/1280 [7:42:52<6:24:18, 46.12s/it]generating response:  61%|██████▏   | 785/1280 [7:43:55<3:31:45, 25.67s/it]generating response:  61%|██████▏   | 786/1280 [7:44:59<4:17:49, 31.31s/it]generating response:  61%|██████▏   | 787/1280 [7:46:03<5:04:06, 37.01s/it]generating response:  62%|██████▏   | 788/1280 [7:47:05<5:45:42, 42.16s/it]generating response:  62%|██████▏   | 793/1280 [7:48:08<3:21:12, 24.79s/it]generating response:  62%|██████▏   | 794/1280 [7:49:12<4:05:44, 30.34s/it]generating response:  62%|██████▏   | 795/1280 [7:50:16<4:51:50, 36.10s/it]generating response:  62%|██████▏   | 796/1280 [7:51:19<5:33:56, 41.40s/it]generating response:  63%|██████▎   | 801/1280 [7:52:22<3:16:34, 24.62s/it]generating response:  63%|██████▎   | 802/1280 [7:53:24<3:58:38, 29.96s/it]generating response:  63%|██████▎   | 803/1280 [7:54:27<4:42:04, 35.48s/it]generating response:  63%|██████▎   | 804/1280 [7:55:28<5:21:31, 40.53s/it]generating response:  63%|██████▎   | 805/1280 [7:56:31<5:58:37, 45.30s/it]generating response:  63%|██████▎   | 806/1280 [7:57:31<6:26:47, 48.96s/it]generating response:  63%|██████▎   | 807/1280 [7:58:33<6:52:10, 52.29s/it]generating response:  63%|██████▎   | 808/1280 [7:59:35<7:11:28, 54.85s/it]generating response:  63%|██████▎   | 809/1280 [8:00:37<7:25:59, 56.81s/it]generating response:  63%|██████▎   | 810/1280 [8:01:40<7:37:29, 58.40s/it]generating response:  63%|██████▎   | 811/1280 [8:02:42<7:45:22, 59.54s/it]generating response:  63%|██████▎   | 812/1280 [8:03:46<7:54:05, 60.78s/it]generating response:  64%|██████▍   | 817/1280 [8:04:49<3:38:21, 28.30s/it]generating response:  64%|██████▍   | 818/1280 [8:05:52<4:20:22, 33.81s/it]generating response:  64%|██████▍   | 819/1280 [8:06:55<5:02:16, 39.34s/it]generating response:  64%|██████▍   | 820/1280 [8:07:59<5:42:17, 44.65s/it]generating response:  64%|██████▍   | 825/1280 [8:09:03<3:12:37, 25.40s/it]generating response:  65%|██████▍   | 826/1280 [8:10:06<3:54:38, 31.01s/it]generating response:  65%|██████▍   | 827/1280 [8:11:11<4:37:45, 36.79s/it]generating response:  65%|██████▍   | 828/1280 [8:12:15<5:17:49, 42.19s/it]generating response:  65%|██████▍   | 829/1280 [8:13:18<5:52:31, 46.90s/it]generating response:  65%|██████▍   | 830/1280 [8:14:21<6:21:07, 50.82s/it]generating response:  65%|██████▍   | 831/1280 [8:15:26<6:46:07, 54.27s/it]generating response:  65%|██████▌   | 832/1280 [8:16:29<7:02:51, 56.63s/it]generating response:  65%|██████▌   | 833/1280 [8:17:32<7:15:32, 58.46s/it]generating response:  65%|██████▌   | 834/1280 [8:18:37<7:26:57, 60.13s/it]generating response:  65%|██████▌   | 835/1280 [8:19:41<7:34:47, 61.32s/it]generating response:  65%|██████▌   | 836/1280 [8:20:47<7:45:14, 62.87s/it]generating response:  66%|██████▌   | 840/1280 [8:21:51<4:05:43, 33.51s/it]generating response:  66%|██████▌   | 842/1280 [8:22:56<4:01:53, 33.14s/it]generating response:  66%|██████▌   | 844/1280 [8:23:59<3:57:51, 32.73s/it]generating response:  66%|██████▌   | 845/1280 [8:25:03<4:37:56, 38.34s/it]generating response:  66%|██████▋   | 848/1280 [8:26:07<3:42:29, 30.90s/it]generating response:  66%|██████▋   | 849/1280 [8:27:09<4:19:53, 36.18s/it]generating response:  66%|██████▋   | 850/1280 [8:28:11<4:56:31, 41.38s/it]generating response:  66%|██████▋   | 851/1280 [8:29:14<5:30:18, 46.20s/it]generating response:  67%|██████▋   | 852/1280 [8:30:17<5:57:34, 50.13s/it]generating response:  67%|██████▋   | 855/1280 [8:31:21<4:11:29, 35.51s/it]generating response:  67%|██████▋   | 858/1280 [8:32:23<3:26:31, 29.36s/it]generating response:  67%|██████▋   | 859/1280 [8:33:25<4:04:08, 34.79s/it]generating response:  68%|██████▊   | 865/1280 [8:34:26<2:20:13, 20.27s/it]generating response:  68%|██████▊   | 866/1280 [8:35:29<2:56:16, 25.55s/it]generating response:  68%|██████▊   | 867/1280 [8:36:32<3:33:43, 31.05s/it]generating response:  68%|██████▊   | 868/1280 [8:37:33<4:10:02, 36.41s/it]generating response:  68%|██████▊   | 873/1280 [8:38:37<2:37:36, 23.23s/it]generating response:  68%|██████▊   | 874/1280 [8:39:40<3:14:18, 28.72s/it]generating response:  68%|██████▊   | 875/1280 [8:40:44<3:52:58, 34.52s/it]generating response:  69%|██████▉   | 882/1280 [8:41:47<2:03:40, 18.65s/it]generating response:  69%|██████▉   | 883/1280 [8:42:50<2:36:17, 23.62s/it]generating response:  69%|██████▉   | 884/1280 [8:43:53<3:12:35, 29.18s/it]generating response:  69%|██████▉   | 889/1280 [8:44:58<2:17:17, 21.07s/it]generating response:  70%|██████▉   | 890/1280 [8:46:02<2:51:39, 26.41s/it]generating response:  70%|██████▉   | 891/1280 [8:47:06<3:27:42, 32.04s/it]generating response:  70%|██████▉   | 892/1280 [8:48:10<4:03:55, 37.72s/it]generating response:  70%|███████   | 896/1280 [8:49:13<2:51:09, 26.74s/it]generating response:  70%|███████   | 897/1280 [8:50:17<3:26:34, 32.36s/it]generating response:  70%|███████   | 898/1280 [8:51:21<4:02:42, 38.12s/it]generating response:  70%|███████   | 899/1280 [8:52:24<4:33:31, 43.07s/it]generating response:  70%|███████   | 901/1280 [8:53:27<4:05:36, 38.88s/it]generating response:  71%|███████   | 904/1280 [8:54:29<3:13:19, 30.85s/it]generating response:  71%|███████   | 905/1280 [8:55:34<3:49:14, 36.68s/it]generating response:  71%|███████   | 906/1280 [8:56:38<4:22:55, 42.18s/it]generating response:  71%|███████   | 907/1280 [8:57:43<4:53:12, 47.17s/it]generating response:  71%|███████▏  | 913/1280 [8:58:46<2:21:55, 23.20s/it]generating response:  71%|███████▏  | 914/1280 [8:59:48<2:53:41, 28.47s/it]generating response:  71%|███████▏  | 915/1280 [9:00:52<3:28:09, 34.22s/it]generating response:  72%|███████▏  | 916/1280 [9:01:55<3:59:54, 39.55s/it]generating response:  72%|███████▏  | 919/1280 [9:02:59<3:08:47, 31.38s/it]generating response:  72%|███████▏  | 921/1280 [9:04:04<3:09:33, 31.68s/it]generating response:  72%|███████▏  | 922/1280 [9:05:08<3:43:48, 37.51s/it]generating response:  72%|███████▏  | 923/1280 [9:06:14<4:16:46, 43.16s/it]generating response:  72%|███████▏  | 924/1280 [9:07:18<4:43:44, 47.82s/it]generating response:  73%|███████▎  | 929/1280 [9:08:22<2:33:42, 26.27s/it]generating response:  73%|███████▎  | 930/1280 [9:09:25<3:05:34, 31.81s/it]generating response:  73%|███████▎  | 931/1280 [9:10:29<3:38:03, 37.49s/it]generating response:  73%|███████▎  | 932/1280 [9:11:34<4:09:22, 43.00s/it]generating response:  73%|███████▎  | 935/1280 [9:12:38<3:09:25, 32.94s/it]generating response:  73%|███████▎  | 937/1280 [9:13:39<3:04:26, 32.26s/it]generating response:  73%|███████▎  | 938/1280 [9:14:41<3:33:47, 37.51s/it]generating response:  73%|███████▎  | 939/1280 [9:15:45<4:04:15, 42.98s/it]generating response:  73%|███████▎  | 940/1280 [9:16:48<4:29:12, 47.51s/it]generating response:  74%|███████▍  | 945/1280 [9:17:50<2:24:19, 25.85s/it]generating response:  74%|███████▍  | 946/1280 [9:18:52<2:53:30, 31.17s/it]generating response:  74%|███████▍  | 947/1280 [9:19:56<3:25:19, 37.00s/it]generating response:  74%|███████▍  | 948/1280 [9:20:57<3:51:49, 41.90s/it]generating response:  74%|███████▍  | 953/1280 [9:22:02<2:15:02, 24.78s/it]generating response:  75%|███████▍  | 954/1280 [9:23:06<2:45:23, 30.44s/it]generating response:  75%|███████▍  | 955/1280 [9:24:09<3:15:24, 36.08s/it]generating response:  75%|███████▍  | 956/1280 [9:25:13<3:44:00, 41.48s/it]generating response:  75%|███████▌  | 961/1280 [9:26:14<2:09:55, 24.44s/it]generating response:  75%|███████▌  | 962/1280 [9:27:16<2:37:44, 29.76s/it]generating response:  75%|███████▌  | 963/1280 [9:28:20<3:07:41, 35.52s/it]generating response:  75%|███████▌  | 964/1280 [9:29:21<3:34:06, 40.65s/it]generating response:  75%|███████▌  | 966/1280 [9:30:23<3:14:11, 37.11s/it]generating response:  76%|███████▌  | 969/1280 [9:31:25<2:35:29, 30.00s/it]generating response:  76%|███████▌  | 970/1280 [9:32:28<3:03:57, 35.60s/it]generating response:  76%|███████▌  | 971/1280 [9:33:30<3:30:05, 40.80s/it]generating response:  76%|███████▌  | 972/1280 [9:34:33<3:54:16, 45.64s/it]generating response:  76%|███████▋  | 977/1280 [9:35:35<2:08:16, 25.40s/it]generating response:  76%|███████▋  | 978/1280 [9:36:38<2:35:46, 30.95s/it]generating response:  76%|███████▋  | 979/1280 [9:37:42<3:04:03, 36.69s/it]generating response:  77%|███████▋  | 980/1280 [9:38:45<3:29:48, 41.96s/it]generating response:  77%|███████▋  | 985/1280 [9:39:48<2:01:23, 24.69s/it]generating response:  77%|███████▋  | 986/1280 [9:40:51<2:28:16, 30.26s/it]generating response:  77%|███████▋  | 987/1280 [9:41:56<2:56:32, 36.15s/it]generating response:  77%|███████▋  | 988/1280 [9:42:59<3:21:38, 41.43s/it]generating response:  78%|███████▊  | 994/1280 [9:44:03<1:45:28, 22.13s/it]generating response:  78%|███████▊  | 995/1280 [9:45:06<2:10:28, 27.47s/it]generating response:  78%|███████▊  | 996/1280 [9:46:09<2:36:35, 33.08s/it]generating response:  78%|███████▊  | 1001/1280 [9:47:12<1:43:35, 22.28s/it]generating response:  78%|███████▊  | 1002/1280 [9:48:16<2:08:21, 27.70s/it]generating response:  78%|███████▊  | 1003/1280 [9:49:19<2:33:48, 33.32s/it]generating response:  78%|███████▊  | 1004/1280 [9:50:23<2:59:13, 38.96s/it]generating response:  79%|███████▉  | 1009/1280 [9:51:27<1:48:28, 24.02s/it]generating response:  79%|███████▉  | 1010/1280 [9:52:32<2:13:57, 29.77s/it]generating response:  79%|███████▉  | 1011/1280 [9:53:35<2:38:15, 35.30s/it]generating response:  79%|███████▉  | 1012/1280 [9:54:38<3:01:30, 40.64s/it]generating response:  79%|███████▉  | 1017/1280 [9:55:42<1:47:20, 24.49s/it]generating response:  80%|███████▉  | 1018/1280 [9:56:45<2:11:14, 30.05s/it]generating response:  80%|███████▉  | 1019/1280 [9:57:49<2:35:01, 35.64s/it]generating response:  80%|███████▉  | 1020/1280 [9:58:52<2:57:59, 41.07s/it]generating response:  80%|████████  | 1026/1280 [9:59:56<1:33:25, 22.07s/it]generating response:  80%|████████  | 1027/1280 [10:01:00<1:56:10, 27.55s/it]generating response:  80%|████████  | 1028/1280 [10:02:04<2:19:25, 33.20s/it]generating response:  81%|████████  | 1031/1280 [10:03:09<1:58:18, 28.51s/it]generating response:  81%|████████  | 1034/1280 [10:04:12<1:46:05, 25.87s/it]generating response:  81%|████████  | 1035/1280 [10:05:18<2:09:15, 31.66s/it]generating response:  81%|████████  | 1036/1280 [10:06:21<2:31:38, 37.29s/it]generating response:  81%|████████▏ | 1041/1280 [10:07:25<1:34:22, 23.69s/it]generating response:  81%|████████▏ | 1042/1280 [10:08:31<1:56:32, 29.38s/it]generating response:  81%|████████▏ | 1043/1280 [10:09:34<2:18:11, 34.99s/it]generating response:  82%|████████▏ | 1044/1280 [10:10:38<2:39:07, 40.45s/it]generating response:  82%|████████▏ | 1047/1280 [10:11:41<2:03:14, 31.74s/it]generating response:  82%|████████▏ | 1049/1280 [10:12:44<2:02:04, 31.71s/it]generating response:  82%|████████▏ | 1050/1280 [10:13:48<2:23:21, 37.40s/it]generating response:  82%|████████▏ | 1051/1280 [10:14:51<2:42:19, 42.53s/it]generating response:  82%|████████▏ | 1052/1280 [10:15:55<2:59:38, 47.28s/it]generating response:  83%|████████▎ | 1057/1280 [10:17:00<1:37:31, 26.24s/it]generating response:  83%|████████▎ | 1058/1280 [10:18:05<1:58:00, 31.90s/it]generating response:  83%|████████▎ | 1059/1280 [10:19:09<2:18:27, 37.59s/it]generating response:  83%|████████▎ | 1060/1280 [10:20:13<2:37:26, 42.94s/it]generating response:  83%|████████▎ | 1064/1280 [10:21:17<1:42:48, 28.56s/it]generating response:  83%|████████▎ | 1065/1280 [10:22:21<2:02:53, 34.30s/it]generating response:  83%|████████▎ | 1066/1280 [10:23:26<2:22:39, 40.00s/it]generating response:  83%|████████▎ | 1067/1280 [10:24:30<2:39:24, 44.90s/it]generating response:  84%|████████▍ | 1073/1280 [10:25:33<1:18:43, 22.82s/it]generating response:  84%|████████▍ | 1074/1280 [10:26:37<1:37:09, 28.30s/it]generating response:  84%|████████▍ | 1075/1280 [10:27:41<1:56:13, 34.02s/it]generating response:  84%|████████▍ | 1076/1280 [10:28:45<2:14:26, 39.54s/it]generating response:  84%|████████▍ | 1077/1280 [10:29:49<2:31:04, 44.65s/it]generating response:  84%|████████▍ | 1081/1280 [10:30:53<1:36:10, 29.00s/it]generating response:  85%|████████▍ | 1082/1280 [10:31:56<1:54:21, 34.65s/it]generating response:  85%|████████▍ | 1083/1280 [10:33:00<2:11:36, 40.08s/it]generating response:  85%|████████▌ | 1089/1280 [10:34:05<1:09:56, 21.97s/it]generating response:  85%|████████▌ | 1090/1280 [10:35:08<1:26:17, 27.25s/it]generating response:  85%|████████▌ | 1091/1280 [10:36:11<1:43:39, 32.91s/it]generating response:  86%|████████▌ | 1097/1280 [10:37:14<1:01:11, 20.06s/it]generating response:  86%|████████▌ | 1098/1280 [10:38:16<1:16:04, 25.08s/it]generating response:  86%|████████▌ | 1099/1280 [10:39:17<1:31:30, 30.34s/it]generating response:  86%|████████▌ | 1100/1280 [10:40:20<1:47:48, 35.93s/it]generating response:  86%|████████▋ | 1105/1280 [10:41:23<1:07:15, 23.06s/it]generating response:  86%|████████▋ | 1106/1280 [10:42:27<1:23:00, 28.62s/it]generating response:  86%|████████▋ | 1107/1280 [10:43:31<1:39:14, 34.42s/it]generating response:  87%|████████▋ | 1113/1280 [10:44:35<57:12, 20.55s/it]  generating response:  87%|████████▋ | 1114/1280 [10:45:39<1:11:41, 25.91s/it]generating response:  87%|████████▋ | 1115/1280 [10:46:42<1:26:16, 31.37s/it]generating response:  87%|████████▋ | 1116/1280 [10:47:46<1:41:17, 37.06s/it]generating response:  87%|████████▋ | 1117/1280 [10:48:49<1:54:42, 42.23s/it]generating response:  87%|████████▋ | 1118/1280 [10:49:53<2:07:14, 47.13s/it]generating response:  87%|████████▋ | 1119/1280 [10:50:57<2:17:23, 51.20s/it]generating response:  88%|████████▊ | 1121/1280 [10:52:00<1:54:29, 43.21s/it]generating response:  88%|████████▊ | 1122/1280 [10:53:04<2:05:48, 47.78s/it]generating response:  88%|████████▊ | 1123/1280 [10:54:07<2:14:55, 51.56s/it]generating response:  88%|████████▊ | 1124/1280 [10:55:11<2:22:08, 54.67s/it]generating response:  88%|████████▊ | 1129/1280 [10:56:13<1:08:45, 27.32s/it]generating response:  88%|████████▊ | 1130/1280 [10:57:17<1:22:32, 33.02s/it]generating response:  88%|████████▊ | 1131/1280 [10:58:19<1:35:20, 38.39s/it]generating response:  89%|████████▉ | 1137/1280 [10:59:22<50:56, 21.38s/it]  generating response:  89%|████████▉ | 1138/1280 [11:00:27<1:03:29, 26.83s/it]generating response:  89%|████████▉ | 1139/1280 [11:01:31<1:16:34, 32.58s/it]generating response:  89%|████████▉ | 1140/1280 [11:02:35<1:29:18, 38.27s/it]generating response:  89%|████████▉ | 1142/1280 [11:03:39<1:23:05, 36.12s/it]generating response:  89%|████████▉ | 1143/1280 [11:04:43<1:34:45, 41.50s/it]generating response:  89%|████████▉ | 1144/1280 [11:05:46<1:44:59, 46.32s/it]generating response:  89%|████████▉ | 1145/1280 [11:06:55<1:55:52, 51.50s/it]generating response:  90%|████████▉ | 1146/1280 [11:08:00<2:02:59, 55.07s/it]generating response:  90%|████████▉ | 1147/1280 [11:09:04<2:07:05, 57.33s/it]generating response:  90%|████████▉ | 1148/1280 [11:10:09<2:10:53, 59.49s/it]generating response:  90%|████████▉ | 1151/1280 [11:11:11<1:22:43, 38.48s/it]generating response:  90%|█████████ | 1153/1280 [11:12:14<1:16:37, 36.20s/it]generating response:  90%|█████████ | 1154/1280 [11:13:19<1:27:38, 41.73s/it]generating response:  90%|█████████ | 1155/1280 [11:14:23<1:36:52, 46.50s/it]generating response:  90%|█████████ | 1156/1280 [11:15:28<1:45:32, 51.07s/it]generating response:  91%|█████████ | 1161/1280 [11:16:31<53:19, 26.89s/it]  generating response:  91%|█████████ | 1162/1280 [11:17:35<1:03:46, 32.42s/it]generating response:  91%|█████████ | 1163/1280 [11:18:38<1:13:55, 37.91s/it]generating response:  91%|█████████ | 1164/1280 [11:19:41<1:23:15, 43.06s/it]generating response:  91%|█████████ | 1165/1280 [11:20:44<1:31:17, 47.63s/it]generating response:  91%|█████████▏| 1170/1280 [11:21:48<47:55, 26.15s/it]  generating response:  92%|█████████▏| 1172/1280 [11:22:53<50:04, 27.82s/it]generating response:  92%|█████████▏| 1176/1280 [11:23:57<39:22, 22.71s/it]generating response:  92%|█████████▏| 1177/1280 [11:24:59<47:54, 27.91s/it]generating response:  92%|█████████▏| 1178/1280 [11:26:05<57:44, 33.97s/it]generating response:  92%|█████████▏| 1179/1280 [11:27:08<1:06:10, 39.31s/it]generating response:  92%|█████████▏| 1180/1280 [11:28:10<1:13:25, 44.06s/it]generating response:  92%|█████████▏| 1183/1280 [11:29:12<53:24, 33.03s/it]  generating response:  93%|█████████▎| 1185/1280 [11:30:17<52:06, 32.91s/it]generating response:  93%|█████████▎| 1186/1280 [11:31:22<1:00:30, 38.62s/it]generating response:  93%|█████████▎| 1187/1280 [11:32:28<1:08:35, 44.25s/it]generating response:  93%|█████████▎| 1188/1280 [11:33:32<1:15:02, 48.94s/it]generating response:  93%|█████████▎| 1194/1280 [11:34:38<34:04, 23.78s/it]  generating response:  93%|█████████▎| 1195/1280 [11:35:42<41:31, 29.32s/it]generating response:  93%|█████████▎| 1196/1280 [11:36:46<48:55, 34.94s/it]generating response:  94%|█████████▎| 1197/1280 [11:37:49<55:35, 40.18s/it]generating response:  94%|█████████▍| 1201/1280 [11:38:53<36:30, 27.72s/it]generating response:  94%|█████████▍| 1202/1280 [11:39:57<43:25, 33.41s/it]generating response:  94%|█████████▍| 1203/1280 [11:41:02<50:02, 38.99s/it]generating response:  94%|█████████▍| 1204/1280 [11:42:06<56:02, 44.25s/it]generating response:  94%|█████████▍| 1209/1280 [11:43:10<30:07, 25.46s/it]generating response:  95%|█████████▍| 1210/1280 [11:44:16<36:36, 31.38s/it]generating response:  95%|█████████▍| 1211/1280 [11:45:19<42:29, 36.94s/it]generating response:  95%|█████████▍| 1212/1280 [11:46:23<47:52, 42.25s/it]generating response:  95%|█████████▌| 1216/1280 [11:47:28<30:17, 28.41s/it]generating response:  95%|█████████▌| 1217/1280 [11:48:31<35:33, 33.87s/it]generating response:  95%|█████████▌| 1218/1280 [11:49:36<41:01, 39.70s/it]generating response:  95%|█████████▌| 1219/1280 [11:50:38<45:10, 44.44s/it]generating response:  95%|█████████▌| 1220/1280 [11:51:41<48:44, 48.74s/it]generating response:  96%|█████████▌| 1225/1280 [11:52:46<24:15, 26.47s/it]generating response:  96%|█████████▌| 1226/1280 [11:53:49<28:50, 32.05s/it]generating response:  96%|█████████▌| 1227/1280 [11:54:53<33:18, 37.71s/it]generating response:  96%|█████████▌| 1228/1280 [11:55:58<37:21, 43.11s/it]generating response:  96%|█████████▋| 1233/1280 [11:57:01<19:39, 25.09s/it]generating response:  96%|█████████▋| 1234/1280 [11:58:05<23:30, 30.67s/it]generating response:  96%|█████████▋| 1235/1280 [11:59:08<27:14, 36.32s/it]generating response:  97%|█████████▋| 1236/1280 [12:00:13<30:41, 41.86s/it]generating response:  97%|█████████▋| 1241/1280 [12:01:17<16:12, 24.94s/it]generating response:  97%|█████████▋| 1242/1280 [12:02:21<19:20, 30.54s/it]generating response:  97%|█████████▋| 1243/1280 [12:03:26<22:23, 36.31s/it]generating response:  97%|█████████▋| 1244/1280 [12:04:30<24:59, 41.66s/it]generating response:  98%|█████████▊| 1250/1280 [12:05:32<11:03, 22.10s/it]generating response:  98%|█████████▊| 1251/1280 [12:06:34<13:09, 27.21s/it]generating response:  98%|█████████▊| 1252/1280 [12:07:37<15:21, 32.91s/it]generating response:  98%|█████████▊| 1256/1280 [12:08:40<09:54, 24.78s/it]generating response:  98%|█████████▊| 1257/1280 [12:09:44<11:38, 30.38s/it]generating response:  98%|█████████▊| 1258/1280 [12:10:47<13:13, 36.08s/it]generating response:  98%|█████████▊| 1259/1280 [12:11:51<14:31, 41.50s/it]generating response:  98%|█████████▊| 1260/1280 [12:12:55<15:27, 46.40s/it]generating response:  99%|█████████▉| 1266/1280 [12:14:00<05:24, 23.17s/it]generating response:  99%|█████████▉| 1268/1280 [12:15:02<05:01, 25.12s/it]generating response: 100%|█████████▉| 1274/1280 [12:16:04<01:45, 17.66s/it]generating response: 100%|█████████▉| 1275/1280 [12:17:07<01:52, 22.52s/it]generating response: 100%|██████████| 1280/1280 [12:17:07<00:00, 34.55s/it]
generation part takes 44257.52s
Full generation completed in 44282.85s
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
processed 8 images, 160 texts in 0.01s
using minigpt4 for generation
Loading MiniGPT-4 models...Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.60s/it]
/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading Q-Former
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/1280 [00:00<?, ?it/s]generating response:   0%|          | 1/1280 [01:04<23:01:58, 64.83s/it]generating response:   0%|          | 2/1280 [02:08<22:46:41, 64.16s/it]generating response:   0%|          | 3/1280 [03:11<22:38:44, 63.84s/it]generating response:   0%|          | 4/1280 [04:17<22:47:42, 64.31s/it]generating response:   0%|          | 5/1280 [05:19<22:35:42, 63.80s/it]generating response:   0%|          | 6/1280 [06:24<22:38:59, 64.00s/it]generating response:   1%|          | 7/1280 [07:27<22:31:14, 63.69s/it]generating response:   1%|          | 8/1280 [08:30<22:28:50, 63.62s/it]generating response:   1%|          | 9/1280 [09:32<22:14:01, 62.98s/it]generating response:   1%|          | 10/1280 [10:35<22:16:06, 63.12s/it]generating response:   1%|          | 11/1280 [11:37<22:05:12, 62.66s/it]generating response:   1%|          | 12/1280 [12:40<22:05:00, 62.70s/it]generating response:   1%|          | 13/1280 [13:41<21:57:25, 62.39s/it]generating response:   1%|          | 14/1280 [14:43<21:49:43, 62.07s/it]generating response:   1%|          | 15/1280 [15:45<21:47:05, 62.00s/it]generating response:   1%|▏         | 16/1280 [16:46<21:44:53, 61.94s/it]generating response:   1%|▏         | 17/1280 [17:49<21:48:30, 62.16s/it]generating response:   1%|▏         | 18/1280 [18:52<21:50:33, 62.31s/it]generating response:   1%|▏         | 19/1280 [19:54<21:50:39, 62.36s/it]generating response:   2%|▏         | 20/1280 [20:57<21:54:09, 62.58s/it]generating response:   2%|▏         | 21/1280 [22:00<21:54:26, 62.64s/it]generating response:   2%|▏         | 22/1280 [23:03<21:54:42, 62.70s/it]generating response:   2%|▏         | 23/1280 [24:06<21:56:36, 62.85s/it]generating response:   2%|▏         | 24/1280 [25:08<21:50:17, 62.59s/it]generating response:   2%|▏         | 25/1280 [26:10<21:47:38, 62.52s/it]generating response:   2%|▏         | 26/1280 [27:13<21:47:23, 62.55s/it]generating response:   2%|▏         | 27/1280 [28:15<21:42:30, 62.37s/it]generating response:   2%|▏         | 28/1280 [29:17<21:39:23, 62.27s/it]generating response:   2%|▏         | 29/1280 [30:21<21:48:17, 62.75s/it]generating response:   2%|▏         | 30/1280 [31:24<21:47:01, 62.74s/it]generating response:   2%|▏         | 31/1280 [32:25<21:36:14, 62.27s/it]generating response:   2%|▎         | 32/1280 [33:27<21:36:49, 62.35s/it]generating response:   3%|▎         | 33/1280 [34:29<21:29:28, 62.04s/it]generating response:   3%|▎         | 34/1280 [35:29<21:20:31, 61.66s/it]generating response:   3%|▎         | 35/1280 [36:31<21:16:33, 61.52s/it]generating response:   3%|▎         | 36/1280 [37:32<21:11:54, 61.35s/it]generating response:   3%|▎         | 37/1280 [38:32<21:02:48, 60.96s/it]generating response:   3%|▎         | 38/1280 [39:33<21:01:49, 60.96s/it]generating response:   3%|▎         | 39/1280 [40:34<21:02:38, 61.05s/it]generating response:   3%|▎         | 40/1280 [41:35<21:02:49, 61.10s/it]generating response:   3%|▎         | 41/1280 [42:38<21:12:29, 61.62s/it]generating response:   3%|▎         | 42/1280 [43:40<21:15:31, 61.82s/it]generating response:   3%|▎         | 43/1280 [44:42<21:15:18, 61.86s/it]generating response:   3%|▎         | 44/1280 [45:45<21:18:56, 62.08s/it]generating response:   4%|▎         | 45/1280 [46:48<21:23:41, 62.37s/it]generating response:   4%|▎         | 46/1280 [47:50<21:22:06, 62.34s/it]generating response:   4%|▎         | 47/1280 [48:53<21:25:00, 62.53s/it]generating response:   4%|▍         | 48/1280 [49:55<21:22:26, 62.46s/it]generating response:   4%|▍         | 49/1280 [50:58<21:20:05, 62.39s/it]generating response:   4%|▍         | 50/1280 [52:00<21:19:30, 62.42s/it]generating response:   4%|▍         | 51/1280 [53:03<21:19:14, 62.45s/it]generating response:   4%|▍         | 52/1280 [54:07<21:30:32, 63.06s/it]generating response:   4%|▍         | 53/1280 [55:07<21:12:33, 62.23s/it]generating response:   4%|▍         | 54/1280 [56:07<20:58:57, 61.61s/it]generating response:   4%|▍         | 55/1280 [57:09<20:54:55, 61.47s/it]generating response:   4%|▍         | 56/1280 [58:09<20:45:47, 61.07s/it]generating response:   4%|▍         | 57/1280 [59:10<20:48:27, 61.25s/it]generating response:   5%|▍         | 58/1280 [1:00:10<20:36:29, 60.71s/it]generating response:   5%|▍         | 59/1280 [1:01:11<20:38:49, 60.88s/it]generating response:   5%|▍         | 60/1280 [1:02:12<20:36:57, 60.83s/it]generating response:   5%|▍         | 61/1280 [1:03:13<20:37:17, 60.90s/it]generating response:   5%|▍         | 62/1280 [1:04:14<20:37:56, 60.98s/it]generating response:   5%|▍         | 63/1280 [1:05:16<20:42:57, 61.28s/it]generating response:   5%|▌         | 64/1280 [1:06:17<20:37:33, 61.06s/it]generating response:   5%|▌         | 65/1280 [1:07:20<20:49:08, 61.69s/it]generating response:   5%|▌         | 66/1280 [1:08:22<20:49:34, 61.76s/it]generating response:   5%|▌         | 67/1280 [1:09:28<21:13:03, 62.97s/it]generating response:   5%|▌         | 68/1280 [1:10:30<21:08:20, 62.79s/it]generating response:   5%|▌         | 69/1280 [1:11:32<21:04:26, 62.65s/it]generating response:   5%|▌         | 70/1280 [1:12:35<21:03:43, 62.66s/it]generating response:   6%|▌         | 71/1280 [1:13:36<20:55:59, 62.33s/it]generating response:   6%|▌         | 72/1280 [1:14:39<20:53:43, 62.27s/it]generating response:   6%|▌         | 73/1280 [1:15:41<20:55:53, 62.43s/it]generating response:   6%|▌         | 74/1280 [1:16:44<20:56:03, 62.49s/it]generating response:   6%|▌         | 75/1280 [1:17:46<20:51:14, 62.30s/it]generating response:   6%|▌         | 76/1280 [1:18:48<20:50:05, 62.30s/it]generating response:   6%|▌         | 77/1280 [1:19:50<20:47:57, 62.24s/it]generating response:   6%|▌         | 78/1280 [1:20:54<20:53:35, 62.58s/it]generating response:   6%|▌         | 79/1280 [1:21:56<20:52:17, 62.56s/it]generating response:   6%|▋         | 80/1280 [1:23:00<20:57:03, 62.85s/it]generating response:   6%|▋         | 81/1280 [1:29:15<52:07:04, 156.48s/it]/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
processing images... denoise batch:   0%|          | 0/1 [00:00<?, ?it/s]denoise batch: 100%|██████████| 1/1 [00:05<00:00,  5.11s/it]denoise batch: 100%|██████████| 1/1 [00:05<00:00,  5.11s/it]
Done
computing cossim... Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.23it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  5.29it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  6.00it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.63it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
generating response:   6%|▋         | 82/1280 [1:33:09<59:53:38, 179.98s/it]Your device support faster inference by passing bf16=True in "AutoModelForCausalLM.from_pretrained".
csv file saved at: ./temp
Done
Defender initialized with threshold=-0.003936767578125
processed 8 images, 160 texts in 32.37s
using qwen for generation
Loading checkpoint shards:   0%|          | 0/10 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 1/10 [00:02<00:19,  2.20s/it]Loading checkpoint shards:  20%|██        | 2/10 [00:04<00:18,  2.27s/it]Loading checkpoint shards:  30%|███       | 3/10 [00:06<00:16,  2.29s/it]Loading checkpoint shards:  40%|████      | 4/10 [00:09<00:13,  2.33s/it]Loading checkpoint shards:  50%|█████     | 5/10 [00:11<00:11,  2.27s/it]Loading checkpoint shards:  60%|██████    | 6/10 [00:13<00:09,  2.31s/it]Loading checkpoint shards:  70%|███████   | 7/10 [00:16<00:07,  2.37s/it]Loading checkpoint shards:  80%|████████  | 8/10 [00:18<00:04,  2.44s/it]Loading checkpoint shards:  90%|█████████ | 9/10 [00:21<00:02,  2.55s/it]Loading checkpoint shards: 100%|██████████| 10/10 [00:23<00:00,  2.41s/it]Loading checkpoint shards: 100%|██████████| 10/10 [00:23<00:00,  2.38s/it]
Traceback (most recent call last):
  File "/home/xuyue/QXYtemp/MLM/./main.py", line 98, in <module>
    responses = get_response(args.model, texts, images, a=a)
  File "/home/xuyue/QXYtemp/MLM/model_tools.py", line 346, in get_response
    model.to(a.device)
  File "/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2595, in to
    return super().to(*args, **kwargs)
  File "/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1173, in to
    return self._apply(convert)
  File "/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torch/nn/modules/module.py", line 779, in _apply
    module._apply(fn)
  File "/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torch/nn/modules/module.py", line 779, in _apply
    module._apply(fn)
  File "/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torch/nn/modules/module.py", line 804, in _apply
    param_applied = fn(param)
  File "/home/xuyue/miniconda3/envs/llava/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1159, in convert
    return t.to(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB. GPU 
generating response:   6%|▋         | 83/1280 [1:34:13<48:11:25, 144.93s/it]generating response:   7%|▋         | 84/1280 [1:35:14<39:49:08, 119.86s/it]generating response:   7%|▋         | 85/1280 [1:36:15<33:53:52, 102.12s/it]generating response:   7%|▋         | 86/1280 [1:37:17<29:52:53, 90.09s/it] 