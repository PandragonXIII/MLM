You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
processed 100 images, 100 texts in 0.02s
Loading MiniGPT-4 models...Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.67s/it]
Loading Q-Former
Loading Q-Former Done
Load MiniGPT-4 Checkpoint: /home/xuyue/QXYtemp/MLM/minigpt4/prerained_minigpt4_7b.pth
Done
generating response:   0%|          | 0/100 [00:00<?, ?it/s]generating response:   1%|          | 1/100 [00:37<1:01:46, 37.44s/it]generating response:   2%|▏         | 2/100 [01:14<1:00:46, 37.21s/it]generating response:   3%|▎         | 3/100 [01:51<59:42, 36.93s/it]  generating response:   4%|▍         | 4/100 [02:27<59:03, 36.91s/it]generating response:   5%|▌         | 5/100 [03:04<58:28, 36.93s/it]generating response:   6%|▌         | 6/100 [03:42<57:57, 37.00s/it]generating response:   7%|▋         | 7/100 [04:18<57:17, 36.97s/it]generating response:   8%|▊         | 8/100 [04:55<56:28, 36.83s/it]generating response:   9%|▉         | 9/100 [05:33<56:14, 37.08s/it]generating response:  10%|█         | 10/100 [06:09<55:25, 36.95s/it]generating response:  11%|█         | 11/100 [06:47<55:09, 37.18s/it]generating response:  12%|█▏        | 12/100 [07:24<54:22, 37.07s/it]generating response:  13%|█▎        | 13/100 [08:02<54:04, 37.29s/it]generating response:  14%|█▍        | 14/100 [08:38<53:14, 37.14s/it]generating response:  15%|█▌        | 15/100 [09:15<52:20, 36.94s/it]generating response:  16%|█▌        | 16/100 [09:52<51:34, 36.84s/it]generating response:  17%|█▋        | 17/100 [10:28<50:40, 36.63s/it]generating response:  18%|█▊        | 18/100 [11:05<50:10, 36.71s/it]generating response:  19%|█▉        | 19/100 [11:42<49:43, 36.84s/it]generating response:  20%|██        | 20/100 [12:18<48:59, 36.74s/it]generating response:  21%|██        | 21/100 [12:55<48:25, 36.77s/it]generating response:  22%|██▏       | 22/100 [13:32<47:57, 36.89s/it]generating response:  23%|██▎       | 23/100 [14:10<47:46, 37.23s/it]generating response:  24%|██▍       | 24/100 [14:47<47:08, 37.21s/it]generating response:  25%|██▌       | 25/100 [15:26<47:00, 37.60s/it]generating response:  26%|██▌       | 26/100 [16:04<46:26, 37.66s/it]generating response:  27%|██▋       | 27/100 [16:41<45:44, 37.60s/it]generating response:  28%|██▊       | 28/100 [17:18<44:57, 37.47s/it]generating response:  29%|██▉       | 29/100 [17:56<44:26, 37.55s/it]generating response:  30%|███       | 30/100 [18:35<44:08, 37.84s/it]generating response:  31%|███       | 31/100 [19:12<43:24, 37.74s/it]generating response:  32%|███▏      | 32/100 [19:49<42:37, 37.61s/it]generating response:  33%|███▎      | 33/100 [20:27<42:06, 37.71s/it]generating response:  34%|███▍      | 34/100 [21:05<41:25, 37.66s/it]generating response:  35%|███▌      | 35/100 [21:42<40:40, 37.54s/it]generating response:  36%|███▌      | 36/100 [22:19<39:47, 37.30s/it]generating response:  37%|███▋      | 37/100 [22:55<38:56, 37.08s/it]generating response:  38%|███▊      | 38/100 [23:32<38:05, 36.87s/it]generating response:  39%|███▉      | 39/100 [24:09<37:35, 36.97s/it]generating response:  40%|████      | 40/100 [24:46<36:55, 36.93s/it]generating response:  41%|████      | 41/100 [25:22<36:03, 36.67s/it]generating response:  42%|████▏     | 42/100 [25:59<35:29, 36.71s/it]generating response:  43%|████▎     | 43/100 [26:35<34:50, 36.67s/it]generating response:  44%|████▍     | 44/100 [27:12<34:20, 36.80s/it]generating response:  45%|████▌     | 45/100 [27:49<33:46, 36.85s/it]generating response:  46%|████▌     | 46/100 [28:25<32:44, 36.38s/it]generating response:  47%|████▋     | 47/100 [29:02<32:26, 36.73s/it]generating response:  48%|████▊     | 48/100 [29:40<32:00, 36.93s/it]generating response:  49%|████▉     | 49/100 [30:16<31:22, 36.90s/it]generating response:  50%|█████     | 50/100 [30:53<30:46, 36.94s/it]generating response:  51%|█████     | 51/100 [31:32<30:34, 37.43s/it]generating response:  52%|█████▏    | 52/100 [32:09<29:47, 37.25s/it]generating response:  53%|█████▎    | 53/100 [32:46<29:09, 37.23s/it]generating response:  54%|█████▍    | 54/100 [33:24<28:37, 37.34s/it]generating response:  55%|█████▌    | 55/100 [34:01<27:56, 37.25s/it]generating response:  56%|█████▌    | 56/100 [34:36<27:00, 36.82s/it]generating response:  57%|█████▋    | 57/100 [35:14<26:31, 37.02s/it]generating response:  58%|█████▊    | 58/100 [35:52<26:04, 37.26s/it]generating response:  59%|█████▉    | 59/100 [36:28<25:19, 37.07s/it]generating response:  60%|██████    | 60/100 [37:06<24:46, 37.17s/it]generating response:  61%|██████    | 61/100 [37:42<23:57, 36.87s/it]generating response:  62%|██████▏   | 62/100 [38:18<23:14, 36.69s/it]generating response:  63%|██████▎   | 63/100 [38:55<22:33, 36.59s/it]generating response:  64%|██████▍   | 64/100 [39:31<21:57, 36.60s/it]generating response:  65%|██████▌   | 65/100 [40:08<21:19, 36.55s/it]generating response:  66%|██████▌   | 66/100 [40:45<20:50, 36.78s/it]generating response:  67%|██████▋   | 67/100 [41:21<20:06, 36.55s/it]generating response:  68%|██████▊   | 68/100 [41:57<19:26, 36.44s/it]generating response:  69%|██████▉   | 69/100 [42:33<18:47, 36.37s/it]generating response:  70%|███████   | 70/100 [43:09<18:04, 36.16s/it]generating response:  71%|███████   | 71/100 [43:45<17:29, 36.19s/it]generating response:  72%|███████▏  | 72/100 [44:21<16:50, 36.10s/it]generating response:  73%|███████▎  | 73/100 [44:57<16:14, 36.10s/it]generating response:  74%|███████▍  | 74/100 [45:34<15:40, 36.17s/it]generating response:  75%|███████▌  | 75/100 [46:10<15:07, 36.30s/it]generating response:  76%|███████▌  | 76/100 [46:47<14:32, 36.37s/it]generating response:  77%|███████▋  | 77/100 [47:23<13:56, 36.39s/it]generating response:  78%|███████▊  | 78/100 [48:00<13:20, 36.41s/it]generating response:  79%|███████▉  | 79/100 [48:35<12:40, 36.23s/it]generating response:  80%|████████  | 80/100 [49:12<12:05, 36.29s/it]generating response:  81%|████████  | 81/100 [49:48<11:28, 36.24s/it]generating response:  82%|████████▏ | 82/100 [50:24<10:51, 36.17s/it]generating response:  83%|████████▎ | 83/100 [51:00<10:14, 36.16s/it]generating response:  84%|████████▍ | 84/100 [51:36<09:37, 36.12s/it]generating response:  85%|████████▌ | 85/100 [52:13<09:03, 36.26s/it]generating response:  86%|████████▌ | 86/100 [52:51<08:34, 36.74s/it]generating response:  87%|████████▋ | 87/100 [53:26<07:52, 36.33s/it]generating response:  88%|████████▊ | 88/100 [54:02<07:15, 36.31s/it]generating response:  89%|████████▉ | 89/100 [54:40<06:45, 36.84s/it]generating response:  90%|█████████ | 90/100 [55:17<06:06, 36.69s/it]generating response:  91%|█████████ | 91/100 [55:53<05:28, 36.45s/it]generating response:  92%|█████████▏| 92/100 [56:29<04:52, 36.54s/it]generating response:  93%|█████████▎| 93/100 [57:05<04:14, 36.29s/it]generating response:  94%|█████████▍| 94/100 [57:41<03:37, 36.19s/it]generating response:  95%|█████████▌| 95/100 [58:17<03:00, 36.12s/it]generating response:  96%|█████████▌| 96/100 [58:53<02:24, 36.03s/it]generating response:  97%|█████████▋| 97/100 [59:28<01:47, 35.88s/it]generating response:  98%|█████████▊| 98/100 [1:00:04<01:11, 35.78s/it]generating response:  99%|█████████▉| 99/100 [1:00:40<00:35, 35.92s/it]generating response: 100%|██████████| 100/100 [1:01:16<00:00, 36.03s/it]generating response: 100%|██████████| 100/100 [1:01:16<00:00, 36.77s/it]
generation part takes 3707.56s
Full generation completed in 3707.58s
